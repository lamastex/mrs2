\hypertarget{classsubpavings_1_1PenAIC3}{\subsection{subpavings\-:\-:\-Pen\-A\-I\-C3 \-Class \-Reference}
\label{classsubpavings_1_1PenAIC3}\index{subpavings\-::\-Pen\-A\-I\-C3@{subpavings\-::\-Pen\-A\-I\-C3}}
}


\-Class for penalty function 3 for \-A\-I\-C.  




{\ttfamily \#include $<$histpenalty.\-hpp$>$}



\-Inheritance diagram for subpavings\-:\-:\-Pen\-A\-I\-C3\-:


\-Collaboration diagram for subpavings\-:\-:\-Pen\-A\-I\-C3\-:
\subsubsection*{\-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classsubpavings_1_1PenAIC3_acb7df9b142cb25ac50c8ab6129e55ddc}{\-Pen\-A\-I\-C3} (double cc, double aa, double rr)
\item 
real \hyperlink{classsubpavings_1_1PenAIC3_ae78d7d10ecb8061fd42dbda9bcccb2d4}{operator()} (const \hyperlink{classsubpavings_1_1AdaptiveHistogram}{\-Adaptive\-Histogram} $\ast$const adh, int delta\-Leaf) const 
\begin{DoxyCompactList}\small\item\em the penalty function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Private \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classsubpavings_1_1PenAIC3_a129e1d8bfd430e897e81e7a8f76a5d1c}{\-Pen\-A\-I\-C3} ()
\end{DoxyCompactItemize}
\subsubsection*{\-Private \-Attributes}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{classsubpavings_1_1PenAIC3_af838fbd8465a2144500c43058c28480d}{c}
\item 
double \hyperlink{classsubpavings_1_1PenAIC3_a9a8e54711e178d6fb7c632311739fba7}{alpha}
\item 
double \hyperlink{classsubpavings_1_1PenAIC3_a39aa74f535a40c4f4611e8fb44d07a96}{r}
\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-Class for penalty function 3 for \-A\-I\-C. 

\-Same as \hyperlink{classsubpavings_1_1PenAIC2}{\-Pen\-A\-I\-C2} at present. 

\-Definition at line 171 of file histpenalty.\-hpp.



\subsubsection{\-Constructor \& \-Destructor \-Documentation}
\hypertarget{classsubpavings_1_1PenAIC3_a129e1d8bfd430e897e81e7a8f76a5d1c}{\index{subpavings\-::\-Pen\-A\-I\-C3@{subpavings\-::\-Pen\-A\-I\-C3}!\-Pen\-A\-I\-C3@{\-Pen\-A\-I\-C3}}
\index{\-Pen\-A\-I\-C3@{\-Pen\-A\-I\-C3}!subpavings::PenAIC3@{subpavings\-::\-Pen\-A\-I\-C3}}
\paragraph[{\-Pen\-A\-I\-C3}]{\setlength{\rightskip}{0pt plus 5cm}{\bf subpavings\-::\-Pen\-A\-I\-C3\-::\-Pen\-A\-I\-C3} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1PenAIC3_a129e1d8bfd430e897e81e7a8f76a5d1c}
\hypertarget{classsubpavings_1_1PenAIC3_acb7df9b142cb25ac50c8ab6129e55ddc}{\index{subpavings\-::\-Pen\-A\-I\-C3@{subpavings\-::\-Pen\-A\-I\-C3}!\-Pen\-A\-I\-C3@{\-Pen\-A\-I\-C3}}
\index{\-Pen\-A\-I\-C3@{\-Pen\-A\-I\-C3}!subpavings::PenAIC3@{subpavings\-::\-Pen\-A\-I\-C3}}
\paragraph[{\-Pen\-A\-I\-C3}]{\setlength{\rightskip}{0pt plus 5cm}{\bf subpavings\-::\-Pen\-A\-I\-C3\-::\-Pen\-A\-I\-C3} (
\begin{DoxyParamCaption}
\item[{double}]{cc, }
\item[{double}]{aa, }
\item[{double}]{rr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}\label{classsubpavings_1_1PenAIC3_acb7df9b142cb25ac50c8ab6129e55ddc}


\-Definition at line 182 of file histpenalty.\-hpp.


\begin{DoxyCode}
              : c(cc), alpha (aa), r(rr) {}
\end{DoxyCode}


\subsubsection{\-Member \-Function \-Documentation}
\hypertarget{classsubpavings_1_1PenAIC3_ae78d7d10ecb8061fd42dbda9bcccb2d4}{\index{subpavings\-::\-Pen\-A\-I\-C3@{subpavings\-::\-Pen\-A\-I\-C3}!operator()@{operator()}}
\index{operator()@{operator()}!subpavings::PenAIC3@{subpavings\-::\-Pen\-A\-I\-C3}}
\paragraph[{operator()}]{\setlength{\rightskip}{0pt plus 5cm}real subpavings\-::\-Pen\-A\-I\-C3\-::operator() (
\begin{DoxyParamCaption}
\item[{const {\bf \-Adaptive\-Histogram} $\ast$const}]{adh, }
\item[{int}]{delta\-Leaf}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}\label{classsubpavings_1_1PenAIC3_ae78d7d10ecb8061fd42dbda9bcccb2d4}


the penalty function. 


\begin{DoxyParams}{\-Parameters}
{\em adh} & is the histogram object to calculate the penalty on. \\
\hline
{\em delta\-Leaf} & change in number leaves to take into account. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
the penalty as a real. 
\end{DoxyReturn}


\-Implements \hyperlink{classsubpavings_1_1PenObj_a70c7efe90368cd85f0971ef548d678c1}{subpavings\-::\-Pen\-Obj}.



\-Definition at line 185 of file histpenalty.\-hpp.



\-References alpha, c, subpavings\-::\-Adaptive\-Histogram\-::get\-Root\-Counter(), subpavings\-::\-Adaptive\-Histogram\-::get\-Root\-Leaves(), subpavings\-::\-Adaptive\-Histogram\-::get\-Root\-Sum\-Leaf\-Count\-Over\-Vol(), l\-Ck(), and r.


\begin{DoxyCode}
      {
          dotprecision penalty(0.0);
          int k = adh->getRootLeaves() + deltaLeaf - 1; // leaves-1
          double logCatk= lCk(k);
          size_t counter = adh->getRootCounter(); // total number points
          accumulate(penalty, c, logCatk); // pen = c*logCatk
  
          real s = adh->getRootSumLeafCountOverVol();
  
          accumulate(penalty, s/(1.0*counter), alpha);
          //now pen = c*logCatk + (alpha/counter)*sum(leaf counts/vols)
          accumulate(penalty, 2*r, log(k+1));
          //now pen = c*logCatk + (alpha/counter)*sum(leaf counts/vols) +
       2*r*log(k+1)
  
          return rnd(penalty);
      }
\end{DoxyCode}


\subsubsection{\-Member \-Data \-Documentation}
\hypertarget{classsubpavings_1_1PenAIC3_a9a8e54711e178d6fb7c632311739fba7}{\index{subpavings\-::\-Pen\-A\-I\-C3@{subpavings\-::\-Pen\-A\-I\-C3}!alpha@{alpha}}
\index{alpha@{alpha}!subpavings::PenAIC3@{subpavings\-::\-Pen\-A\-I\-C3}}
\paragraph[{alpha}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf subpavings\-::\-Pen\-A\-I\-C3\-::alpha}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1PenAIC3_a9a8e54711e178d6fb7c632311739fba7}


\-Definition at line 174 of file histpenalty.\-hpp.



\-Referenced by operator()().

\hypertarget{classsubpavings_1_1PenAIC3_af838fbd8465a2144500c43058c28480d}{\index{subpavings\-::\-Pen\-A\-I\-C3@{subpavings\-::\-Pen\-A\-I\-C3}!c@{c}}
\index{c@{c}!subpavings::PenAIC3@{subpavings\-::\-Pen\-A\-I\-C3}}
\paragraph[{c}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf subpavings\-::\-Pen\-A\-I\-C3\-::c}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1PenAIC3_af838fbd8465a2144500c43058c28480d}


\-Definition at line 173 of file histpenalty.\-hpp.



\-Referenced by operator()().

\hypertarget{classsubpavings_1_1PenAIC3_a39aa74f535a40c4f4611e8fb44d07a96}{\index{subpavings\-::\-Pen\-A\-I\-C3@{subpavings\-::\-Pen\-A\-I\-C3}!r@{r}}
\index{r@{r}!subpavings::PenAIC3@{subpavings\-::\-Pen\-A\-I\-C3}}
\paragraph[{r}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf subpavings\-::\-Pen\-A\-I\-C3\-::r}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1PenAIC3_a39aa74f535a40c4f4611e8fb44d07a96}


\-Definition at line 175 of file histpenalty.\-hpp.



\-Referenced by operator()().



\-The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
\hyperlink{histpenalty_8hpp}{histpenalty.\-hpp}\end{DoxyCompactItemize}
