\hypertarget{GOpt_8cpp}{\subsection{\-G\-Opt.\-cpp \-File \-Reference}
\label{GOpt_8cpp}\index{\-G\-Opt.\-cpp@{\-G\-Opt.\-cpp}}
}


\-Global optimisation definitions.  


{\ttfamily \#include \char`\"{}\-G\-Opt.\-hpp\char`\"{}}\*
{\ttfamily \#include $<$iostream$>$}\*
{\ttfamily \#include $<$fstream$>$}\*
{\ttfamily \#include $<$math.\-h$>$}\*
{\ttfamily \#include $<$getopt.\-h$>$}\*
{\ttfamily \#include $<$time.\-h$>$}\*
{\ttfamily \#include $<$gop.\-hpp$>$}\*
{\ttfamily \#include $<$stacksz.\-hpp$>$}\*
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{GOpt_8cpp_aa1ef10e5facfa08af99a235f02dce943}{\-G\-Opt\-Min} (\hyperlink{classFobj}{\-Fobj} $\ast$\hyperlink{errorfunc_8hpp_aacb77b1211a6ca2e2beff1811cf9ecf4}{f}, ivector search, real t, const int label)
\begin{DoxyCompactList}\small\item\em \-This runs the global optimisation procedure \-All\-G\-Op for global minimums and prints results. \end{DoxyCompactList}\item 
void \hyperlink{GOpt_8cpp_ad4d421e8fe8cd7dc081fbc719c43c8b4}{\-G\-Opt\-Max} (\hyperlink{classFobj}{\-Fobj} $\ast$\hyperlink{errorfunc_8hpp_aacb77b1211a6ca2e2beff1811cf9ecf4}{f}, ivector search, real t, const int label)
\begin{DoxyCompactList}\small\item\em \-This runs the global optimisation procedure \-All\-G\-Op for global maximums and prints results. \end{DoxyCompactList}\item 
\-Hess\-Type \hyperlink{GOpt_8cpp_a3f84a8488c00dd1560b0a3ba013d90fe}{func\-Hess\-Min} (const \-H\-Tvector \&x)
\begin{DoxyCompactList}\small\item\em \-Function conforming to typedef \-H\-Tscalar\-\_\-\-Fct\-Ptr for global minimums. \end{DoxyCompactList}\item 
\-Hess\-Type \hyperlink{GOpt_8cpp_aa604d9b6cc2535d0b422a9838de48b2b}{func\-Hess\-Max} (const \-H\-Tvector \&x)
\begin{DoxyCompactList}\small\item\em \-Function conforming to typedef \-H\-Tscalar\-\_\-\-Fct\-Ptr for global maximums. \end{DoxyCompactList}\item 
void \hyperlink{GOpt_8cpp_a82f1bc87790710a1599bc1dc2906339a}{print\-Outcome\-Min} (ivector \&\-Search\-Interval, real \&\-Tolerance, imatrix \&\-Opti, intvector \&\-Unique, int \-Number\-Of\-Optis, interval \&\-Minimum, int \-Error)
\begin{DoxyCompactList}\small\item\em \-Print the results for mimimums. \end{DoxyCompactList}\item 
void \hyperlink{GOpt_8cpp_aa50f2e0b46bc83d573cd3971624f0d3d}{print\-Outcome\-Max} (ivector \&\-Search\-Interval, real \&\-Tolerance, imatrix \&\-Opti, intvector \&\-Unique, int \-Number\-Of\-Optis, interval \&\-Maximum, int \-Error)
\begin{DoxyCompactList}\small\item\em \-Print the results for maximums. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classFobj}{\-Fobj} $\ast$ \hyperlink{GOpt_8cpp_ae1bcefa049228309fc096c4030a54728}{f\-To\-Otp} = \-N\-U\-L\-L
\begin{DoxyCompactList}\small\item\em declare a global pointer to an \hyperlink{classFobj}{\-Fobj} \end{DoxyCompactList}\item 
int \hyperlink{GOpt_8cpp_a290cffa14d3090442edf93f1400230c7}{flabel} = 0
\begin{DoxyCompactList}\small\item\em declare a global pointer to an int for target function label \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-Global optimisation definitions. \-A set of processes for performing global optimisation on a function using \-All\-G\-Op from the \-C++ \-Toolbox for \-Verified \-Computing 

\-Definition in file \hyperlink{GOpt_8cpp_source}{\-G\-Opt.\-cpp}.



\subsubsection{\-Function \-Documentation}
\hypertarget{GOpt_8cpp_aa604d9b6cc2535d0b422a9838de48b2b}{\index{\-G\-Opt.\-cpp@{\-G\-Opt.\-cpp}!func\-Hess\-Max@{func\-Hess\-Max}}
\index{func\-Hess\-Max@{func\-Hess\-Max}!GOpt.cpp@{\-G\-Opt.\-cpp}}
\paragraph[{func\-Hess\-Max}]{\setlength{\rightskip}{0pt plus 5cm}\-Hess\-Type {\bf func\-Hess\-Max} (
\begin{DoxyParamCaption}
\item[{const \-H\-Tvector \&}]{x}
\end{DoxyParamCaption}
)}}\label{GOpt_8cpp_aa604d9b6cc2535d0b422a9838de48b2b}


\-Function conforming to typedef \-H\-Tscalar\-\_\-\-Fct\-Ptr for global maximums. 



\-Definition at line 152 of file \-G\-Opt.\-cpp.



\-References flabel.



\-Referenced by \-G\-Opt\-Max().


\begin{DoxyCode}
{
  HessType hh;
  // use negative of the operator () of the function pointed to by global
  // fToOpt to calculate hh
  hh = -((*fToOtp)(x, flabel));
  return hh;
}
\end{DoxyCode}
\hypertarget{GOpt_8cpp_a3f84a8488c00dd1560b0a3ba013d90fe}{\index{\-G\-Opt.\-cpp@{\-G\-Opt.\-cpp}!func\-Hess\-Min@{func\-Hess\-Min}}
\index{func\-Hess\-Min@{func\-Hess\-Min}!GOpt.cpp@{\-G\-Opt.\-cpp}}
\paragraph[{func\-Hess\-Min}]{\setlength{\rightskip}{0pt plus 5cm}\-Hess\-Type {\bf func\-Hess\-Min} (
\begin{DoxyParamCaption}
\item[{const \-H\-Tvector \&}]{x}
\end{DoxyParamCaption}
)}}\label{GOpt_8cpp_a3f84a8488c00dd1560b0a3ba013d90fe}


\-Function conforming to typedef \-H\-Tscalar\-\_\-\-Fct\-Ptr for global minimums. 



\-Definition at line 139 of file \-G\-Opt.\-cpp.



\-References flabel.



\-Referenced by \-G\-Opt\-Min().


\begin{DoxyCode}
{
  HessType hh;
  // use the operator () of the function pointed to by global fToOpt to
  // calculate hh
  hh = (*fToOtp)(x, flabel);
  return hh;
}
\end{DoxyCode}
\hypertarget{GOpt_8cpp_ad4d421e8fe8cd7dc081fbc719c43c8b4}{\index{\-G\-Opt.\-cpp@{\-G\-Opt.\-cpp}!\-G\-Opt\-Max@{\-G\-Opt\-Max}}
\index{\-G\-Opt\-Max@{\-G\-Opt\-Max}!GOpt.cpp@{\-G\-Opt.\-cpp}}
\paragraph[{\-G\-Opt\-Max}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-G\-Opt\-Max} (
\begin{DoxyParamCaption}
\item[{{\bf \-Fobj} $\ast$}]{f, }
\item[{ivector}]{search, }
\item[{real}]{t, }
\item[{const int}]{label = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{GOpt_8cpp_ad4d421e8fe8cd7dc081fbc719c43c8b4}


\-This runs the global optimisation procedure \-All\-G\-Op for global maximums and prints results. 


\begin{DoxyParams}{\-Parameters}
{\em f} & a pointer to the \hyperlink{classFobj}{\-Fobj} we want to do global optimisation on \\
\hline
{\em search} & an initial search box \\
\hline
{\em t} & a tolerance for optimisation -\/-\/ stops search when interval searched is below t in width \\
\hline
{\em label} & the model or topology label \\
\hline
\end{DoxyParams}


\-Definition at line 100 of file \-G\-Opt.\-cpp.



\-References f(), flabel, func\-Hess\-Max(), \-Fobj\-::get\-Labeled\-Domain\-Dim(), taylor\-::\-Lb(), print\-Outcome\-Max(), and taylor\-::\-Ub().



\-Referenced by main().


\begin{DoxyCode}
{
  fToOtp = f;       // point the global pointer to f
  flabel = label;   // and set flabel = label
  ivector SearchInterval = search;
  real Tolerance = t;
  // check the dimensions match
  int search_dim = Ub(search) - Lb(search) +1;
                    // get the dimensions of the domain for boxes labelled 0;
  size_t func_dim = f->getLabeledDomainDim(0);
  if(static_cast<int>(func_dim) != search_dim)
  {
    std::cerr << "Error in GOpt: dimensions of search box " << search_dim
      << " do not match dimensions of function domain " << func_dim << 
      std::endl
      << std::endl;
    exit(1);
  }
  // these are filled in by running AllGOp
  interval    Maximum;
  imatrix     Opti;
  intvector   Unique;
  int         NumberOfOptis;
  int   Error;
  // running AllGop fills in Opti, Unique, NumberOfOptis, Mimimum and Error,
  // all of which are passed by reference
  AllGOp(funcHessMax, SearchInterval, Tolerance,
         Opti, Unique, NumberOfOptis, Maximum, Error);
  // AllGOp also takes a final optional parameter for maximum number of
  // optimisation attemtps to perform
  // this has default value of MaxCount = 10000 - see gop.hpp
  // print the outcomes
  printOutcomeMax(SearchInterval, Tolerance, Opti, Unique, NumberOfOptis,
                  Maximum, Error);
}
\end{DoxyCode}
\hypertarget{GOpt_8cpp_aa1ef10e5facfa08af99a235f02dce943}{\index{\-G\-Opt.\-cpp@{\-G\-Opt.\-cpp}!\-G\-Opt\-Min@{\-G\-Opt\-Min}}
\index{\-G\-Opt\-Min@{\-G\-Opt\-Min}!GOpt.cpp@{\-G\-Opt.\-cpp}}
\paragraph[{\-G\-Opt\-Min}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-G\-Opt\-Min} (
\begin{DoxyParamCaption}
\item[{{\bf \-Fobj} $\ast$}]{f, }
\item[{ivector}]{search, }
\item[{real}]{t, }
\item[{const int}]{label = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{GOpt_8cpp_aa1ef10e5facfa08af99a235f02dce943}


\-This runs the global optimisation procedure \-All\-G\-Op for global minimums and prints results. 


\begin{DoxyParams}{\-Parameters}
{\em f} & a pointer to the \hyperlink{classFobj}{\-Fobj} we want to do global optimisation on \\
\hline
{\em search} & an initial search box \\
\hline
{\em t} & a tolerance for optimisation -\/-\/ stops search when interval searched is below t in width \\
\hline
{\em label} & the model or topology label \\
\hline
\end{DoxyParams}


\-Definition at line 61 of file \-G\-Opt.\-cpp.



\-References f(), flabel, func\-Hess\-Min(), \-Fobj\-::get\-Labeled\-Domain\-Dim(), taylor\-::\-Lb(), print\-Outcome\-Min(), and taylor\-::\-Ub().



\-Referenced by main().


\begin{DoxyCode}
{
  fToOtp = f;       // point the global pointer to f
  flabel = label;   // and set flabel = label
  ivector SearchInterval = search;
  real Tolerance = t;
  // check the dimensions match
  int search_dim = Ub(search) - Lb(search) +1;
  // get the dimensions of the domain for boxes labelled 0;
  size_t func_dim = f->getLabeledDomainDim(0);
  if(static_cast<int>(func_dim) != search_dim)
  {
    std::cerr << "Error in GOpt: dimensions of search box "
      << search_dim << " do not match dimensions of function domain "
      << func_dim << endl<< std::endl;
    exit(1);
  }
  // these are filled in by running AllGOp
  interval    Minimum;
  imatrix     Opti;
  intvector   Unique;
  int         NumberOfOptis;
  int   Error;
  // running AllGop fills in Opti, Unique, NumberOfOptis, Mimimum and Error,
  // all of which are passed by reference
  AllGOp(funcHessMin, SearchInterval, Tolerance,
    Opti, Unique, NumberOfOptis, Minimum, Error);
  // AllGOp also takes a final optional parameter for maximum number of
  // optimisation attemtps to perform
  // this has default value of MaxCount = 10000 - see gop.hpp
  // print the outcomes
  printOutcomeMin(SearchInterval, Tolerance, Opti, Unique, NumberOfOptis,
                  Minimum, Error);
}
\end{DoxyCode}
\hypertarget{GOpt_8cpp_aa50f2e0b46bc83d573cd3971624f0d3d}{\index{\-G\-Opt.\-cpp@{\-G\-Opt.\-cpp}!print\-Outcome\-Max@{print\-Outcome\-Max}}
\index{print\-Outcome\-Max@{print\-Outcome\-Max}!GOpt.cpp@{\-G\-Opt.\-cpp}}
\paragraph[{print\-Outcome\-Max}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf print\-Outcome\-Max} (
\begin{DoxyParamCaption}
\item[{ivector \&}]{\-Search\-Interval, }
\item[{real \&}]{\-Tolerance, }
\item[{imatrix \&}]{\-Opti, }
\item[{intvector \&}]{\-Unique, }
\item[{int}]{\-Number\-Of\-Optis, }
\item[{interval \&}]{\-Maximum, }
\item[{int}]{\-Error}
\end{DoxyParamCaption}
)}}\label{GOpt_8cpp_aa50f2e0b46bc83d573cd3971624f0d3d}


\-Print the results for maximums. 



\-Definition at line 209 of file \-G\-Opt.\-cpp.



\-Referenced by \-G\-Opt\-Max().


\begin{DoxyCode}
{
                    // Output format
  std::cout << SetPrecision(23,15) << Scientific;

  std::cout << std::endl << std::endl << std:: endl;
  std::cout << "Global optimisation: Maximums" << std::endl;
  std::cout << "Results of running AllGOp with Tolerance " << Tolerance
    << std::endl;
  std::cout << "with an initial search box of: " << std::endl;
  std::cout << SearchInterval << endl<<endl;

  std::cout << "The results for global optimisation (maximums) are "
    << std::endl;

  for (int i = 1; i <= NumberOfOptis; i++)
  {
    std::cout << Opti[i];
    if (Unique[i])
      std::cout
        << " encloses a locally unique candidate for a global maximiser!";
    else
      std::cout << " may contain a local or global maximiser!";
    std::cout << std::endl << std::endl;
  }

  if (NumberOfOptis != 0)
  {
    std::cout << Maximum << std::endl
      << "encloses the global maximum value!" << std::endl << std::endl;
  }

  std::cout << NumberOfOptis << " interval enclosure(s)" << std::endl;

  if (Error)
    std::cout << endl << AllGOpErrMsg(Error) << std::endl;
  else if (NumberOfOptis == 1 && Unique[1])
    std::cout << std::endl << "We have validated that there is "
        "a unique global optimiser!" << std::endl;

  std::cout << std::endl << "End of global optimisation for maximums"
    << std::endl << std::endl;

}
\end{DoxyCode}
\hypertarget{GOpt_8cpp_a82f1bc87790710a1599bc1dc2906339a}{\index{\-G\-Opt.\-cpp@{\-G\-Opt.\-cpp}!print\-Outcome\-Min@{print\-Outcome\-Min}}
\index{print\-Outcome\-Min@{print\-Outcome\-Min}!GOpt.cpp@{\-G\-Opt.\-cpp}}
\paragraph[{print\-Outcome\-Min}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf print\-Outcome\-Min} (
\begin{DoxyParamCaption}
\item[{ivector \&}]{\-Search\-Interval, }
\item[{real \&}]{\-Tolerance, }
\item[{imatrix \&}]{\-Opti, }
\item[{intvector \&}]{\-Unique, }
\item[{int}]{\-Number\-Of\-Optis, }
\item[{interval \&}]{\-Minimum, }
\item[{int}]{\-Error}
\end{DoxyParamCaption}
)}}\label{GOpt_8cpp_a82f1bc87790710a1599bc1dc2906339a}


\-Print the results for mimimums. 



\-Definition at line 162 of file \-G\-Opt.\-cpp.



\-Referenced by \-G\-Opt\-Min().


\begin{DoxyCode}
{
  // Output format
  std::cout << SetPrecision(23,15) << Scientific;

  std::cout << std::endl << std::endl << std:: endl;
  std::cout << "Global optimisation: minimums " << std::endl;
  std::cout << "Results of running AllGOp with Tolerance " << Tolerance
    << std::endl;
  std::cout << "with an initial search box of: " << std::endl;
  std::cout << SearchInterval << endl<<endl;

  std::cout << "The results for global optimisation (minimums) are "
    << std::endl;

  for (int i = 1; i <= NumberOfOptis; i++)
  {
    std::cout << Opti[i];
    if (Unique[i])
      std::cout
        << " encloses a locally unique candidate for a global minimiser!";
    else
      std::cout << " may contain a local or global minimiser!";
    std::cout << std::endl << std::endl;
  }

  if (NumberOfOptis != 0)
  {
    std::cout << Minimum << std::endl
      << "encloses the global minimum value!" << std::endl << std::endl;
  }

  std::cout << NumberOfOptis << " interval enclosure(s)" << std::endl;

  if (Error)
    std::cout << endl << AllGOpErrMsg(Error) << std::endl;
  else if (NumberOfOptis == 1 && Unique[1])
    std::cout << std::endl << "We have validated that there is "
        "a unique global optimiser!" << std::endl;

  std::cout << std::endl << "End of global optimisation for minimums"
    << std::endl << std::endl;
}
\end{DoxyCode}


\subsubsection{\-Variable \-Documentation}
\hypertarget{GOpt_8cpp_a290cffa14d3090442edf93f1400230c7}{\index{\-G\-Opt.\-cpp@{\-G\-Opt.\-cpp}!flabel@{flabel}}
\index{flabel@{flabel}!GOpt.cpp@{\-G\-Opt.\-cpp}}
\paragraph[{flabel}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf flabel} = 0}}\label{GOpt_8cpp_a290cffa14d3090442edf93f1400230c7}


declare a global pointer to an int for target function label 

\-This is horrible but it is the only way around the various problems in implementing global optimisation for now. 

\-Definition at line 55 of file \-G\-Opt.\-cpp.



\-Referenced by func\-Hess\-Max(), func\-Hess\-Min(), \-G\-Opt\-Max(), and \-G\-Opt\-Min().

\hypertarget{GOpt_8cpp_ae1bcefa049228309fc096c4030a54728}{\index{\-G\-Opt.\-cpp@{\-G\-Opt.\-cpp}!f\-To\-Otp@{f\-To\-Otp}}
\index{f\-To\-Otp@{f\-To\-Otp}!GOpt.cpp@{\-G\-Opt.\-cpp}}
\paragraph[{f\-To\-Otp}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Fobj}$\ast$ {\bf f\-To\-Otp} = \-N\-U\-L\-L}}\label{GOpt_8cpp_ae1bcefa049228309fc096c4030a54728}


declare a global pointer to an \hyperlink{classFobj}{\-Fobj} 

\-This is horrible but it is the only way around the various problems in implementing global optimisation for now. 

\-Definition at line 48 of file \-G\-Opt.\-cpp.

