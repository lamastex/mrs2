\hypertarget{classsubpavings_1_1RealMappedSPnode}{\subsection{subpavings\-:\-:\-Real\-Mapped\-S\-Pnode \-Class \-Reference}
\label{classsubpavings_1_1RealMappedSPnode}\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
}


\-A derived class based on \hyperlink{classsubpavings_1_1MappedSPnode}{\-Mapped\-S\-Pnode} $<$ cxsc\-::real $>$.  




{\ttfamily \#include $<$realmappedspnode.\-hpp$>$}



\-Inheritance diagram for subpavings\-:\-:\-Real\-Mapped\-S\-Pnode\-:


\-Collaboration diagram for subpavings\-:\-:\-Real\-Mapped\-S\-Pnode\-:
\subsubsection*{\-Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classsubpavings_1_1RealMappedSPnode_1_1Measurer}{\-Measurer}
\begin{DoxyCompactList}\small\item\em \-Inner interface for types measuring nodes. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Public \-Types}
\begin{DoxyCompactItemize}
\item 
typedef std\-::vector\*
$<$ \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} $\ast$ $>$ \hyperlink{classsubpavings_1_1RealMappedSPnode_a9591975c77c7e7da92bbdcdf62a74d1a}{\-Ptrs}
\item 
typedef \-Ptrs\-::iterator \hyperlink{classsubpavings_1_1RealMappedSPnode_a8414841542df48678ae521df3ae92800}{\-Ptrs\-Itr}
\item 
typedef std\-::vector$<$ const \*
\hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} $\ast$ $>$ \hyperlink{classsubpavings_1_1RealMappedSPnode_a5fc20ec0cd33f031e874f50251156e65}{\-Const\-Ptrs}
\item 
typedef \-Const\-Ptrs\-::const\-\_\-iterator \hyperlink{classsubpavings_1_1RealMappedSPnode_a528463bd540e2e3d4dc907ce78a3b03c}{\-Const\-Ptrs\-Itr}
\item 
typedef std\-::list\*
$<$ \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} $\ast$ $>$ \hyperlink{classsubpavings_1_1RealMappedSPnode_a13d2adc6fa08d7b1e70a7956eac1affe}{\-List\-Ptrs}
\item 
typedef \-List\-Ptrs\-::iterator \hyperlink{classsubpavings_1_1RealMappedSPnode_ad10e24d2efdb436ae6f65306c8ff736e}{\-List\-Ptrs\-Itr}
\item 
typedef std\-::list$<$ const \*
\hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} $\ast$ $>$ \hyperlink{classsubpavings_1_1RealMappedSPnode_aba04df267c93463fbb6a90d85e11b627}{\-List\-Const\-Ptrs}
\item 
typedef \*
\-List\-Const\-Ptrs\-::const\-\_\-iterator \hyperlink{classsubpavings_1_1RealMappedSPnode_ac4e7b7e57068590fc47a5951453754b2}{\-List\-Const\-Ptrs\-Itr}
\end{DoxyCompactItemize}
\subsubsection*{\-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
virtual \hyperlink{classsubpavings_1_1RealMappedSPnode_a55594a45ac82b31b5ae7592143079794}{$\sim$\-Real\-Mapped\-S\-Pnode} ()
\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a21248dfec3fc7415a604f2f1a5d58ce6}{\-Real\-Mapped\-S\-Pnode} ()
\begin{DoxyCompactList}\small\item\em \-No-\/argument constructor. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a8f2de173f1eb55690cafb07020bfa5e5}{\-Real\-Mapped\-S\-Pnode} (const ivector \&v)
\begin{DoxyCompactList}\small\item\em initialised constructor. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a6ca684686609263ecb8579a95276e2bf}{\-Real\-Mapped\-S\-Pnode} (const \hyperlink{classLabBox}{\-Lab\-Box} \&lb)
\begin{DoxyCompactList}\small\item\em \-Initialised constructor. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a77bada00301c6333863d80ca002fd86c}{\-Real\-Mapped\-S\-Pnode} (const ivector \&v, const cxsc\-::real \&\hyperlink{classsubpavings_1_1MappedSPnode_a85f4e42ee09fcfa8c47835231ac3c21d}{range})
\begin{DoxyCompactList}\small\item\em \-Initialised constructor. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a12af9b0be5c63f0e1af1849d70b1b647}{\-Real\-Mapped\-S\-Pnode} (const \hyperlink{classLabBox}{\-Lab\-Box} \&lb, const cxsc\-::real \&\hyperlink{classsubpavings_1_1MappedSPnode_a85f4e42ee09fcfa8c47835231ac3c21d}{range})
\begin{DoxyCompactList}\small\item\em \-Initialised constructor. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_add6e4bba67a9d900ebebf07f420ad813}{\-Real\-Mapped\-S\-Pnode} (const \hyperlink{classsubpavings_1_1SPnode}{\-S\-Pnode} \&spn)
\begin{DoxyCompactList}\small\item\em \-Constructor initialised with an \hyperlink{classsubpavings_1_1SPnode}{\-S\-Pnode}. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a4ec458c112685446a703ae73fe812b84}{\-Real\-Mapped\-S\-Pnode} (const \hyperlink{classsubpavings_1_1SPSnode}{\-S\-P\-Snode} \&spn)
\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_aea3c023626616315bdf71aaee45fa32f}{\-Real\-Mapped\-S\-Pnode} (const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \&other)
\begin{DoxyCompactList}\small\item\em \-Copy constructor. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_afcd2676e416102b713d9ce735bc27889}{\-Real\-Mapped\-S\-Pnode} (const \hyperlink{classsubpavings_1_1MappedSPnode}{\-Mapped\-S\-Pnode}$<$ cxsc\-::real $>$ \&other)
\begin{DoxyCompactList}\small\item\em \-Copy constructor. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \& \hyperlink{classsubpavings_1_1RealMappedSPnode_a8c4a201d04c81a5f21301d6a325e740d}{operator=} (\hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} rhs)
\begin{DoxyCompactList}\small\item\em \-Copy assignment operator. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \& \hyperlink{classsubpavings_1_1RealMappedSPnode_ad6a86d365ae237d96c7a8f842700af96}{operator=} (\hyperlink{classsubpavings_1_1MappedSPnode}{\-Mapped\-S\-Pnode}$<$ cxsc\-::real $>$ rhs)
\begin{DoxyCompactList}\small\item\em \-Copy assignment operator. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} $\ast$ \hyperlink{classsubpavings_1_1RealMappedSPnode_a04fef135a04c4d165c08395c531581dd}{get\-Parent} () const 
\begin{DoxyCompactList}\small\item\em \-Accessor for the parent of a node. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} $\ast$ \hyperlink{classsubpavings_1_1RealMappedSPnode_a71ad37450934fcd212d1c13c9f8830d4}{get\-Left\-Child} () const 
\begin{DoxyCompactList}\small\item\em \-Accessor for the left child of a node. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} $\ast$ \hyperlink{classsubpavings_1_1RealMappedSPnode_a19cb07beb697f0f8613a63c0b476ddd9}{get\-Right\-Child} () const 
\begin{DoxyCompactList}\small\item\em \-Accessor for the right child of a node. \end{DoxyCompactList}\item 
bool \hyperlink{classsubpavings_1_1RealMappedSPnode_a1ac4214b1e335289374edece1b5d8c43}{operator$<$} (const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \&rhs) const 
\begin{DoxyCompactList}\small\item\em \-Less-\/than operator. \end{DoxyCompactList}\item 
const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} $\ast$ \hyperlink{classsubpavings_1_1RealMappedSPnode_a9409b660d7a7f1f35fc7f2d1904386c2}{find\-Containing\-Node} (const cxsc\-::rvector \&pt, \hyperlink{namespacesubpavings_ae1ea349cda4812634df03761ebfc1c98}{\-O\-P\-E\-R\-A\-T\-I\-O\-N\-S\-\_\-\-O\-N} child\-Ind=\hyperlink{namespacesubpavings_ae1ea349cda4812634df03761ebfc1c98a4863db89a4712e90bb113f9acf898781}{\-O\-N\-\_\-\-P\-A\-R\-E\-N\-T}) const 
\item 
bool \hyperlink{classsubpavings_1_1RealMappedSPnode_ac4cadaec6d96f2a315218dc16a082f8a}{has\-Negative\-Range\-In\-Tree} () const 
\item 
bool \hyperlink{classsubpavings_1_1RealMappedSPnode_a738f4ef504214f9dd3a533f052f6d4cb}{has\-Infinite\-Range\-In\-Tree} () const 
\item 
virtual void \hyperlink{classsubpavings_1_1RealMappedSPnode_a4d0129dda149a950a06e9d2e3ff802c4}{node\-Expand} (int comp)
\begin{DoxyCompactList}\small\item\em \-Add two sibling child nodes to this provided this is a leaf. \end{DoxyCompactList}\item 
virtual void \hyperlink{classsubpavings_1_1RealMappedSPnode_ad60865bacd8a43978cf2da02419cbf8f}{node\-Expand} ()
\begin{DoxyCompactList}\small\item\em \-Add two sibling child nodes to this provided this is a leaf. \end{DoxyCompactList}\item 
virtual cxsc\-::real \hyperlink{classsubpavings_1_1RealMappedSPnode_abae5bea82b46019e23d98756973c6860}{get\-Max\-Range\-For\-Leaves\-In\-Tree} () const 
\begin{DoxyCompactList}\small\item\em \-Get maximum value of the range for any of the leaves of the tree rooted at this. \end{DoxyCompactList}\item 
virtual void \hyperlink{classsubpavings_1_1RealMappedSPnode_acf2399376e990903e5787b0a68eb350c}{marginalise} (const std\-::vector$<$ int $>$ \&req\-Dims)
\begin{DoxyCompactList}\small\item\em \-Marginalise this. \end{DoxyCompactList}\item 
const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \hyperlink{classsubpavings_1_1RealMappedSPnode_ab3ac1ccd24132d04f136a0fab3d0b610}{make\-Marginalised} (const std\-::vector$<$ int $>$ \&req\-Dims) const 
\begin{DoxyCompactList}\small\item\em \-Make a marginalised version of this. \end{DoxyCompactList}\item 
virtual void \hyperlink{classsubpavings_1_1RealMappedSPnode_a8b02632446a3c28a352f15f511e35caa}{normalise} ()
\begin{DoxyCompactList}\small\item\em \-Normalise this. \end{DoxyCompactList}\item 
const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \hyperlink{classsubpavings_1_1RealMappedSPnode_a66a8b6deef3ba770a80a5b0b0418f5fc}{make\-Normalised} () const 
\begin{DoxyCompactList}\small\item\em \-Make a normalised version of this. \end{DoxyCompactList}\item 
void \hyperlink{classsubpavings_1_1RealMappedSPnode_ac674f3231fb03622048986a2a855b224}{slice} (const std\-::vector$<$ int $>$ \&slice\-Dims, const std\-::vector$<$ cxsc\-::real $>$ \&slice\-Pts)
\begin{DoxyCompactList}\small\item\em \-Slice this. \end{DoxyCompactList}\item 
const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \hyperlink{classsubpavings_1_1RealMappedSPnode_a2541f9ce5af2fcb753644d1f7e1f9297}{make\-Slice} (const std\-::vector$<$ int $>$ \&slice\-Dims, const std\-::vector$<$ cxsc\-::real $>$ \&slice\-Pts) const 
\begin{DoxyCompactList}\small\item\em \-Make a \-Real\-Mapped\-S\-Pnode that is a slice of this. \end{DoxyCompactList}\item 
cxsc\-::real \hyperlink{classsubpavings_1_1RealMappedSPnode_af243ad67d0ff141d345e800b651a87e1}{get\-L1\-Distance} (const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \&other) const 
\item 
cxsc\-::real \hyperlink{classsubpavings_1_1RealMappedSPnode_a116f7a6b92d5c442be9d8393b6e0e73f}{get\-Log\-Likelihood} (const \hyperlink{classsubpavings_1_1SPSnode}{\-S\-P\-Snode} \&spn) const 
\begin{DoxyCompactList}\small\item\em \-Get a 'log likelihood' using positive values from this and counts from {\itshape spn\/}. \end{DoxyCompactList}\item 
virtual cxsc\-::real \hyperlink{classsubpavings_1_1RealMappedSPnode_a153b19ceeba356f0ada4e27dfcf6ab37}{get\-Real\-Area\-Range\-With\-Box} () const 
\begin{DoxyCompactList}\small\item\em \-Get the \char`\"{}area\char`\"{} of the range and the box of this. \end{DoxyCompactList}\item 
virtual cxsc\-::dotprecision \hyperlink{classsubpavings_1_1RealMappedSPnode_a8f083e792f8980eec67298253428c5c9}{get\-Dot\-Precision\-Area\-Range\-With\-Box} () const 
\begin{DoxyCompactList}\small\item\em \-Get the \char`\"{}area\char`\"{} of the range and the box of this as a dotprecision type. \end{DoxyCompactList}\item 
virtual cxsc\-::real \hyperlink{classsubpavings_1_1RealMappedSPnode_a23ef95e66b4b920f205739d9cf42f96f}{get\-Total\-Leaf\-Area\-Range\-With\-Box} () const 
\begin{DoxyCompactList}\small\item\em \-Get the total \char`\"{}area\char`\"{} for the leaves of this of the real ranges and boxes. \end{DoxyCompactList}\item 
virtual cxsc\-::dotprecision \hyperlink{classsubpavings_1_1RealMappedSPnode_a4f769639fd1e13ea5449bb12dc53c998}{get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box} () const 
\begin{DoxyCompactList}\small\item\em \-Get the total \char`\"{}area\char`\"{} of the range and the box of this as a dotprecision type. \end{DoxyCompactList}\item 
virtual cxsc\-::real \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box} () const 
\begin{DoxyCompactList}\small\item\em \-Get the total absolute \char`\"{}area\char`\"{} for the leaves of this of the real ranges and boxes. \end{DoxyCompactList}\item 
virtual cxsc\-::dotprecision \hyperlink{classsubpavings_1_1RealMappedSPnode_a2901c49d51615810f146a38ccb503fda}{get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box} () const 
\begin{DoxyCompactList}\small\item\em \-Get the total absolute \char`\"{}area\char`\"{} of the range and the box of this as a dotprecision type. \end{DoxyCompactList}\item 
virtual cxsc\-::real \hyperlink{classsubpavings_1_1RealMappedSPnode_a0660b7981cce44ca09c2e0d68a6c1a21}{get\-Total\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box} (const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \&rmsp) const 
\begin{DoxyCompactList}\small\item\em \-Get the total over the leaves of the absolute value of the difference between the leaf \char`\"{}area\char`\"{} for this and for {\itshape rmsp\/}. \end{DoxyCompactList}\item 
virtual cxsc\-::dotprecision \hyperlink{classsubpavings_1_1RealMappedSPnode_a74ba255a0781497c5dc76e8458969278}{get\-Total\-Dot\-Precision\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box} (const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \&rmsp) const 
\begin{DoxyCompactList}\small\item\em \-Get the total over the leaves of the absolute value of the difference between the leaf \char`\"{}area\char`\"{} for this and for {\itshape rmsp\/} as a dotprecision type. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a9591975c77c7e7da92bbdcdf62a74d1a}{\-Ptrs} \& \hyperlink{classsubpavings_1_1RealMappedSPnode_a866601879aed0044333a5f28a773f677}{get\-Leaves} (\hyperlink{classsubpavings_1_1RealMappedSPnode_a9591975c77c7e7da92bbdcdf62a74d1a}{\-Ptrs} \&leaves)
\begin{DoxyCompactList}\small\item\em \-Return a reference to a container of nodes. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a5fc20ec0cd33f031e874f50251156e65}{\-Const\-Ptrs} \& \hyperlink{classsubpavings_1_1RealMappedSPnode_aea6a4c6aa2fe8eb944000db6790f9d8c}{get\-Const\-Leaves} (\hyperlink{classsubpavings_1_1RealMappedSPnode_a5fc20ec0cd33f031e874f50251156e65}{\-Const\-Ptrs} \&leaves) const 
\begin{DoxyCompactList}\small\item\em \-Return a reference to a container of const nodes. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a9591975c77c7e7da92bbdcdf62a74d1a}{\-Ptrs} \& \hyperlink{classsubpavings_1_1RealMappedSPnode_a561d20d602eafff9592fdd0ee912ffcc}{get\-Sub\-Leaves} (\hyperlink{classsubpavings_1_1RealMappedSPnode_a9591975c77c7e7da92bbdcdf62a74d1a}{\-Ptrs} \&subleaves)
\begin{DoxyCompactList}\small\item\em \-Return a reference to a container of nodes. \end{DoxyCompactList}\item 
\hyperlink{classsubpavings_1_1RealMappedSPnode_a5fc20ec0cd33f031e874f50251156e65}{\-Const\-Ptrs} \& \hyperlink{classsubpavings_1_1RealMappedSPnode_ac6e092c4b19b8747f154eefd56d3e864}{get\-Const\-Sub\-Leaves} (\hyperlink{classsubpavings_1_1RealMappedSPnode_a5fc20ec0cd33f031e874f50251156e65}{\-Const\-Ptrs} \&subleaves) const 
\begin{DoxyCompactList}\small\item\em \-Return a reference to a container of const nodes. \end{DoxyCompactList}\item 
void \hyperlink{classsubpavings_1_1RealMappedSPnode_af2612c2a420a9f91c8bca09f0bb6ab42}{swap\-R\-M\-S\-P\-S\-R} (\hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} \&spn)
\end{DoxyCompactItemize}
\subsubsection*{\-Private \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classsubpavings_1_1RealMappedSPnode_a4f2a09e57bff1fd459e8bf631019b07f}{\-\_\-start\-\_\-marginalise} (const std\-::vector$<$ int $>$ \&req\-Dims)
\begin{DoxyCompactList}\small\item\em \-Non-\/public version of marginalisation to have only the required dimensions. \end{DoxyCompactList}\item 
void \hyperlink{classsubpavings_1_1RealMappedSPnode_a14871e233412eac80e1b742967d7ab2b}{\-\_\-marginalise} (const std\-::vector$<$ int $>$ \&out\-Dims)
\begin{DoxyCompactList}\small\item\em \-Non-\/public version of marginalisation to take out the unwanted dimensions. \end{DoxyCompactList}\item 
void \hyperlink{classsubpavings_1_1RealMappedSPnode_a185405d2c7b3231a75b33ec249292e2d}{\-\_\-normalise} ()
\begin{DoxyCompactList}\small\item\em \-Non-\/public version of normalisation. \end{DoxyCompactList}\item 
cxsc\-::dotprecision \& \hyperlink{classsubpavings_1_1RealMappedSPnode_a769c7c79a6ce88db0854b2cbffb97747}{\-\_\-get\-L1distance} (cxsc\-::dotprecision \&dis\-L1, const \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} $\ast$const other) const 
\begin{DoxyCompactList}\small\item\em \-Accumulate \-L1 distance between leaf descendents of this and leaf descendents of node pointed to by {\itshape other\/} into {\itshape dis\-L1\/}. \end{DoxyCompactList}\item 
cxsc\-::dotprecision \& \hyperlink{classsubpavings_1_1RealMappedSPnode_a3171d7822ccbcb05ed2b997c678b325a}{node\-L1\-Distance} (cxsc\-::dotprecision \&dis\-L1, cxsc\-::real other\-\_\-v) const 
\begin{DoxyCompactList}\small\item\em \-Accumulate \-L1 distance between this and another identical node with value {\itshape other\-\_\-v\/} mapped onto it, ie add nodevolume$\ast$(range -\/ other\-\_\-v) onto {\itshape dis\-L1\/}. \end{DoxyCompactList}\item 
cxsc\-::dotprecision \& \hyperlink{classsubpavings_1_1RealMappedSPnode_aa65475d7ae1efb7ba1c7cd5bd0c13c5d}{\-\_\-get\-Log\-Likelihood} (cxsc\-::dotprecision \&loglik, int \&isnan, int \&isposinf, int \&isneginf, const \hyperlink{classsubpavings_1_1SPSnode}{\-S\-P\-Snode} $\ast$const spn) const 
\begin{DoxyCompactList}\small\item\em \-Accumulate log likelihood using positive values from this and counts from {\itshape spn\/}. \end{DoxyCompactList}\item 
std\-::ostream \& \hyperlink{classsubpavings_1_1RealMappedSPnode_a5287c7cec21af1c8606d735c0478a6fc}{one\-Line\-Output} (std\-::ostream \&os, int level=0) const 
\begin{DoxyCompactList}\small\item\em \-A quick one-\/line summary of a node. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-A derived class based on \hyperlink{classsubpavings_1_1MappedSPnode}{\-Mapped\-S\-Pnode} $<$ cxsc\-::real $>$. 

\-The base class \hyperlink{classsubpavings_1_1MappedSPnode}{\-Mapped\-S\-Pnode} is a node in the representation of a mapped regular subpaving as a binary tree, where the type mapped to the nodes is a real. \-A node represents a box (interval vector). \-Mapped\-S\-Pnodes are linked together to form the tree. \-The initial box of the subpaving is the box represented by the root node of the tree. \-A box which has been split will be represented as node with one or two children. \-A subpaving of \mbox{[}{\bfseries x}\mbox{]} (union of non-\/overlapping sub-\/ boxes of \mbox{[}{\bfseries x}\mbox{]}) is represented by the leaves (degenerate/ child-\/less) nodes in the tree. \-Each node will have a single real value mapped to it.

\-A \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} provides the functionality of the \-Mapped\-S\-P\-Node $<$real$>$ and extended functionality appropriate for real mapped nodes, such as marginalisation.

\-Note that arithmetical operations with non-\/real operands can take place provided that there is an implicit conversion from the operand type to a cxsc\-::real, eg the operations this += 2 or this + 2 will give the same results as this += cxsc\-::real(2.\-0) or this + cxsc\-::real(2.\-0) respectively, because there is a implicit conversion from an integer to a cxsc\-::real in the cxsc library. \-Similarly, operations with operands of type double will also succeed.

\begin{DoxyRefDesc}{\-Todo}
\item[\hyperlink{todo__todo000007}{\-Todo}]\-Really it seems like we should not have both the \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} and the \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} classes. \-Should look at the collator stuff and see if that can be the \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} and just replace all this code by that and rename it. \-That would mean that we lose the connection with the templatised \hyperlink{classsubpavings_1_1MappedSPnode}{\-Mapped\-S\-Pnode} class which would be a good thing really -\/ the \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} is adding functionality to the extent that it is not appropriate to see it as a derived class from the mapped nodes any more. \-Combining collators and real mapped spnodes would deal with all the duplication of code that there is at present. \end{DoxyRefDesc}


\-Definition at line 73 of file realmappedspnode.\-hpp.



\subsubsection{\-Member \-Typedef \-Documentation}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a5fc20ec0cd33f031e874f50251156e65}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Const\-Ptrs@{\-Const\-Ptrs}}
\index{\-Const\-Ptrs@{\-Const\-Ptrs}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Const\-Ptrs}]{\setlength{\rightskip}{0pt plus 5cm}typedef std\-::vector$<$ const {\bf \-Real\-Mapped\-S\-Pnode}$\ast$ $>$ {\bf subpavings\-::\-Real\-Mapped\-S\-Pnode\-::\-Const\-Ptrs}}}\label{classsubpavings_1_1RealMappedSPnode_a5fc20ec0cd33f031e874f50251156e65}


\-Definition at line 86 of file realmappedspnode.\-hpp.

\hypertarget{classsubpavings_1_1RealMappedSPnode_a528463bd540e2e3d4dc907ce78a3b03c}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Const\-Ptrs\-Itr@{\-Const\-Ptrs\-Itr}}
\index{\-Const\-Ptrs\-Itr@{\-Const\-Ptrs\-Itr}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Const\-Ptrs\-Itr}]{\setlength{\rightskip}{0pt plus 5cm}typedef \-Const\-Ptrs\-::const\-\_\-iterator {\bf subpavings\-::\-Real\-Mapped\-S\-Pnode\-::\-Const\-Ptrs\-Itr}}}\label{classsubpavings_1_1RealMappedSPnode_a528463bd540e2e3d4dc907ce78a3b03c}


\-Definition at line 88 of file realmappedspnode.\-hpp.

\hypertarget{classsubpavings_1_1RealMappedSPnode_aba04df267c93463fbb6a90d85e11b627}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-List\-Const\-Ptrs@{\-List\-Const\-Ptrs}}
\index{\-List\-Const\-Ptrs@{\-List\-Const\-Ptrs}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-List\-Const\-Ptrs}]{\setlength{\rightskip}{0pt plus 5cm}typedef std\-::list$<$ const {\bf \-Real\-Mapped\-S\-Pnode}$\ast$ $>$ {\bf subpavings\-::\-Real\-Mapped\-S\-Pnode\-::\-List\-Const\-Ptrs}}}\label{classsubpavings_1_1RealMappedSPnode_aba04df267c93463fbb6a90d85e11b627}


\-Definition at line 94 of file realmappedspnode.\-hpp.

\hypertarget{classsubpavings_1_1RealMappedSPnode_ac4e7b7e57068590fc47a5951453754b2}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-List\-Const\-Ptrs\-Itr@{\-List\-Const\-Ptrs\-Itr}}
\index{\-List\-Const\-Ptrs\-Itr@{\-List\-Const\-Ptrs\-Itr}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-List\-Const\-Ptrs\-Itr}]{\setlength{\rightskip}{0pt plus 5cm}typedef \-List\-Const\-Ptrs\-::const\-\_\-iterator {\bf subpavings\-::\-Real\-Mapped\-S\-Pnode\-::\-List\-Const\-Ptrs\-Itr}}}\label{classsubpavings_1_1RealMappedSPnode_ac4e7b7e57068590fc47a5951453754b2}


\-Definition at line 96 of file realmappedspnode.\-hpp.

\hypertarget{classsubpavings_1_1RealMappedSPnode_a13d2adc6fa08d7b1e70a7956eac1affe}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-List\-Ptrs@{\-List\-Ptrs}}
\index{\-List\-Ptrs@{\-List\-Ptrs}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-List\-Ptrs}]{\setlength{\rightskip}{0pt plus 5cm}typedef std\-::list$<${\bf \-Real\-Mapped\-S\-Pnode}$\ast$ $>$ {\bf subpavings\-::\-Real\-Mapped\-S\-Pnode\-::\-List\-Ptrs}}}\label{classsubpavings_1_1RealMappedSPnode_a13d2adc6fa08d7b1e70a7956eac1affe}


\-Definition at line 90 of file realmappedspnode.\-hpp.

\hypertarget{classsubpavings_1_1RealMappedSPnode_ad10e24d2efdb436ae6f65306c8ff736e}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-List\-Ptrs\-Itr@{\-List\-Ptrs\-Itr}}
\index{\-List\-Ptrs\-Itr@{\-List\-Ptrs\-Itr}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-List\-Ptrs\-Itr}]{\setlength{\rightskip}{0pt plus 5cm}typedef \-List\-Ptrs\-::iterator {\bf subpavings\-::\-Real\-Mapped\-S\-Pnode\-::\-List\-Ptrs\-Itr}}}\label{classsubpavings_1_1RealMappedSPnode_ad10e24d2efdb436ae6f65306c8ff736e}


\-Definition at line 92 of file realmappedspnode.\-hpp.

\hypertarget{classsubpavings_1_1RealMappedSPnode_a9591975c77c7e7da92bbdcdf62a74d1a}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Ptrs@{\-Ptrs}}
\index{\-Ptrs@{\-Ptrs}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Ptrs}]{\setlength{\rightskip}{0pt plus 5cm}typedef std\-::vector$<${\bf \-Real\-Mapped\-S\-Pnode}$\ast$ $>$ {\bf subpavings\-::\-Real\-Mapped\-S\-Pnode\-::\-Ptrs}}}\label{classsubpavings_1_1RealMappedSPnode_a9591975c77c7e7da92bbdcdf62a74d1a}


\-Definition at line 82 of file realmappedspnode.\-hpp.

\hypertarget{classsubpavings_1_1RealMappedSPnode_a8414841542df48678ae521df3ae92800}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Ptrs\-Itr@{\-Ptrs\-Itr}}
\index{\-Ptrs\-Itr@{\-Ptrs\-Itr}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Ptrs\-Itr}]{\setlength{\rightskip}{0pt plus 5cm}typedef \-Ptrs\-::iterator {\bf subpavings\-::\-Real\-Mapped\-S\-Pnode\-::\-Ptrs\-Itr}}}\label{classsubpavings_1_1RealMappedSPnode_a8414841542df48678ae521df3ae92800}


\-Definition at line 84 of file realmappedspnode.\-hpp.



\subsubsection{\-Constructor \& \-Destructor \-Documentation}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a55594a45ac82b31b5ae7592143079794}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!$\sim$\-Real\-Mapped\-S\-Pnode@{$\sim$\-Real\-Mapped\-S\-Pnode}}
\index{$\sim$\-Real\-Mapped\-S\-Pnode@{$\sim$\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{$\sim$\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::$\sim$\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a55594a45ac82b31b5ae7592143079794}


\-Definition at line 40 of file realmappedspnode.\-cpp.


\begin{DoxyCode}
{}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a21248dfec3fc7415a604f2f1a5d58ce6}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}}
\index{\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsubpavings_1_1RealMappedSPnode_a21248dfec3fc7415a604f2f1a5d58ce6}


\-No-\/argument constructor. 



\-Definition at line 44 of file realmappedspnode.\-cpp.



\-Referenced by \-\_\-marginalise(), node\-Expand(), and \-Real\-Mapped\-S\-Pnode().


\begin{DoxyCode}
  : MappedSPnode<cxsc::real>() {}   // uses the base SPnode class default
       constructor
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a8f2de173f1eb55690cafb07020bfa5e5}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}}
\index{\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
\item[{const ivector \&}]{v}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}explicit\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a8f2de173f1eb55690cafb07020bfa5e5}


initialised constructor. 

\-Initialised with a box. \-Range is set to 0.\-0. 

\-Definition at line 50 of file realmappedspnode.\-cpp.


\begin{DoxyCode}
  : MappedSPnode<cxsc::real>(v, real(0.0)) {}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a6ca684686609263ecb8579a95276e2bf}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}}
\index{\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Lab\-Box} \&}]{lb}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}explicit\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a6ca684686609263ecb8579a95276e2bf}


\-Initialised constructor. 

\-Initialised with a labeled box. \-Range is set to 0.\-0. 

\-Definition at line 57 of file realmappedspnode.\-cpp.


\begin{DoxyCode}
  : MappedSPnode<cxsc::real>(lb, real(0.0)) {}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a77bada00301c6333863d80ca002fd86c}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}}
\index{\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
\item[{const ivector \&}]{v, }
\item[{const cxsc\-::real \&}]{range}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}explicit\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a77bada00301c6333863d80ca002fd86c}


\-Initialised constructor. 

\-Initialised with a box and and a real value for the range. 

\-Definition at line 65 of file realmappedspnode.\-cpp.


\begin{DoxyCode}
  : MappedSPnode<cxsc::real>(v, range) {}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a12af9b0be5c63f0e1af1849d70b1b647}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}}
\index{\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Lab\-Box} \&}]{lb, }
\item[{const cxsc\-::real \&}]{range}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}explicit\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a12af9b0be5c63f0e1af1849d70b1b647}


\-Initialised constructor. 

\-Initialised with a labeled box and a real value for the range\-Collection. 

\-Definition at line 73 of file realmappedspnode.\-cpp.


\begin{DoxyCode}
  : MappedSPnode<cxsc::real>(lb, range) {}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_add6e4bba67a9d900ebebf07f420ad813}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}}
\index{\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
\item[{const {\bf \-S\-Pnode} \&}]{spn}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}explicit\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_add6e4bba67a9d900ebebf07f420ad813}


\-Constructor initialised with an \hyperlink{classsubpavings_1_1SPnode}{\-S\-Pnode}. 

\-Range is set to csxc\-::real(0.\-0);


\begin{DoxyParams}{\-Parameters}
{\em spn} & \-An \hyperlink{classsubpavings_1_1SPnode}{\-S\-Pnode} to copy. \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{\-Precondition}
{\itshape spn\/} must have a box. 
\end{DoxyPrecond}
\begin{DoxyPostcond}{\-Postcondition}
\-This has a subpaving identical to {\itshape spn\/} and the value mapped onto each node of this is 0.\-0. 
\end{DoxyPostcond}


\-Definition at line 80 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::get\-Box(), subpavings\-::\-S\-Pnode\-::get\-Left\-Child(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), subpavings\-::\-S\-Pnode\-::get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::has\-L\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::has\-R\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::is\-Empty(), subpavings\-::\-S\-Pnode\-::left\-Child, subpavings\-::\-S\-Pnode\-::node\-Add\-Left(), subpavings\-::\-S\-Pnode\-::node\-Add\-Right(), subpavings\-::\-S\-Pnode\-::node\-Name, subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range, \-Real\-Mapped\-S\-Pnode(), subpavings\-::\-S\-Pnode\-::right\-Child, and subpavings\-::\-S\-Pnode\-::the\-Box.


\begin{DoxyCode}
{
  if (!spn.isEmpty()) { 
    theBox = new ivector( spn.getBox() );
  }
  nodeName = spn.getNodeName();
  range = 0.0;
  
  //recursion on the children
  if (spn.hasLCwithBox()) {
    nodeAddLeft(new RealMappedSPnode(
      *(spn.getLeftChild())));
  }
  else leftChild=NULL;

  if (spn.hasRCwithBox()) {
    nodeAddRight(new RealMappedSPnode(
      *(spn.getRightChild())));
  }
  else rightChild=NULL;

}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a4ec458c112685446a703ae73fe812b84}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}}
\index{\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
\item[{const {\bf \-S\-P\-Snode} \&}]{spn}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}explicit\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a4ec458c112685446a703ae73fe812b84}
\-Constructor initialised with an \hyperlink{classsubpavings_1_1SPSnode}{\-S\-P\-Snode}.

\-A \hyperlink{classsubpavings_1_1NoBox__Error}{\-No\-Box\-\_\-\-Error} is thrown if {\itshape other\/} has no box.


\begin{DoxyParams}{\-Parameters}
{\em spn} & \-An \hyperlink{classsubpavings_1_1SPSnode}{\-S\-P\-Snode} to copy. \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{\-Precondition}
{\itshape spn\/} must have a box. 
\end{DoxyPrecond}
\begin{DoxyPostcond}{\-Postcondition}
\-This has a subpaving identical to {\itshape spn\/} and the value mapped onto each node of this is the value of count/node\-Volume from the equivalent node in {\itshape spn\/}. 
\end{DoxyPostcond}


\-Definition at line 108 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::get\-Box(), subpavings\-::\-S\-P\-Snode\-::get\-Counter(), subpavings\-::\-S\-P\-Snode\-::get\-Left\-Child(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), subpavings\-::\-S\-P\-Snode\-::get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::has\-L\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::has\-R\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::is\-Empty(), subpavings\-::\-S\-Pnode\-::left\-Child, subpavings\-::\-S\-Pnode\-::node\-Add\-Left(), subpavings\-::\-S\-Pnode\-::node\-Add\-Right(), subpavings\-::\-S\-Pnode\-::node\-Name, subpavings\-::\-S\-Pnode\-::node\-Real\-Volume(), subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range, \-Real\-Mapped\-S\-Pnode(), subpavings\-::\-S\-Pnode\-::right\-Child, and subpavings\-::\-S\-Pnode\-::the\-Box.


\begin{DoxyCode}
{
  if (!spn.isEmpty()) { 
    theBox = new ivector( spn.getBox() );
  }
  nodeName = spn.getNodeName();
  range = (1.0*spn.getCounter()/nodeRealVolume());
  
  //recursion on the children
  if (spn.hasLCwithBox()) {
    nodeAddLeft(new RealMappedSPnode(
      *(spn.getLeftChild())));
  }
  else leftChild=NULL;

  if (spn.hasRCwithBox()) {
    nodeAddRight(new RealMappedSPnode(
      *(spn.getRightChild())));
  }
  else rightChild=NULL;

}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_aea3c023626616315bdf71aaee45fa32f}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}}
\index{\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Real\-Mapped\-S\-Pnode} \&}]{other}
\end{DoxyParamCaption}
)}}\label{classsubpavings_1_1RealMappedSPnode_aea3c023626616315bdf71aaee45fa32f}


\-Copy constructor. 

\-Copies from given \-Real\-Mapped\-S\-Pnode downwards. 

\-Definition at line 134 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::get\-Box(), get\-Left\-Child(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), subpavings\-::\-Mapped\-S\-Pnode$<$ T $>$\-::get\-Range(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::has\-L\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::has\-R\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::left\-Child, subpavings\-::\-S\-Pnode\-::node\-Add\-Left(), subpavings\-::\-S\-Pnode\-::node\-Add\-Right(), subpavings\-::\-S\-Pnode\-::node\-Name, subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range, \-Real\-Mapped\-S\-Pnode(), subpavings\-::\-S\-Pnode\-::right\-Child, and subpavings\-::\-S\-Pnode\-::the\-Box.


\begin{DoxyCode}
{
  
  if (other.theBox != NULL) {
    theBox = new ivector( other.getBox() );
  }
  nodeName = other.getNodeName();
  range = other.getRange();
  
  //recursion on the children
  if (other.hasLCwithBox()) {
    nodeAddLeft(new RealMappedSPnode(
      *(other.getLeftChild())));
  }
  else leftChild=NULL;

  if (other.hasRCwithBox()) {
    nodeAddRight(new RealMappedSPnode(
      *(other.getRightChild())));
  }
  else rightChild=NULL;

}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_afcd2676e416102b713d9ce735bc27889}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}}
\index{\-Real\-Mapped\-S\-Pnode@{\-Real\-Mapped\-S\-Pnode}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-Real\-Mapped\-S\-Pnode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Real\-Mapped\-S\-Pnode} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mapped\-S\-Pnode}$<$ cxsc\-::real $>$ \&}]{other}
\end{DoxyParamCaption}
)}}\label{classsubpavings_1_1RealMappedSPnode_afcd2676e416102b713d9ce735bc27889}


\-Copy constructor. 

\-Copies from a given \-Mapped\-S\-Pnode$<$cxsc\-::real$>$ node downwards. 

\-Definition at line 161 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::get\-Box(), subpavings\-::\-Mapped\-S\-Pnode$<$ T $>$\-::get\-Left\-Child(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), subpavings\-::\-Mapped\-S\-Pnode$<$ T $>$\-::get\-Range(), subpavings\-::\-Mapped\-S\-Pnode$<$ T $>$\-::get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::has\-L\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::has\-R\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::is\-Empty(), subpavings\-::\-S\-Pnode\-::left\-Child, subpavings\-::\-S\-Pnode\-::node\-Add\-Left(), subpavings\-::\-S\-Pnode\-::node\-Add\-Right(), subpavings\-::\-S\-Pnode\-::node\-Name, subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range, \-Real\-Mapped\-S\-Pnode(), subpavings\-::\-S\-Pnode\-::right\-Child, and subpavings\-::\-S\-Pnode\-::the\-Box.


\begin{DoxyCode}
{
  if (!other.isEmpty()) {
    theBox = new ivector( other.getBox() );
  }
  nodeName = other.getNodeName();
  range = other.getRange();
  
  //recursion on the children
  if (other.hasLCwithBox()) {
    nodeAddLeft(new RealMappedSPnode(
      *(other.getLeftChild())));
  }
  else leftChild=NULL;

  if (other.hasRCwithBox()) {
    nodeAddRight(new RealMappedSPnode(
      *(other.getRightChild())));
  }
  else rightChild=NULL;
}
\end{DoxyCode}


\subsubsection{\-Member \-Function \-Documentation}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a769c7c79a6ce88db0854b2cbffb97747}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-\_\-get\-L1distance@{\-\_\-get\-L1distance}}
\index{\-\_\-get\-L1distance@{\-\_\-get\-L1distance}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-\_\-get\-L1distance}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::dotprecision \& {\bf \-Real\-Mapped\-S\-Pnode\-::\-\_\-get\-L1distance} (
\begin{DoxyParamCaption}
\item[{cxsc\-::dotprecision \&}]{dis\-L1, }
\item[{const {\bf \-Real\-Mapped\-S\-Pnode} $\ast$const}]{other}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a769c7c79a6ce88db0854b2cbffb97747}


\-Accumulate \-L1 distance between leaf descendents of this and leaf descendents of node pointed to by {\itshape other\/} into {\itshape dis\-L1\/}. 



\-Definition at line 971 of file realmappedspnode.\-cpp.



\-References \-\_\-get\-L1distance(), get\-Left\-Child(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), subpavings\-::\-Mapped\-S\-Pnode$<$ T $>$\-::get\-Range(), subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::get\-Range(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), and node\-L1\-Distance().



\-Referenced by \-\_\-get\-L1distance(), and get\-L1\-Distance().


\begin{DoxyCode}
{
  #ifdef DEBUG_L1
    std::cout << "\nIn _getL1distance, I am " << getNodeName() << std::endl;
  #endif
  
  // other is not a leaf
  if (!other->isLeaf()) {
    
    #ifdef DEBUG_L1
      std::cout << "Other is not a leaf, other name is " << other->getNodeName(
      ) << std::endl;
    #endif
    
    if ( isLeaf() ) {
      
      #ifdef DEBUG_L1
        std::cout << "I am a leaf" << std::endl;
      #endif
    
      // turn it around and use nodeL1Distance with other
      other->nodeL1Distance(disL1, getRange());
    }
    
    else { // I am not a leaf, so recurse
    
      #ifdef DEBUG_L1
        std::cout << "I am not a leaf: recursing" << std::endl;
      #endif
      
      getLeftChild()->_getL1distance(disL1, other->getLeftChild());
      getRightChild()->_getL1distance(disL1, other->getRightChild());
    }
  }
  
  else { // other is a leaf
  
    #ifdef DEBUG_L1
      std::cout << "Other is a leaf, other name is " << other->getNodeName() <<
       std::endl;
    #endif
    
    nodeL1Distance(disL1, other->getRange());
  
  }
  
  return disL1;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_aa65475d7ae1efb7ba1c7cd5bd0c13c5d}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-\_\-get\-Log\-Likelihood@{\-\_\-get\-Log\-Likelihood}}
\index{\-\_\-get\-Log\-Likelihood@{\-\_\-get\-Log\-Likelihood}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-\_\-get\-Log\-Likelihood}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::dotprecision \& {\bf \-Real\-Mapped\-S\-Pnode\-::\-\_\-get\-Log\-Likelihood} (
\begin{DoxyParamCaption}
\item[{cxsc\-::dotprecision \&}]{loglik, }
\item[{int \&}]{isnan, }
\item[{int \&}]{isposinf, }
\item[{int \&}]{isneginf, }
\item[{const {\bf \-S\-P\-Snode} $\ast$const}]{spn}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_aa65475d7ae1efb7ba1c7cd5bd0c13c5d}


\-Accumulate log likelihood using positive values from this and counts from {\itshape spn\/}. 

\-For all leaf nodes with positive values (ie $>$ 0.\-0) in the intersection of the tree rooted at this and the tree rooted at {\itshape spn\/}, including this if this is a leaf, accumulates n\-\_\-j $\ast$ ln(v\-\_\-j) into {\itshape loglik\/} where v\-\_\-j is the value on the leaf node of this and n\-\_\-j is the count from the corresponding leaf node of {\itshape spn\/}.

\-If v\-\_\-j $<$ 0.\-0 (including -\/infinity) is encountered for any leaf where {\itshape spn\/} has points, the isnan flag is set to 1. \-Otherwise if v\-\_\-j == 0.\-0 is encountered for any leaf where {\itshape spn\/} has points, the isneginf flag is set to 1 and the log likelihood becomes -\/infinity. \-Otherwise if v\-\_\-j == infinity is encountered for any leaf where {\itshape spn\/} has points, the isposinf flag is set to 1 and log likelihood becomes +infinity. 

\-Definition at line 1065 of file realmappedspnode.\-cpp.



\-References \-\_\-get\-Log\-Likelihood(), subpavings\-::\-S\-P\-Snode\-::get\-Counter(), get\-Left\-Child(), subpavings\-::\-S\-P\-Snode\-::get\-Left\-Child(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::get\-Range(), get\-Right\-Child(), subpavings\-::\-S\-P\-Snode\-::get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), and taylor\-::ln().



\-Referenced by \-\_\-get\-Log\-Likelihood(), and get\-Log\-Likelihood().


\begin{DoxyCode}
{
  #ifdef DEBUG_LL
    std::cout << "\nIn _getLogLikelihood, I am " << getNodeName() 
    << ", and loglik is " << (rnd(loglik)) << endl;
    << ", and isnan is " << isnan << ", and isinf is " << isinf <<  << endl;
    std::cout << "\nspn is " << spn->getNodeName() << std::endl;
  #endif
  
  // not already nan , and neither this nor spn is a leaf, so we recurse
  if (!isnan && !isLeaf() && !(spn->isLeaf())) {
    
    #ifdef DEBUG_LL
      std::cout << "All okay and neither I nor spn is a leaf" << std::endl;
    #endif
    
    loglik = getLeftChild()->_getLogLikelihood(loglik, 
                isnan, isposinf, isneginf,
                spn->getLeftChild() );
    if (!isnan) { // check again on isnan
      loglik = getRightChild()->_getLogLikelihood(loglik, 
                isnan, isposinf, isneginf,
                spn->getRightChild() );
    }
  }
  else if (!isnan) { // this is a leaf OR spn is a leaf - can already be inf
  
    // add in nj*log(hj) for me
    size_t n = spn->getCounter();
    
    #ifdef DEBUG_LL
      std::cout << "I am a leaf, my range value is " << getRange() << endl;
      std::cout << ", and spn->getCounter is " << n << std::endl;
    #endif
      
    if (n > 0) {
      
      /* if already +infinity we can reset this to nan (- range) or -infinity
       (0 range)
      * if already -infinity we can reset this to nan (-range) */
    
      real rng = getRange();
      
      if (rng < 0.0) { // nan whenever we find a negative range even if n ==0;
        isnan = 1; // change by ref
        #ifdef DEBUG_LL
          std::cout << "rng < 0.0: adding nothing to log lik, ";
          std::cout << "and isnan = " << isnan << std::endl;
          std::cout << "loglik is now: " << (rnd(loglik)) << std::endl;
        #endif
      }
      
      // -inf will be < 0 and also IsInfinity so the else if gives +infs
      else if (!isneginf) {
        if ( gsl_isinf(_double(rng)) ) {
          if (!isposinf ) {
            // only reset to +ve infinity if not already infinity (+ve or n-ve)
            isposinf = 1; // change by ref
            loglik = cxsc::dotprecision(cxsc::Infinity);
            #ifdef DEBUG_LL
              std::cout << "rng is Infinity: log lik = inf, ";
              std::cout << "and isposinf = " << isposinf << std::endl;
              std::cout << "loglik is now: " << (rnd(loglik)) << std::endl;
            #endif
          }
        }
        else if (rng > 0.0) { // not +ve infinity
          if (!isposinf) {
            accumulate(loglik, (1.0*n), cxsc::ln(getRange()));
            #ifdef DEBUG_LL
              std::cout << "adding the following to log lik: ";
              std::cout << (n * cxsc::ln(rng)) << std::endl;
            #endif
          }
        }
        else { // range must be 0.0 
          isneginf = 1; // change by ref
          loglik = cxsc::dotprecision(-cxsc::Infinity);
          #ifdef DEBUG_LL
            std::cout << "rng is 0.0: log lik = -inf, ";
            std::cout << "and isneginf = " << isneginf << std::endl;
            std::cout << "loglik is now: " << (rnd(loglik)) << std::endl;
          #endif
        }
      }
    }
      
  }
  
  return loglik;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a14871e233412eac80e1b742967d7ab2b}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-\_\-marginalise@{\-\_\-marginalise}}
\index{\-\_\-marginalise@{\-\_\-marginalise}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-\_\-marginalise}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Real\-Mapped\-S\-Pnode\-::\-\_\-marginalise} (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ int $>$ \&}]{out\-Dims}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a14871e233412eac80e1b742967d7ab2b}


\-Non-\/public version of marginalisation to take out the unwanted dimensions. 



\-Definition at line 783 of file realmappedspnode.\-cpp.



\-References \-\_\-marginalise(), subpavings\-::\-S\-Pnode\-::get\-Box(), get\-Left\-Child(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), get\-Parent(), subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::get\-Range(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::get\-Split\-Dim(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), taylor\-::\-Lb(), subpavings\-::\-S\-Pnode\-::left\-Child, one\-Line\-Output(), subpavings\-::\-S\-Pnode\-::parent, subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range, \-Real\-Mapped\-S\-Pnode(), real\-Volume(), subpavings\-::\-S\-Pnode\-::recursive\-Rename(), subpavings\-::\-S\-Pnode\-::right\-Child, swap\-R\-M\-S\-P\-S\-R(), and taylor\-::\-Ub().



\-Referenced by \-\_\-marginalise(), and \-\_\-start\-\_\-marginalise().


\begin{DoxyCode}
{
  #ifdef MARG_OUTPUT
    std::cout << "I am " << getNodeName() << std::endl;
  #endif
  
  ivector box = getBox();
  
  // find if this node split on one of the given dimensions
  // returns -1 if no split
  // make sure we do this before fiddling with the children!
  int splitDim = getSplitDim();
  
  // deal with children first
  if (!isLeaf()) {
    
    #ifdef MARG_OUTPUT
      std::cout << "not a leaf - marginalising children\n" << std::endl;
    #endif
  
    getLeftChild()->_marginalise(outDims);    
    getRightChild()->_marginalise(outDims); 
  }               
          
  // now deal with this node itself
  #ifdef MARG_OUTPUT
    if (!isLeaf()) std::cout << "\nback in " << getNodeName() << std::endl;
    std::cout << "\tmy split dimension is " << splitDim << std::endl;
  #endif
  
  std::vector<int>::const_iterator found 
      = find (outDims.begin(), outDims.end(), splitDim);
  
  /* if we split on any of the given dimensions
   then we drop this from the tree entirely and
   replace it with the result
   of adding the two new children together */
  if (found < outDims.end()) { // split on one of the outDims
    // so this will become the result of adding together
    // the two marginlised children
    // note - can never be in here if this is a leaf
    
    #ifdef MARG_OUTPUT
      std::cout << "\tmy split dim is one of the dimensions to be removed" << 
      std::endl;
    #endif
    
    // save who our parent is
    RealMappedSPnode* savedParent = getParent();
    
    // and detach ourselves from parent
    parent = NULL;
    
    // make a copy of the addition left and
    // right children - use the copy constructor to
    // make a temporary, do addition and then just swap 
    
    RealMappedSPnode temp(*getLeftChild());
    
    // keep the same number of elements in the range collection
    temp += (*getRightChild());
    
    swapRMSPSR(temp); //swap me and temp
    
    #ifdef MARG_OUTPUT
      std::cout << "\tre-made me out of parallel addition collation of my
       children:" 
                  << std::endl;
      std::cout << "\tmy range collection is " << range << std::endl;
      std::cout << "\tand my box is " << getBox() << std::endl;
      if (!isLeaf() ) {
        std::cout << "\tand my children (before renaming) are:" << std::endl;
        getLeftChild()->oneLineOutput(std::cout, 2);
        getRightChild()->oneLineOutput(std::cout, 2);
      }
    #endif
    
    // restore relationship to parent
    parent = savedParent;
    
  }
  else { // did not split on an outdim or is a leaf
    // have to contract this
    // marginalised children (if any) will still be attached
    
    #ifdef MARG_OUTPUT
      std::cout << "\tI did not split on a dimension to take out, or I am a
       leaf, so need to contract box" << std::endl;
      std::cout << "\tmy box is " << box << std::endl;
    #endif
    
    int dim = VecLen(box);
    int boxLB = Lb(box);
  
    int newDims = dim - outDims.size();
    ivector newBox = ivector(newDims); 
    int index = Lb(newBox);
    int oldindex = boxLB;
  
    // put in the upper and lower bounds for the new box
    // for each dimension that stays  
    for (; oldindex <= Ub(box); oldindex++) {
      std::vector<int>::const_iterator fit 
      = find (outDims.begin(), outDims.end(), (oldindex - boxLB + 1));
      if (!(fit < outDims.end())) { // keep this one
        newBox[index] = box[oldindex];
        index++;
      }
    }
    
    // find the volume we missed
    cxsc::real missingVol = realVolume(box)/realVolume(newBox);
    
    #ifdef MARG_OUTPUT
      std::cout << "\tnew box is " << newBox << std::endl;
      std::cout << "\tmissing volume is " << missingVol << std::endl;
    #endif
    
    //store the child node locations and then temporarily detach them
    RealMappedSPnode* savedLC = getLeftChild();
    RealMappedSPnode* savedRC = getRightChild();
    leftChild = NULL;
    rightChild = NULL;
    
    // also need to store parent
    RealMappedSPnode* savedParent = getParent();
    parent = NULL;
    
    #ifdef MARG_OUTPUT
      std::cout << "\tcurrent range is " << range << std::endl;
    #endif
  
    cxsc::real temp = getRange();
    
    temp *= missingVol;
    
    #ifdef MARG_OUTPUT
      std::cout << "scaled up range is " << temp << std::endl;
    #endif
    
    // replace contents of this with contents of a newly made node  
    RealMappedSPnode 
        tempNode( RealMappedSPnode(newBox, temp) );
    this->swapRMSPSR(tempNode);
    
    #ifdef MARG_OUTPUT
      std::cout << "\tafter contracting, my box is " << getBox() << std::endl;
      std::cout << "\tand after scaling up my range ,";
      std::cout << "\n\tmy range is " << range << std::endl;
    #endif
    
    // put the child pointers back, and reattach to parent
    leftChild = savedLC;
    rightChild = savedRC;
    parent = savedParent;
    
  } // finished else
  
  //if we are the root, recursively rename everything
  if (getParent() == NULL) {
    recursiveRename();
    #ifdef MARG_OUTPUT
      std::cout << "\nNow recursively rename everything from me down\n\n" << 
      std::endl;
    #endif
  }
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a185405d2c7b3231a75b33ec249292e2d}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-\_\-normalise@{\-\_\-normalise}}
\index{\-\_\-normalise@{\-\_\-normalise}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-\_\-normalise}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Real\-Mapped\-S\-Pnode\-::\-\_\-normalise} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a185405d2c7b3231a75b33ec249292e2d}


\-Non-\/public version of normalisation. 



\-Definition at line 949 of file realmappedspnode.\-cpp.



\-References get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box(), and subpavings\-::\-S\-Pnode\-::is\-Empty().



\-Referenced by make\-Normalised(), and normalise().


\begin{DoxyCode}
{
  if ( isEmpty() ) {
    throw NoBox_Error(
      "RealMappedSPnode::_normalise()");
  }
  
  cxsc::real normaliser = getTotalAbsLeafAreaRangeWithBox();
  if (normaliser == cxsc::Infinity) {
    throw std::runtime_error(
      "RealMappedSPnode::_normalise() : Normalising constant is Infinity");
  }
  if (normaliser <= 0.0) {
    throw std::runtime_error(
      "RealMappedSPnode::_normalise() : Normalising constant is <= 0.0");
  }
  (*this) /= normaliser;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a4f2a09e57bff1fd459e8bf631019b07f}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!\-\_\-start\-\_\-marginalise@{\-\_\-start\-\_\-marginalise}}
\index{\-\_\-start\-\_\-marginalise@{\-\_\-start\-\_\-marginalise}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{\-\_\-start\-\_\-marginalise}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Real\-Mapped\-S\-Pnode\-::\-\_\-start\-\_\-marginalise} (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ int $>$ \&}]{req\-Dims}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a4f2a09e57bff1fd459e8bf631019b07f}


\-Non-\/public version of marginalisation to have only the required dimensions. 



\-Definition at line 731 of file realmappedspnode.\-cpp.



\-References \-\_\-marginalise(), subpavings\-::\-S\-Pnode\-::get\-Box(), subpavings\-::\-S\-Pnode\-::is\-Empty(), taylor\-::\-Lb(), and taylor\-::\-Ub().



\-Referenced by make\-Marginalised(), and marginalise().


\begin{DoxyCode}
{
  if ( isEmpty() ) {
    throw NoBox_Error(
    "RealMappedSPnode::_start_marginalise(const std::vector<int>&)");
  }
  
  
  if (reqDims.empty()) {
    throw std::invalid_argument(
      "RealMappedSPnode::_start_marginalise(const std::vector<int>&) :
       reqDims.empty()");
  }
  
  // want to find what dimensions to take out given required dimensions
  ivector box = getBox();
  int dim = VecLen(box);
  int boxLB = Lb(box);
  int boxUB = Ub(box);
  //each of the required dims must be there
  std::vector<int> sorted = reqDims;
  sort(sorted.begin(), sorted.end());
  
  // remove any duplicates
  vector<int>::iterator it = unique (sorted.begin(), sorted.end());
  sorted.resize( it - sorted.begin() );

  if ( (*(sorted.begin()) < 1)) {
    throw std::invalid_argument(
    "RealMappedSPnode::_start_marginalise(const std::vector<int>&) : Dimensions
       < 1");
  }
  
  if (*(sorted.rbegin()) > boxUB - boxLB + 1)  {
    throw std::invalid_argument(
    "RealMappedSPnode::_start_marginalise(const std::vector<int>&) : Dimension
       too large for box");
  }
  // could use min and max, but we want the not-req dims anyway
  std::vector<int> outDims;
  
  for (int i = 1; i <= dim; i++) {
    if (!(find(reqDims.begin(), reqDims.end(), i) < reqDims.end())) {
      // dim of box was not in reqDims 
      outDims.push_back(i);
    }
  }
  
  // now we have the dimensions to take out
  _marginalise(outDims); // use internal version
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a9409b660d7a7f1f35fc7f2d1904386c2}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!find\-Containing\-Node@{find\-Containing\-Node}}
\index{find\-Containing\-Node@{find\-Containing\-Node}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{find\-Containing\-Node}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf \-Real\-Mapped\-S\-Pnode} $\ast$ {\bf \-Real\-Mapped\-S\-Pnode\-::find\-Containing\-Node} (
\begin{DoxyParamCaption}
\item[{const cxsc\-::rvector \&}]{pt, }
\item[{{\bf \-O\-P\-E\-R\-A\-T\-I\-O\-N\-S\-\_\-\-O\-N}}]{child\-Ind = {\ttfamily {\bf \-O\-N\-\_\-\-P\-A\-R\-E\-N\-T}}}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_a9409b660d7a7f1f35fc7f2d1904386c2}
\-Get a pointer to the leaf node descendent of this whose box contains the point {\itshape pt\/}.

\begin{DoxyReturn}{\-Returns}
\-N\-U\-L\-L if no leaf node descendent of this contains {\itshape pt\/}, otherwise a pointer to the leaf node descendent of this whose box contains the point {\itshape pt\/}. 
\end{DoxyReturn}


\-Definition at line 265 of file realmappedspnode.\-cpp.



\-References get\-Left\-Child(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::has\-L\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::has\-R\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::is\-Empty(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), subpavings\-::\-S\-Pnode\-::node\-Contains(), subpavings\-::\-O\-N\-\_\-\-L\-E\-F\-T, and subpavings\-::\-O\-N\-\_\-\-R\-I\-G\-H\-T.


\begin{DoxyCode}
{
  if ( isEmpty() ) {
    throw NoBox_Error(
    "RealMappedSPnode::findContainingNode(const cxsc::rvector&, OPERATIONS_ON)"
      );
  }
  // start at the top
  const RealMappedSPnode* retObj = NULL;
  
  if(nodeContains(pt, childInd)) {
    
    if(isLeaf()) {

      // give this node as return value
      retObj = this;

    } // end of isLeaf

    // if not a leaf and contains data
    // recurse on the children if any
    else {

      if(hasRCwithBox()){
        
        retObj =
        (getRightChild())->findContainingNode(
          pt, ON_RIGHT);
        
      }
      // only try left if we did not find on the right
      if(retObj == NULL && hasLCwithBox()) {
        retObj =
        (getLeftChild())->findContainingNode(
          pt, ON_LEFT);
        
      }
    }

  } // end if node contains

  // will return null if does not contain the data
  
  return retObj;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_aea6a4c6aa2fe8eb944000db6790f9d8c}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Const\-Leaves@{get\-Const\-Leaves}}
\index{get\-Const\-Leaves@{get\-Const\-Leaves}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Const\-Leaves}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Const\-Ptrs} \& {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Const\-Leaves} (
\begin{DoxyParamCaption}
\item[{{\bf \-Real\-Mapped\-S\-Pnode\-::\-Const\-Ptrs} \&}]{leaves}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_aea6a4c6aa2fe8eb944000db6790f9d8c}


\-Return a reference to a container of const nodes. 

\-Contents of container are the leaves descended from this, or this if this is a leaf, left to right order. 

\-Definition at line 656 of file realmappedspnode.\-cpp.



\-References get\-Const\-Leaves(), get\-Left\-Child(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::has\-L\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::has\-R\-Cwith\-Box(), and subpavings\-::\-S\-Pnode\-::is\-Leaf().



\-Referenced by get\-Const\-Leaves().


\begin{DoxyCode}
{
  //if children, recurse on the children
  if (hasLCwithBox()) {
    getLeftChild()->getConstLeaves(leaves);
  }

  if (hasRCwithBox()) {
    getRightChild()->getConstLeaves(leaves);
  }

  if ( isLeaf() ) { // this is a leaf
    leaves.push_back(this);
  }
  return leaves;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_ac6e092c4b19b8747f154eefd56d3e864}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Const\-Sub\-Leaves@{get\-Const\-Sub\-Leaves}}
\index{get\-Const\-Sub\-Leaves@{get\-Const\-Sub\-Leaves}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Const\-Sub\-Leaves}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Const\-Ptrs} \& {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Const\-Sub\-Leaves} (
\begin{DoxyParamCaption}
\item[{{\bf \-Real\-Mapped\-S\-Pnode\-::\-Const\-Ptrs} \&}]{subleaves}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_ac6e092c4b19b8747f154eefd56d3e864}


\-Return a reference to a container of const nodes. 

\-Contents of container are the sub-\/leaves descended from this, or this if this is a sub-\/leaf, left to right order.

\-A sub-\/leaf (aka \char`\"{}cherry\char`\"{}) is a node with two leaf child nodes. 

\-Definition at line 703 of file realmappedspnode.\-cpp.



\-References get\-Const\-Sub\-Leaves(), get\-Left\-Child(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), and subpavings\-::\-S\-Pnode\-::is\-Sub\-Leaf().



\-Referenced by get\-Const\-Sub\-Leaves().


\begin{DoxyCode}
{
  if (isSubLeaf()) { // this is a subleaf
    subleaves.push_back(this);
  }
  //if children, recurse on the children
  else if (!isLeaf()) {
    getLeftChild()->getConstSubLeaves(subleaves);
    getRightChild()->getConstSubLeaves(subleaves);
  }

  
  return subleaves;
  
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a8f083e792f8980eec67298253428c5c9}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Dot\-Precision\-Area\-Range\-With\-Box@{get\-Dot\-Precision\-Area\-Range\-With\-Box}}
\index{get\-Dot\-Precision\-Area\-Range\-With\-Box@{get\-Dot\-Precision\-Area\-Range\-With\-Box}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Dot\-Precision\-Area\-Range\-With\-Box}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::dotprecision {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Dot\-Precision\-Area\-Range\-With\-Box} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a8f083e792f8980eec67298253428c5c9}


\-Get the \char`\"{}area\char`\"{} of the range and the box of this as a dotprecision type. 

\-The \char`\"{}area\char`\"{} returned should be the dotprecision product of the volume of the box represented by this and the real range of this. {\bfseries \-But} note that if the range is cxsc\-::\-Infinity, the dotprecision result is the same as dotprecision(0.\-0). \-This is due to the working of the cxsc library. \-The results can therefore be highly misleading if the range is cxsc\-::\-Infinity

\begin{DoxyReturn}{\-Returns}
dotprecision product of volume of box represented by this and real range of this. 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
\-Range of this is not cxsc\-::\-Infinity. 

this must have a boxe. 
\end{DoxyPrecond}


\-Definition at line 551 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::get\-Range(), and subpavings\-::\-S\-Pnode\-::node\-Real\-Volume().



\-Referenced by get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box(), and get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box().


\begin{DoxyCode}
{
  cxsc::dotprecision result(0.0);
  cxsc::accumulate(result, getRange(), nodeRealVolume());
  return result;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_af243ad67d0ff141d345e800b651a87e1}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-L1\-Distance@{get\-L1\-Distance}}
\index{get\-L1\-Distance@{get\-L1\-Distance}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-L1\-Distance}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::real {\bf \-Real\-Mapped\-S\-Pnode\-::get\-L1\-Distance} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Real\-Mapped\-S\-Pnode} \&}]{other}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_af243ad67d0ff141d345e800b651a87e1}
\-Gets the \-L1 distance between this and another \-Real\-Mapped\-S\-Pnode.

\-The \-L1 distance is defined as the sum of the absolute values of the differences in 'area' represented by the leaf nodes of this and the other paving. \-The 'area' represented by a leaf node is the absolute value mapped to that leaf node multiplied by the volume of the box associated with the node.

\-Throws the following exceptions\-: 
\begin{DoxyItemize}
\item \-Throws a \hyperlink{classsubpavings_1_1NoBox__Error}{\-No\-Box\-\_\-\-Error} if either this or by {\itshape other\/} have no box. 
\item \-Throws a \hyperlink{classsubpavings_1_1IncompatibleDimensions__Error}{\-Incompatible\-Dimensions\-\_\-\-Error} if the dimensions and sizes of the boxes of this and {\itshape other\/} are not the same. 
\end{DoxyItemize}

\begin{DoxyNote}{\-Note}
\-This will not attempt to adjust for any difference in total integral between this and {\itshape other\-:\/} the \-L1 distance is simply taken as the difference between the 'areas' of the leaf boxes.

\-If this or {\itshape other\/} has leaf nodes with infinite ranges then the \-L1 distance between them will be infinite (cxsc\-::\-Infinity).
\end{DoxyNote}

\begin{DoxyParams}{\-Parameters}
{\em other} & the root of a \-Real\-Mapped\-S\-Pnode tree to calculate the \-L1 distance against. \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{\-Precondition}
\-Both this and {\itshape other\/} must have boxes and those boxes must be the same. 
\end{DoxyPrecond}
\begin{DoxyPostcond}{\-Postcondition}
this will be unchanged. 
\end{DoxyPostcond}


\-Definition at line 484 of file realmappedspnode.\-cpp.



\-References \-\_\-get\-L1distance(), subpavings\-::\-S\-Pnode\-::get\-Box(), and subpavings\-::\-S\-Pnode\-::is\-Empty().


\begin{DoxyCode}
{
  if ( isEmpty() || other.isEmpty() ) {
    throw NoBox_Error(
      "RealMappedSPnode::getL1Distance(const RealMappedSPnode&)");
  }
  
  if ( getBox() != other.getBox() ) {
    throw IncompatibleDimensions_Error(
      "RealMappedSPnode::getL1Distance(const RealMappedSPnode&)");
  }
  
  
  
  cxsc::dotprecision retDP(0.0);
  
  if (this != & other) retDP = _getL1distance(retDP, &other);
  
  return cxsc::rnd(retDP);
    
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a866601879aed0044333a5f28a773f677}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Leaves@{get\-Leaves}}
\index{get\-Leaves@{get\-Leaves}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Leaves}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Ptrs} \& {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Leaves} (
\begin{DoxyParamCaption}
\item[{{\bf \-Real\-Mapped\-S\-Pnode\-::\-Ptrs} \&}]{leaves}
\end{DoxyParamCaption}
)}}\label{classsubpavings_1_1RealMappedSPnode_a866601879aed0044333a5f28a773f677}


\-Return a reference to a container of nodes. 

\-Contents of container are the leaves descended from this, or this if this is a leaf, left to right order. 

\-Definition at line 632 of file realmappedspnode.\-cpp.



\-References get\-Leaves(), get\-Left\-Child(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::has\-L\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::has\-R\-Cwith\-Box(), and subpavings\-::\-S\-Pnode\-::is\-Leaf().



\-Referenced by get\-Leaves().


\begin{DoxyCode}
{
  //if children, recurse on the children
  if (hasLCwithBox()) {
    getLeftChild()->getLeaves(leaves);
  }

  if (hasRCwithBox()) {
    getRightChild()->getLeaves(leaves);
  }

  if ( isLeaf() ) { // this is a leaf
    leaves.push_back(this);
  }
  return leaves;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a71ad37450934fcd212d1c13c9f8830d4}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Left\-Child@{get\-Left\-Child}}
\index{get\-Left\-Child@{get\-Left\-Child}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Left\-Child}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode} $\ast$ {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Left\-Child} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_a71ad37450934fcd212d1c13c9f8830d4}


\-Accessor for the left child of a node. 

\-Returns a copy of the pointer to left\-Child node. 

\-Reimplemented from \hyperlink{classsubpavings_1_1MappedSPnode_a31cc4a453d0c821592096b1829e43093}{subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$}.



\-Definition at line 217 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::left\-Child.



\-Referenced by \-\_\-get\-L1distance(), \-\_\-get\-Log\-Likelihood(), \-\_\-marginalise(), find\-Containing\-Node(), get\-All\-Weights(), get\-Const\-Leaves(), get\-Const\-Sub\-Leaves(), get\-Height\-And\-Box(), get\-Leaves(), get\-Max\-Range\-For\-Leaves\-In\-Tree(), get\-Sub\-Leaves(), get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box(), get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box(), has\-Infinite\-Range\-In\-Tree(), has\-Negative\-Range\-In\-Tree(), node\-Expand(), node\-L1\-Distance(), norm\-Heights(), one\-Line\-Output(), and \-Real\-Mapped\-S\-Pnode().


\begin{DoxyCode}
{ return (RealMappedSPnode*) leftChild; }
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a116f7a6b92d5c442be9d8393b6e0e73f}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Log\-Likelihood@{get\-Log\-Likelihood}}
\index{get\-Log\-Likelihood@{get\-Log\-Likelihood}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Log\-Likelihood}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::real {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Log\-Likelihood} (
\begin{DoxyParamCaption}
\item[{const {\bf \-S\-P\-Snode} \&}]{spn}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_a116f7a6b92d5c442be9d8393b6e0e73f}


\-Get a 'log likelihood' using positive values from this and counts from {\itshape spn\/}. 

\-Treats the rages mapped onto the nodes of this like function values and uses the counts from {\itshape spn\/} together with these values to calculate a 'log-\/likelihood'.

\-If range $<$ 0.\-0 (including -\/infinity) is encountered for any leaf where {\itshape spn\/} has points, the method will return cxsc\-::\-Signaling\-Na\-N. \-Otherwise if range == 0.\-0 is encountered for any leaf where {\itshape spn\/} has points, the method will return -\/cxsc\-::\-Infinity. \-Otherwise if range == infinity is encountered for any leaf where {\itshape spn\/} has points, the method will return -\/cxsc\-::\-Infinity.


\begin{DoxyParams}{\-Parameters}
{\em spn} & is the root of an \hyperlink{classsubpavings_1_1SPSnode}{\-S\-P\-Snode} tree which provides information about counts. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
the sum over the leaf nodes with positive values in the intersection of the tree rooted at this and the tree rooted at {\itshape spn\/} of the product of the log of the value on the leaf descendent of this and the count on the corresponding leaf descendent of {\itshape spn\/}. \-Returns cxsc\-::\-Signaling\-Na\-N if negative ranges are encountered, else returns -\/cxsc\-::\-Infinity if zero ranges are encountered, else returns cxsc\-::\-Infinity if any infinite ranges are encountered. 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
this and {\itshape spn\/} are both non-\/empty and both have the same box. 
\end{DoxyPrecond}


\-Definition at line 508 of file realmappedspnode.\-cpp.



\-References \-\_\-get\-Log\-Likelihood(), subpavings\-::\-S\-Pnode\-::get\-Box(), subpavings\-::\-S\-P\-Snode\-::get\-Counter(), and subpavings\-::\-S\-Pnode\-::is\-Empty().


\begin{DoxyCode}
{
  if ( isEmpty() || spn.isEmpty() ) {
    throw NoBox_Error(
      "RealMappedSPnode::getLogLikelihood(const SPSnode&)");
  }
  
  if ( getBox() != spn.getBox() ) {
    throw IncompatibleDimensions_Error(
      "RealMappedSPnode::getLogLikelihood(const SPSnode&)");
  }
  cxsc::real result(0.0);
  
  if (spn.getCounter() > 0) {
    
    cxsc::dotprecision loglik(0.0);
    
    int isnan = 0;
    int isposinf =0;
    int isneginf =0; // all these 3 changed by ref
    
    _getLogLikelihood(loglik, isnan, isposinf, isneginf, &spn);
    
    /*nan if nan flag is set*/
    if (isnan ) result = cxsc::SignalingNaN;
    else result = cxsc::rnd(loglik);
    /* result could be -inf if there are 0 ranges in tree where spn 
     * has points or inf if there are inf ranges in tree where spn has points*/
       
  }

  return result;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_abae5bea82b46019e23d98756973c6860}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Max\-Range\-For\-Leaves\-In\-Tree@{get\-Max\-Range\-For\-Leaves\-In\-Tree}}
\index{get\-Max\-Range\-For\-Leaves\-In\-Tree@{get\-Max\-Range\-For\-Leaves\-In\-Tree}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Max\-Range\-For\-Leaves\-In\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::real {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Max\-Range\-For\-Leaves\-In\-Tree} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_abae5bea82b46019e23d98756973c6860}


\-Get maximum value of the range for any of the leaves of the tree rooted at this. 

\-Returns the range of this if this is a leaf.

\begin{DoxyReturn}{\-Returns}
maximum value of the range for any of the leaves of the tree rooted at this. 
\end{DoxyReturn}


\-Definition at line 392 of file realmappedspnode.\-cpp.



\-References get\-Left\-Child(), get\-Max\-Range\-For\-Leaves\-In\-Tree(), subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::get\-Range(), get\-Right\-Child(), and subpavings\-::\-S\-Pnode\-::is\-Leaf().



\-Referenced by get\-Max\-Range\-For\-Leaves\-In\-Tree().


\begin{DoxyCode}
{
  if (isLeaf()) {
    return getRange();
  }
  else {
    cxsc::real rLC = getLeftChild()->getMaxRangeForLeavesInTree();
    cxsc::real rRC = getRightChild()->getMaxRangeForLeavesInTree();
    return (rLC > rRC? rLC : rRC);
  }
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a04fef135a04c4d165c08395c531581dd}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Parent@{get\-Parent}}
\index{get\-Parent@{get\-Parent}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Parent}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode} $\ast$ {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Parent} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_a04fef135a04c4d165c08395c531581dd}


\-Accessor for the parent of a node. 

\-Returns a copy of the pointer to parent node. 

\-Reimplemented from \hyperlink{classsubpavings_1_1MappedSPnode_a700d3bf53c72e2fdecf27446fab902ef}{subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$}.



\-Definition at line 211 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::parent.



\-Referenced by \-\_\-marginalise(), marginalise(), and normalise().


\begin{DoxyCode}
{ return (RealMappedSPnode*) parent; }
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a153b19ceeba356f0ada4e27dfcf6ab37}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Real\-Area\-Range\-With\-Box@{get\-Real\-Area\-Range\-With\-Box}}
\index{get\-Real\-Area\-Range\-With\-Box@{get\-Real\-Area\-Range\-With\-Box}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Real\-Area\-Range\-With\-Box}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::real {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Real\-Area\-Range\-With\-Box} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a153b19ceeba356f0ada4e27dfcf6ab37}


\-Get the \char`\"{}area\char`\"{} of the range and the box of this. 

\-The \char`\"{}area\char`\"{} returned is calculated as the volume of the box represented by this multiplied by the real range of this (which can also be seen as the volume of the box represented by this with another dimension equal to an interval that has \-Inf 0 and \-Sup equal to the range of this).

\begin{DoxyReturn}{\-Returns}
volume of box represented by this multiplied by real range of this. 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
this must have a boxe. 
\end{DoxyPrecond}


\-Definition at line 543 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::get\-Range(), and subpavings\-::\-S\-Pnode\-::node\-Real\-Volume().


\begin{DoxyCode}
{
  return getRange() * nodeRealVolume();
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a19cb07beb697f0f8613a63c0b476ddd9}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Right\-Child@{get\-Right\-Child}}
\index{get\-Right\-Child@{get\-Right\-Child}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Right\-Child}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode} $\ast$ {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Right\-Child} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_a19cb07beb697f0f8613a63c0b476ddd9}


\-Accessor for the right child of a node. 

\-Returns a copy of the pointer to right\-Child node. 

\-Reimplemented from \hyperlink{classsubpavings_1_1MappedSPnode_a3d15d4b64a8c01fbfabdb66c37c89ad9}{subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$}.



\-Definition at line 223 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::right\-Child.



\-Referenced by \-\_\-get\-L1distance(), \-\_\-get\-Log\-Likelihood(), \-\_\-marginalise(), find\-Containing\-Node(), get\-All\-Weights(), get\-Const\-Leaves(), get\-Const\-Sub\-Leaves(), get\-Height\-And\-Box(), get\-Leaves(), get\-Max\-Range\-For\-Leaves\-In\-Tree(), get\-Sub\-Leaves(), get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box(), get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box(), has\-Infinite\-Range\-In\-Tree(), has\-Negative\-Range\-In\-Tree(), node\-Expand(), node\-L1\-Distance(), norm\-Heights(), one\-Line\-Output(), and \-Real\-Mapped\-S\-Pnode().


\begin{DoxyCode}
{ return (RealMappedSPnode*) rightChild; }
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a561d20d602eafff9592fdd0ee912ffcc}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Sub\-Leaves@{get\-Sub\-Leaves}}
\index{get\-Sub\-Leaves@{get\-Sub\-Leaves}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Sub\-Leaves}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode\-::\-Ptrs} \& {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Sub\-Leaves} (
\begin{DoxyParamCaption}
\item[{{\bf \-Real\-Mapped\-S\-Pnode\-::\-Ptrs} \&}]{subleaves}
\end{DoxyParamCaption}
)}}\label{classsubpavings_1_1RealMappedSPnode_a561d20d602eafff9592fdd0ee912ffcc}


\-Return a reference to a container of nodes. 

\-Contents of container are the sub-\/leaves descended from this, or this if this is a sub-\/leaf, left to right order.

\-A sub-\/leaf (aka \char`\"{}cherry\char`\"{}) is a node with two leaf child nodes. 

\-Definition at line 680 of file realmappedspnode.\-cpp.



\-References get\-Left\-Child(), get\-Right\-Child(), get\-Sub\-Leaves(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), and subpavings\-::\-S\-Pnode\-::is\-Sub\-Leaf().



\-Referenced by get\-Sub\-Leaves().


\begin{DoxyCode}
{
  if (isSubLeaf()) { // this is a subleaf
    subleaves.push_back(this);
  }
  
  //if children, recurse on the children
  else if (!isLeaf()) {
    getLeftChild()->getSubLeaves(subleaves);
    getRightChild()->getSubLeaves(subleaves);
  }

  return subleaves;
  
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a0660b7981cce44ca09c2e0d68a6c1a21}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Total\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box}}
\index{get\-Total\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Total\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::real {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Total\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Real\-Mapped\-S\-Pnode} \&}]{rmsp}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a0660b7981cce44ca09c2e0d68a6c1a21}


\-Get the total over the leaves of the absolute value of the difference between the leaf \char`\"{}area\char`\"{} for this and for {\itshape rmsp\/}. 

\-For each leaf descendent of the subpaving union of this and {\itshape rmsp\/} the \char`\"{}area\char`\"{} returned is calculated as the volume of the box represented multiplied by the absolute value of the difference between the range on that leaf for this and for {\itshape rmsp\/} real.

\-This method should return the same as if the method \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} was called on a node which is the difference between this and {\itshape rmsp\/} (ie $\ast$this -\/ rmsp).

\-If there are an infinite ranges in the tree rooted at this, or {\itshape rmps\/}, the method will return cxsc\-::\-Infinity.


\begin{DoxyParams}{\-Parameters}
{\em rmsp} & the \-Real\-Mapped\-S\-Pnode to calculate the difference against. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
total over the leaves of the union of this and {\itshape rmsp\/} of the absolute value of the difference between the leaf \char`\"{}area\char`\"{} for this and for {\itshape rmsp\/} (returns cxsc\-::\-Infinity if \hyperlink{classsubpavings_1_1RealMappedSPnode_a738f4ef504214f9dd3a533f052f6d4cb}{has\-Infinite\-Range\-In\-Tree()} or if rmsp.\-has\-Infinite\-Range\-In\-Tree()). 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
this and {\itshape rmsp\/} have the same box. 

all leaf descendents of this and {\itshape rmsp\/} must have boxes. 
\end{DoxyPrecond}


\-Definition at line 606 of file realmappedspnode.\-cpp.



\-References get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box(), and has\-Infinite\-Range\-In\-Tree().


\begin{DoxyCode}
{
  cxsc::real total = cxsc::Infinity;
  
  if (!hasInfiniteRangeInTree() && !rmsp.hasInfiniteRangeInTree()) {
    RealMappedSPnode diff = *this - rmsp;
    total = diff.getTotalAbsLeafAreaRangeWithBox();
    
  }
  return total;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box}}
\index{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::real {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}


\-Get the total absolute \char`\"{}area\char`\"{} for the leaves of this of the real ranges and boxes. 

\-For each leaf descendent of this the \char`\"{}area\char`\"{} returned is calculated as the volume of the box represented multiplied by the absolute value of the real range of the node (which can also be seen as the volume of the box represented with another dimension equal to an interval that has \-Inf 0 and \-Sup equal to the range of the node).

\-If there are an infinite ranges in the tree rooted at this, the method will return cxsc\-::\-Infinity.

\begin{DoxyReturn}{\-Returns}
total over all leaf descendents of this of abs(volume of box represented multiplied by real range) (returns cxsc\-::\-Infinity if \hyperlink{classsubpavings_1_1RealMappedSPnode_a738f4ef504214f9dd3a533f052f6d4cb}{has\-Infinite\-Range\-In\-Tree()}). 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
all leaf descendents of this must have boxes. 
\end{DoxyPrecond}


\-Definition at line 583 of file realmappedspnode.\-cpp.



\-References get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box(), and has\-Infinite\-Range\-In\-Tree().



\-Referenced by \-\_\-normalise(), and get\-Total\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box().


\begin{DoxyCode}
{
  cxsc::real total = cxsc::Infinity;
  
  if (!hasInfiniteRangeInTree()) {
    total = rnd(getTotalDotPrecisionAbsLeafAreaRangeWithBox());
  }
  
  return total;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a74ba255a0781497c5dc76e8458969278}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Total\-Dot\-Precision\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Dot\-Precision\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box}}
\index{get\-Total\-Dot\-Precision\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Dot\-Precision\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Total\-Dot\-Precision\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::dotprecision {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Total\-Dot\-Precision\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Real\-Mapped\-S\-Pnode} \&}]{rmsp}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a74ba255a0781497c5dc76e8458969278}


\-Get the total over the leaves of the absolute value of the difference between the leaf \char`\"{}area\char`\"{} for this and for {\itshape rmsp\/} as a dotprecision type. 

\-For each leaf descendent of the subpaving union of this and {\itshape rmsp\/} the \char`\"{}area\char`\"{} returned is calculated as the volume of the box represented multiplied by the absolute value of the difference between the range on that leaf for this and for {\itshape rmsp\/} real. {\bfseries \-But} note that if the range of a leaf node of this or {\itshape rmsp\/} is cxsc\-::\-Infinity, the dotprecision result for that leaf is the same as dotprecision(0.\-0). \-This is due to the working of the cxsc library. \-The results can therefore be highly misleading if any leaf node in this or {\itshape rmsp\/} has range cxsc\-::\-Infinity.

\-This method should return the same as if the method \hyperlink{classsubpavings_1_1RealMappedSPnode_a2901c49d51615810f146a38ccb503fda}{get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box()} was called on a node which is the difference between this and {\itshape rmsp\/} (ie $\ast$this -\/ rmsp).


\begin{DoxyParams}{\-Parameters}
{\em rmsp} & the \-Real\-Mapped\-S\-Pnode to calculate the difference against. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
dotprecision sum over the leaves of the union of this and {\itshape rmsp\/} of the absolute value of the difference between the leaf \char`\"{}area\char`\"{} for this and for {\itshape rmsp\/}. 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
this and {\itshape rmsp\/} have the same box. 

!has\-Infinite\-Range\-In\-Tree() and !rmsp.\hyperlink{classsubpavings_1_1RealMappedSPnode_a738f4ef504214f9dd3a533f052f6d4cb}{has\-Infinite\-Range\-In\-Tree()}. 

all leaf descendents of this and {\itshape rmsp\/} must have boxes. 
\end{DoxyPrecond}


\-Definition at line 621 of file realmappedspnode.\-cpp.



\-References get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box().


\begin{DoxyCode}
{
  RealMappedSPnode diff = *this - rmsp;
  return diff.getTotalDotPrecisionAbsLeafAreaRangeWithBox();
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a2901c49d51615810f146a38ccb503fda}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box}}
\index{get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::dotprecision {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Total\-Dot\-Precision\-Abs\-Leaf\-Area\-Range\-With\-Box} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a2901c49d51615810f146a38ccb503fda}


\-Get the total absolute \char`\"{}area\char`\"{} of the range and the box of this as a dotprecision type. 

\-The \char`\"{}area\char`\"{} returned should be the sum over all the leaves of this of the absolute value of the dotprecision product of the volume of the box represented by the leaf node and the real range of the leaf note. {\bfseries \-But} note that if the range of a leaf node is cxsc\-::\-Infinity, the dotprecision result for that leaf is the same as dotprecision(0.\-0). \-This is due to the working of the cxsc library. \-The results can therefore be highly misleading if any leaf node has range cxsc\-::\-Infinity.

\begin{DoxyReturn}{\-Returns}
dotprecision sum over leaf nodes of absolute value of the dotprecision product of volume of box represented by the leaf and the range of the leaf. 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
!has\-Infinite\-Range\-In\-Tree(). 

all leaf descendents of this must have boxes. 
\end{DoxyPrecond}


\-Definition at line 595 of file realmappedspnode.\-cpp.



\-References get\-Dot\-Precision\-Area\-Range\-With\-Box(), get\-Left\-Child(), get\-Right\-Child(), and subpavings\-::\-S\-Pnode\-::is\-Leaf().



\-Referenced by get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box(), and get\-Total\-Dot\-Precision\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box().


\begin{DoxyCode}
{
  if (isLeaf()) return cxsc::abs(getDotPrecisionAreaRangeWithBox());
  else {
    return ( getLeftChild()->getTotalDotPrecisionAbsLeafAreaRangeWithBox()
      + getRightChild()->getTotalDotPrecisionAbsLeafAreaRangeWithBox() );
  }
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a4f769639fd1e13ea5449bb12dc53c998}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box}}
\index{get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::dotprecision {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a4f769639fd1e13ea5449bb12dc53c998}


\-Get the total \char`\"{}area\char`\"{} of the range and the box of this as a dotprecision type. 

\-The \char`\"{}area\char`\"{} returned should be the sum over all the leaves of this of the dotprecision product of the volume of the box represented by the leaf node and the real range of the leaf note. {\bfseries \-But} note that if the range of a leaf node is cxsc\-::\-Infinity, the dotprecision result for that leaf is the same as dotprecision(0.\-0). \-This is due to the working of the cxsc library. \-The results can therefore be highly misleading if any leaf node has range cxsc\-::\-Infinity.

\begin{DoxyReturn}{\-Returns}
dotprecision sum over leaf nodes of dotprecision product of volume of box represented by the leaf and the range of the leaf. 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
!has\-Infinite\-Range\-In\-Tree(). 

all leaf descendents of this must have boxes. 
\end{DoxyPrecond}


\-Definition at line 572 of file realmappedspnode.\-cpp.



\-References get\-Dot\-Precision\-Area\-Range\-With\-Box(), get\-Left\-Child(), get\-Right\-Child(), and subpavings\-::\-S\-Pnode\-::is\-Leaf().



\-Referenced by get\-Total\-Leaf\-Area\-Range\-With\-Box().


\begin{DoxyCode}
{
  if (isLeaf()) return getDotPrecisionAreaRangeWithBox();
  else {
    return ( getLeftChild()->getTotalDotPrecisionLeafAreaRangeWithBox()
      + getRightChild()->getTotalDotPrecisionLeafAreaRangeWithBox() );
  }
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a23ef95e66b4b920f205739d9cf42f96f}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!get\-Total\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Leaf\-Area\-Range\-With\-Box}}
\index{get\-Total\-Leaf\-Area\-Range\-With\-Box@{get\-Total\-Leaf\-Area\-Range\-With\-Box}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{get\-Total\-Leaf\-Area\-Range\-With\-Box}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::real {\bf \-Real\-Mapped\-S\-Pnode\-::get\-Total\-Leaf\-Area\-Range\-With\-Box} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a23ef95e66b4b920f205739d9cf42f96f}


\-Get the total \char`\"{}area\char`\"{} for the leaves of this of the real ranges and boxes. 

\-For each leaf descendent of this the \char`\"{}area\char`\"{} returned is calculated as the volume of the box represented multiplied by the real range of the node (which can also be seen as the volume of the box represented with another dimension equal to an interval that has \-Inf 0 and \-Sup equal to the range of the node).

\-If there are an infinite ranges in the tree rooted at this, the method will return cxsc\-::\-Infinity.

\begin{DoxyReturn}{\-Returns}
total over all leaf descendents of this of (volume of box represented multiplied by real range) (returns cxsc\-::\-Infinity if \hyperlink{classsubpavings_1_1RealMappedSPnode_a738f4ef504214f9dd3a533f052f6d4cb}{has\-Infinite\-Range\-In\-Tree()}). 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
all leaf descendents of this must have boxes. 
\end{DoxyPrecond}


\-Definition at line 559 of file realmappedspnode.\-cpp.



\-References get\-Total\-Dot\-Precision\-Leaf\-Area\-Range\-With\-Box(), and has\-Infinite\-Range\-In\-Tree().


\begin{DoxyCode}
{
  cxsc::real total = cxsc::Infinity;
  
  if (!hasInfiniteRangeInTree()) {
    total = rnd(getTotalDotPrecisionLeafAreaRangeWithBox());
  }
  
  return total;

}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a738f4ef504214f9dd3a533f052f6d4cb}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!has\-Infinite\-Range\-In\-Tree@{has\-Infinite\-Range\-In\-Tree}}
\index{has\-Infinite\-Range\-In\-Tree@{has\-Infinite\-Range\-In\-Tree}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{has\-Infinite\-Range\-In\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf \-Real\-Mapped\-S\-Pnode\-::has\-Infinite\-Range\-In\-Tree} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_a738f4ef504214f9dd3a533f052f6d4cb}
\-Get whether there is an infinite range in the tree rooted at this. \-The tree rooted at this includes this node, subterminal nodes and leaf nodes).

\begin{DoxyReturn}{\-Returns}
true if the tree rooted at this has a node with an infinite range (ie range cxsc\-::\-Infinity) . 
\end{DoxyReturn}


\-Definition at line 242 of file realmappedspnode.\-cpp.



\-References get\-Left\-Child(), get\-Right\-Child(), has\-Infinite\-Range\-In\-Tree(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), and subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range.



\-Referenced by get\-Total\-Abs\-Diff\-Leaf\-Area\-Range\-With\-Box(), get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box(), get\-Total\-Leaf\-Area\-Range\-With\-Box(), and has\-Infinite\-Range\-In\-Tree().


\begin{DoxyCode}
{
  bool retValue = false;
  if (range == cxsc::Infinity) {
    retValue = true;
  }
  else if (!isLeaf()) {
    retValue = getLeftChild()->hasInfiniteRangeInTree();
    if (!retValue) retValue = getRightChild()->hasInfiniteRangeInTree();
  }
  return retValue;
  
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_ac4cadaec6d96f2a315218dc16a082f8a}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!has\-Negative\-Range\-In\-Tree@{has\-Negative\-Range\-In\-Tree}}
\index{has\-Negative\-Range\-In\-Tree@{has\-Negative\-Range\-In\-Tree}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{has\-Negative\-Range\-In\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf \-Real\-Mapped\-S\-Pnode\-::has\-Negative\-Range\-In\-Tree} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_ac4cadaec6d96f2a315218dc16a082f8a}
\-Get whether there is a negative range in the tree rooted at this. \-The tree rooted at this includes this node, subterminal nodes and leaf nodes).

\begin{DoxyReturn}{\-Returns}
true if the tree rooted at this has a node with a negative range. 
\end{DoxyReturn}


\-Definition at line 227 of file realmappedspnode.\-cpp.



\-References get\-Left\-Child(), get\-Right\-Child(), has\-Negative\-Range\-In\-Tree(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), and subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range.



\-Referenced by has\-Negative\-Range\-In\-Tree().


\begin{DoxyCode}
{
  bool retValue = false;
  if (range < real(0.0)) {
    retValue = true;
  }
  else if (!isLeaf()) {
    retValue = getLeftChild()->hasNegativeRangeInTree();
    if (!retValue) retValue = getRightChild()->hasNegativeRangeInTree();
  }
  return retValue;
  
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_ab3ac1ccd24132d04f136a0fab3d0b610}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!make\-Marginalised@{make\-Marginalised}}
\index{make\-Marginalised@{make\-Marginalised}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{make\-Marginalised}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf \-Real\-Mapped\-S\-Pnode} {\bf \-Real\-Mapped\-S\-Pnode\-::make\-Marginalised} (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ int $>$ \&}]{req\-Dims}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_ab3ac1ccd24132d04f136a0fab3d0b610}


\-Make a marginalised version of this. 

\-Makes a new \-Real\-Mapped\-S\-Pnode tree that s the marginal of this, marginalising to take out the unwanted dimensions and adjust the range so that node vol x range is the same as before, and does this recursively for all children so that after the marginalisation the sum over all leaves of (node vol x range) of the new tree is the same as for this.

\begin{DoxyNote}{\-Note}
allowed dimensions start at 1, ie dimensions to marginalise on can include 1, 2, ... d where d = dimensions of this.
\end{DoxyNote}
\-Throws the following exceptions\-: 
\begin{DoxyItemize}
\item \-Throws a \hyperlink{classsubpavings_1_1NoBox__Error}{\-No\-Box\-\_\-\-Error} if this is empty (has no box). 
\item \-Throws an std\-::invalid\-\_\-argument if the required dimensions {\itshape req\-Dim\/} is empty or contains dimensions outside the range of the dimensions of this. 
\end{DoxyItemize}


\begin{DoxyParams}{\-Parameters}
{\em req\-Dims} & is a vector of the dimensions to include in marginal. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-A \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} with a subpaving that is the result of the marginalisation of the subpaving of this to include only the required dimensions and a range adjusted to preserve the range x node volume given the change in the volume of the subpaving box that the node represents compared to that in this. 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
{\itshape req\-Dims\/} must be compatible with current dimensions and this must have a box. 
\end{DoxyPrecond}


\-Definition at line 418 of file realmappedspnode.\-cpp.



\-References \-\_\-start\-\_\-marginalise().


\begin{DoxyCode}
{
  RealMappedSPnode result = *this;

  result._start_marginalise(reqDims);
  
  return result;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a66a8b6deef3ba770a80a5b0b0418f5fc}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!make\-Normalised@{make\-Normalised}}
\index{make\-Normalised@{make\-Normalised}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{make\-Normalised}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf \-Real\-Mapped\-S\-Pnode} {\bf \-Real\-Mapped\-S\-Pnode\-::make\-Normalised} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_a66a8b6deef3ba770a80a5b0b0418f5fc}


\-Make a normalised version of this. 

\-Makes a new \-Real\-Mapped\-S\-Pnode tree that is the normalised version of this, ie has the same subpaving but the total over all leaf nodes of the sum of (box volumes x range) is 1.\-0.

\-Throws the following exceptions\-: 
\begin{DoxyItemize}
\item \-Throws a \hyperlink{classsubpavings_1_1NoBox__Error}{\-No\-Box\-\_\-\-Error} if this is empty (has no box). 
\item \-Throws an std\-::runtime\-\_\-error if this has no 'area', ie \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} $<$= 0. 
\item \-Throws an std\-::runtime\-\_\-error if this has no 'area', ie \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} == \-Infinity. 
\end{DoxyItemize}

\begin{DoxyReturn}{\-Returns}
\-A \hyperlink{classsubpavings_1_1RealMappedSPnode}{\-Real\-Mapped\-S\-Pnode} with a subpaving that is the the same as the subpaving of this this with ranges such that the total over all leaf nodes of the sum of (box volumes x range) is 1.\-0. 
\end{DoxyReturn}
\begin{DoxyPrecond}{\-Precondition}
this must have a box and \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} != 0 and \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} != \-Infinity. 
\end{DoxyPrecond}


\-Definition at line 437 of file realmappedspnode.\-cpp.



\-References \-\_\-normalise().


\begin{DoxyCode}
{
  RealMappedSPnode result = *this;

  result._normalise();
  
  return result;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a2541f9ce5af2fcb753644d1f7e1f9297}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!make\-Slice@{make\-Slice}}
\index{make\-Slice@{make\-Slice}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{make\-Slice}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf \-Real\-Mapped\-S\-Pnode} {\bf \-Real\-Mapped\-S\-Pnode\-::make\-Slice} (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ int $>$ \&}]{slice\-Dims, }
\item[{const std\-::vector$<$ cxsc\-::real $>$ \&}]{slice\-Pts}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_a2541f9ce5af2fcb753644d1f7e1f9297}


\-Make a \-Real\-Mapped\-S\-Pnode that is a slice of this. 


\begin{DoxyParams}{\-Parameters}
{\em slice\-Dims} & is a vector of dimensions to slice on. \\
\hline
{\em slice\-Pts} & is a vector of points to slice on, assumed to correspond to the dimensions in {\itshape slice\-Dims\/}, ie the ith value in {\itshape slice\-Dims\/} gives the dimension for the ith point in {\itshape slice\-Pts\/}. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-A \-Real\-Mapped\-S\-Pnode that is a slice of this on dimensions {\itshape slice\-Dims\/} at points {\itshape slice\-Pts\/}. 
\end{DoxyReturn}


\-Definition at line 465 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-Mapped\-S\-Pnode$<$ T $>$\-::\-\_\-slice(), and subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::slice\-Check().


\begin{DoxyCode}
{
  
  std::vector<cxsc::real> fullSlicePts = sliceCheck(sliceDims, slicePts);
  
  RealMappedSPnode result(*this);
  result._slice(sliceDims, fullSlicePts);
  return result;

}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_acf2399376e990903e5787b0a68eb350c}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!marginalise@{marginalise}}
\index{marginalise@{marginalise}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{marginalise}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Real\-Mapped\-S\-Pnode\-::marginalise} (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ int $>$ \&}]{req\-Dims}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_acf2399376e990903e5787b0a68eb350c}


\-Marginalise this. 

\-Marginalises to take out the unwanted dimensions and adjust the range so that node vol x range is the same as before marginalisation, and does this recursively for all children of this so that after the marginalisation the sum over all leaves of (node vol x range) is the same as before marginalisation.

\begin{DoxyNote}{\-Note}
allowed dimensions start at 1, ie dimensions to marginalise on can include 1, 2, ... d where d = dimensions of this.
\end{DoxyNote}
\-Throws the following exceptions\-: 
\begin{DoxyItemize}
\item \-Throws a \hyperlink{classsubpavings_1_1NonRootNode__Error}{\-Non\-Root\-Node\-\_\-\-Error} if this has a parent (ie. is not a root node). 
\item \-Throws a \hyperlink{classsubpavings_1_1NoBox__Error}{\-No\-Box\-\_\-\-Error} if this is empty (has no box). 
\item \-Throws an std\-::invalid\-\_\-argument if the required dimensions {\itshape req\-Dim\/} is empty or contains dimensions outside the range of the dimensions of this. 
\end{DoxyItemize}


\begin{DoxyParams}{\-Parameters}
{\em req\-Dims} & is a vector of the dimensions to include in marginal. \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{\-Precondition}
{\itshape req\-Dims\/} must be compatible with current dimensions and this must be a root node (have no parent) with a box. 
\end{DoxyPrecond}
\begin{DoxyPostcond}{\-Postcondition}
\-This will have a tree structure that is the result of the marginalisation of the original subpaving to include only the required dimensions and will have a range adjusted to preserve the total range x volume given the change in the volume of the subpaving box that the node represents. 
\end{DoxyPostcond}


\-Definition at line 407 of file realmappedspnode.\-cpp.



\-References \-\_\-start\-\_\-marginalise(), and get\-Parent().


\begin{DoxyCode}
{
  if ( getParent() != NULL ) {
    throw NonRootNode_Error(
      "RealMappedSPnode::marginalise(const std::vector<int>&)");
  }
  
  _start_marginalise(reqDims);
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a4d0129dda149a950a06e9d2e3ff802c4}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!node\-Expand@{node\-Expand}}
\index{node\-Expand@{node\-Expand}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{node\-Expand}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Real\-Mapped\-S\-Pnode\-::node\-Expand} (
\begin{DoxyParamCaption}
\item[{int}]{comp}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a4d0129dda149a950a06e9d2e3ff802c4}


\-Add two sibling child nodes to this provided this is a leaf. 

\-Each new child gets half of the box associated with this, splitting the box in half normal to dimension set by comp. 

\-Reimplemented from \hyperlink{classsubpavings_1_1MappedSPnode_a817b05cc2d60ff0ee1a98b0addf54131}{subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$}.



\-Definition at line 316 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::get\-Box(), get\-Left\-Child(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), subpavings\-::\-S\-Pnode\-::left\-Child, \-Lower(), subpavings\-::\-S\-Pnode\-::node\-Add\-Left(), subpavings\-::\-S\-Pnode\-::node\-Add\-Right(), subpavings\-::\-S\-Pnode\-::node\-Name, subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range, \-Real\-Mapped\-S\-Pnode(), subpavings\-::\-S\-Pnode\-::right\-Child, subpavings\-::\-S\-Pnode\-::set\-Node\-Name(), subpavings\-::\-S\-Pnode\-::the\-Box, and \-Upper().


\begin{DoxyCode}
{
  // can only expand if there is a box
  if (NULL == theBox) {
    throw NoBox_Error("RealMappedSPnode::nodeExpand(int)");
  }

  // only do something if this node is a leaf
  if (isLeaf()) {
    
    RealMappedSPnode* newLC = NULL;
    RealMappedSPnode* newRC = NULL;
    
    try {

      // ivectors to become boxes for new children
      ivector lC, rC;
      // Call Lower() and Upper() to put split boxes
      // into lC and rC respectively
      Lower(getBox(), lC, comp);
      Upper(getBox(), rC, comp);

      // make and add the new children
      newLC = new RealMappedSPnode(lC, range);
      newRC = new RealMappedSPnode(rC, range);
      
      nodeAddLeft(newLC);
      nodeAddRight(newRC);
      // both children get the same range as this
      
      //name the new children
      getLeftChild()->setNodeName(nodeName + "L");
      getRightChild()->setNodeName(nodeName + "R");

      // new children have summary from this
    }
    catch(std::exception& e) {
    // overkill, but try to deal with all eventualities...
      try {
        if (getLeftChild() != NULL) {
          delete (getLeftChild());
          leftChild = NULL;
        }
        
        if (getRightChild() != NULL) {
          delete (getRightChild());
          rightChild = NULL;
        }
        if (newLC != NULL) {
          delete newLC;
          newLC = NULL;
        }
        if (newRC != NULL) {
          delete newRC;
          newRC = NULL;
        }
      }
      catch(std::exception& e) {} //catch and swallow
      
      throw; // rethrow original exception
    }
  }
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_ad60865bacd8a43978cf2da02419cbf8f}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!node\-Expand@{node\-Expand}}
\index{node\-Expand@{node\-Expand}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{node\-Expand}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Real\-Mapped\-S\-Pnode\-::node\-Expand} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_ad60865bacd8a43978cf2da02419cbf8f}


\-Add two sibling child nodes to this provided this is a leaf. 

\-Each new child gets half of the box associated with this, splitting the box in half normal to the first longest dimension of the box associated with this. 

\-Reimplemented from \hyperlink{classsubpavings_1_1MappedSPnode_a26af7ee7d7e9c00623dea9e6aed02d92}{subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$}.



\-Definition at line 384 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::get\-Box(), and \-Max\-Diam().


\begin{DoxyCode}
{
  int maxdiamcomp; // variable to hold first longest dimension
  double temp = ::MaxDiam(getBox(), maxdiamcomp);
  nodeExpand(maxdiamcomp); // complete nodeExpand
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a3171d7822ccbcb05ed2b997c678b325a}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!node\-L1\-Distance@{node\-L1\-Distance}}
\index{node\-L1\-Distance@{node\-L1\-Distance}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{node\-L1\-Distance}]{\setlength{\rightskip}{0pt plus 5cm}cxsc\-::dotprecision \& {\bf \-Real\-Mapped\-S\-Pnode\-::node\-L1\-Distance} (
\begin{DoxyParamCaption}
\item[{cxsc\-::dotprecision \&}]{dis\-L1, }
\item[{cxsc\-::real}]{other\-\_\-v}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a3171d7822ccbcb05ed2b997c678b325a}


\-Accumulate \-L1 distance between this and another identical node with value {\itshape other\-\_\-v\/} mapped onto it, ie add nodevolume$\ast$(range -\/ other\-\_\-v) onto {\itshape dis\-L1\/}. 



\-Definition at line 1020 of file realmappedspnode.\-cpp.



\-References get\-Left\-Child(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::get\-Range(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::is\-Leaf(), node\-L1\-Distance(), subpavings\-::\-S\-Pnode\-::node\-Real\-Volume(), and subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range.



\-Referenced by \-\_\-get\-L1distance(), and node\-L1\-Distance().


\begin{DoxyCode}
{
  #ifdef DEBUG_L1
    std::cout << "\nIn nodeL1distance, I am " << getNodeName() 
    << ", and disL1 is " << (rnd(disL1)) << endl;
    std::cout << "\nother_v is " << other_v << std::endl;
  #endif
    
  // this is not a leaf
  if (!isLeaf() ) {
    
    #ifdef DEBUG_L1
      std::cout << "I am not a leaf" << std::endl;
    #endif
    
    disL1 = getLeftChild()->nodeL1Distance(disL1,  other_v );
    disL1 = getRightChild()->nodeL1Distance(disL1, other_v );
  }
  else { // this is a leaf
  
    // for me, calculate difference to other_v
    accumulate(disL1, 
        cxsc::abs(cxsc::abs(range) - cxsc::abs(other_v)),
        nodeRealVolume() );
      
    #ifdef DEBUG_L1
      std::cout << "I am a leaf, my range value is " << getRange() << endl;
      std::cout << ", and other value is " << other_v << std::endl;
      std::cout << "my volume is " << nodeRealVolume() << endl;
      std::cout << "adding the following to disL1: ";
      std::cout << (cxsc::abs(cxsc::abs(range) - cxsc::abs(other_v))*
      nodeRealVolume()) << std::endl;
    #endif
    
  }
  
  #ifdef DEBUG_L1
    std::cout << "disL1 is now: " << (rnd(disL1)) << std::endl;
  #endif
  
  return disL1;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a8b02632446a3c28a352f15f511e35caa}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!normalise@{normalise}}
\index{normalise@{normalise}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{normalise}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Real\-Mapped\-S\-Pnode\-::normalise} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a8b02632446a3c28a352f15f511e35caa}


\-Normalise this. 

\-Normalising means changing the range of each node so that the total over all leaf nodes of the sum of (box volumes xabs(range)) is 1.\-0.

\-Throws the following exceptions\-: 
\begin{DoxyItemize}
\item \-Throws a \hyperlink{classsubpavings_1_1NonRootNode__Error}{\-Non\-Root\-Node\-\_\-\-Error} if this has a parent (ie. is not a root node). 
\item \-Throws a \hyperlink{classsubpavings_1_1NoBox__Error}{\-No\-Box\-\_\-\-Error} if this is empty (has no box). 
\item \-Throws an std\-::runtime\-\_\-error if this has no 'area', ie \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} $<$= 0. 
\item \-Throws an std\-::runtime\-\_\-error if this has no 'area', ie \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} == \-Infinity. 
\end{DoxyItemize}

\begin{DoxyPrecond}{\-Precondition}
this must be a root node (have no parent) with a box and \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} != 0 and \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} != \-Infinity. 
\end{DoxyPrecond}
\begin{DoxyPostcond}{\-Postcondition}
this will have the same tree structure as before and the ranges on the nodes will be adjusted so that \hyperlink{classsubpavings_1_1RealMappedSPnode_a972c5dbc0bedd9cad3af4f2af43be277}{get\-Total\-Abs\-Leaf\-Area\-Range\-With\-Box()} = 1.\-0. 
\end{DoxyPostcond}


\-Definition at line 428 of file realmappedspnode.\-cpp.



\-References \-\_\-normalise(), and get\-Parent().


\begin{DoxyCode}
{
  if ( getParent() != NULL ) {
    throw NonRootNode_Error(
      "RealMappedSPnode::normalise()");
  }
  _normalise();
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a5287c7cec21af1c8606d735c0478a6fc}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!one\-Line\-Output@{one\-Line\-Output}}
\index{one\-Line\-Output@{one\-Line\-Output}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{one\-Line\-Output}]{\setlength{\rightskip}{0pt plus 5cm}std\-::ostream \& {\bf \-Real\-Mapped\-S\-Pnode\-::one\-Line\-Output} (
\begin{DoxyParamCaption}
\item[{std\-::ostream \&}]{os, }
\item[{int}]{level = {\ttfamily 0}}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private, virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_a5287c7cec21af1c8606d735c0478a6fc}


\-A quick one-\/line summary of a node. 


\begin{DoxyParams}{\-Parameters}
{\em level} & \-Controls number of tabs indenting output. \\
\hline
\end{DoxyParams}


\-Reimplemented from \hyperlink{classsubpavings_1_1MappedSPnode_acfbd13653a91c69a7091c6e9c18a6d68}{subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$}.



\-Definition at line 1160 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-S\-Pnode\-::get\-Box(), get\-Left\-Child(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), get\-Right\-Child(), subpavings\-::\-S\-Pnode\-::has\-L\-Cwith\-Box(), subpavings\-::\-S\-Pnode\-::has\-R\-Cwith\-Box(), one\-Line\-Output(), and subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::range.



\-Referenced by \-\_\-marginalise(), and one\-Line\-Output().


\begin{DoxyCode}
{
  // do me
  for (int i = 0; i < level; ++i) { os << "\t"; }
  os << getNodeName() << "\tRange: " << range;
  os << "\tbox: " << getBox() << std::endl;
  
  // do children
  if (hasLCwithBox()) getLeftChild()->oneLineOutput(os, level+1);
  if (hasRCwithBox()) getRightChild()->oneLineOutput(os, level+1);
  
  return os;
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a1ac4214b1e335289374edece1b5d8c43}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!operator$<$@{operator$<$}}
\index{operator$<$@{operator$<$}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{operator$<$}]{\setlength{\rightskip}{0pt plus 5cm}bool \-Real\-Mapped\-S\-Pnode\-::operator$<$ (
\begin{DoxyParamCaption}
\item[{const {\bf \-Real\-Mapped\-S\-Pnode} \&}]{rhs}
\end{DoxyParamCaption}
) const}}\label{classsubpavings_1_1RealMappedSPnode_a1ac4214b1e335289374edece1b5d8c43}


\-Less-\/than operator. 

\begin{DoxyReturn}{\-Returns}
true iff the range of this is $<$ range of {\itshape rhs\/}. 
\end{DoxyReturn}


\-Definition at line 256 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::get\-Range(), and subpavings\-::\-Mapped\-S\-Pnode$<$ T $>$\-::get\-Range().


\begin{DoxyCode}
{
  return (getRange() < rhs.getRange());
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_a8c4a201d04c81a5f21301d6a325e740d}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!operator=@{operator=}}
\index{operator=@{operator=}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{operator=}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode} \& \-Real\-Mapped\-S\-Pnode\-::operator= (
\begin{DoxyParamCaption}
\item[{{\bf \-Real\-Mapped\-S\-Pnode}}]{rhs}
\end{DoxyParamCaption}
)}}\label{classsubpavings_1_1RealMappedSPnode_a8c4a201d04c81a5f21301d6a325e740d}


\-Copy assignment operator. 

\-Copies from given \-Real\-Mapped\-S\-Pnode downwards. 

\-Definition at line 187 of file realmappedspnode.\-cpp.



\-References swap\-R\-M\-S\-P\-S\-R().


\begin{DoxyCode}
{
  rhs.swapRMSPSR(*this); // make sure we use our version of swap
  return(*this);
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_ad6a86d365ae237d96c7a8f842700af96}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!operator=@{operator=}}
\index{operator=@{operator=}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{operator=}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Mapped\-S\-Pnode} \& \-Real\-Mapped\-S\-Pnode\-::operator= (
\begin{DoxyParamCaption}
\item[{{\bf \-Mapped\-S\-Pnode}$<$ cxsc\-::real $>$}]{rhs}
\end{DoxyParamCaption}
)}}\label{classsubpavings_1_1RealMappedSPnode_ad6a86d365ae237d96c7a8f842700af96}


\-Copy assignment operator. 

\-Copies from a given \-Mapped\-S\-Pnode$<$cxsc\-::real$>$ node downwards. 

\-Reimplemented from \hyperlink{classsubpavings_1_1MappedSPnode_a9f159be71fab10b26dec5d080fec95ff}{subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$}.



\-Definition at line 196 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-Mapped\-S\-Pnode$<$ T $>$\-::swap\-M\-S\-P\-S\-R().


\begin{DoxyCode}
{
  rhs.swapMSPSR(*this); // make sure we use our version of swap
  return(*this);
}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_ac674f3231fb03622048986a2a855b224}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!slice@{slice}}
\index{slice@{slice}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{slice}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Real\-Mapped\-S\-Pnode\-::slice} (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ int $>$ \&}]{slice\-Dims, }
\item[{const std\-::vector$<$ cxsc\-::real $>$ \&}]{slice\-Pts}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}\label{classsubpavings_1_1RealMappedSPnode_ac674f3231fb03622048986a2a855b224}


\-Slice this. 


\begin{DoxyParams}{\-Parameters}
{\em slice\-Dims} & is a vector of dimensions to slice on. \\
\hline
{\em slice\-Pts} & is a vector of points to slice on, assumed to correspond to the dimensions in {\itshape slice\-Dims\/}, ie the ith value in {\itshape slice\-Dims\/} gives the dimension for the ith point in {\itshape slice\-Pts\/}. \\
\hline
\end{DoxyParams}


\-Reimplemented from \hyperlink{classsubpavings_1_1MappedSPnode_a83d5b7a4609c73e1818fe2d3231c0979}{subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$}.



\-Definition at line 447 of file realmappedspnode.\-cpp.



\-References subpavings\-::\-Mapped\-S\-Pnode$<$ T $>$\-::\-\_\-slice(), subpavings\-::\-S\-Pnode\-::get\-Node\-Name(), subpavings\-::\-Mapped\-S\-Pnode$<$ cxsc\-::real $>$\-::slice\-Check(), and swap\-R\-M\-S\-P\-S\-R().


\begin{DoxyCode}
{
  
  #ifdef SLICE_OUTPUT
    std::cout << "In RealMappedSPnode::slice, I am " << getNodeName() << 
      std::endl;
  #endif

  std::vector<cxsc::real> fullSlicePts = sliceCheck(sliceDims, slicePts);
  
  RealMappedSPnode temp(*this);
  temp._slice(sliceDims, fullSlicePts);
  swapRMSPSR(temp);

}
\end{DoxyCode}
\hypertarget{classsubpavings_1_1RealMappedSPnode_af2612c2a420a9f91c8bca09f0bb6ab42}{\index{subpavings\-::\-Real\-Mapped\-S\-Pnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}!swap\-R\-M\-S\-P\-S\-R@{swap\-R\-M\-S\-P\-S\-R}}
\index{swap\-R\-M\-S\-P\-S\-R@{swap\-R\-M\-S\-P\-S\-R}!subpavings::RealMappedSPnode@{subpavings\-::\-Real\-Mapped\-S\-Pnode}}
\paragraph[{swap\-R\-M\-S\-P\-S\-R}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Real\-Mapped\-S\-Pnode\-::swap\-R\-M\-S\-P\-S\-R} (
\begin{DoxyParamCaption}
\item[{{\bf \-Real\-Mapped\-S\-Pnode} \&}]{spn}
\end{DoxyParamCaption}
)}}\label{classsubpavings_1_1RealMappedSPnode_af2612c2a420a9f91c8bca09f0bb6ab42}


\-Definition at line 721 of file realmappedspnode.\-cpp.



\-Referenced by \-\_\-marginalise(), operator=(), and slice().


\begin{DoxyCode}
{
  /* theBox, parent, leftChild,
  rightChild and nodeName are inherited from base class */
  MappedSPnode < cxsc::real >::swapMSPSR(spn); // use the MSP version
}
\end{DoxyCode}


\-The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
\hyperlink{realmappedspnode_8hpp}{realmappedspnode.\-hpp}\item 
\hyperlink{realmappedspnode_8cpp}{realmappedspnode.\-cpp}\end{DoxyCompactItemize}
