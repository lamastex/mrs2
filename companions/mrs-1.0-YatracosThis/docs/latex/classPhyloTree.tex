\hypertarget{classPhyloTree}{\subsection{\-Phylo\-Tree \-Class \-Reference}
\label{classPhyloTree}\index{\-Phylo\-Tree@{\-Phylo\-Tree}}
}


{\ttfamily \#include $<$\-Phylo\-Tree.\-hpp$>$}



\-Collaboration diagram for \-Phylo\-Tree\-:
\subsubsection*{\-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classPhyloTree_ab6e00efe0c10f4a93d34e7d027489ac6}{\-Phylo\-Tree} ()
\begin{DoxyCompactList}\small\item\em \-Default constructor. \end{DoxyCompactList}\item 
\hyperlink{classPhyloTree_a0b54fc5ece14eeec6f28945306d070fd}{\-Phylo\-Tree} (int cs, string \&line, const vector$<$ string $>$ \&seqnames)
\begin{DoxyCompactList}\small\item\em \-Constructor using a string description, eg ((1 2) 3 4) and a set of sequence names. \end{DoxyCompactList}\item 
\hyperlink{classPhyloTree_a70200f6baa49702caa47c79d59d92a39}{\-Phylo\-Tree} (int cs, string \&line)
\begin{DoxyCompactList}\small\item\em \-Constructor using a string description, eg ((1 2) 3 4) but no sequence names. \end{DoxyCompactList}\item 
\hyperlink{classPhyloTree_a4a4c3d1b60f3bba1fe813a0ada4de498}{$\sim$\-Phylo\-Tree} ()
\begin{DoxyCompactList}\small\item\em \-Destructor. \end{DoxyCompactList}\item 
void \hyperlink{classPhyloTree_ac593ca7be08c1b02b1b9e4d5229363bd}{\-Print\-Tree} () const 
\begin{DoxyCompactList}\small\item\em print a tree starting with the root \end{DoxyCompactList}\item 
\hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$ \hyperlink{classPhyloTree_a5ede1337d40e3e211e83d9f009b062f9}{get\-Root} () const 
\begin{DoxyCompactList}\small\item\em \-Get the root of the tree. \end{DoxyCompactList}\item 
size\-\_\-t \hyperlink{classPhyloTree_a0d1f91c11b0b4dd5091f44d0f4dda0c7}{get\-Number\-Nodes} () const 
\begin{DoxyCompactList}\small\item\em \-Get the number of nodes in the tree, including the root. \end{DoxyCompactList}\item 
size\-\_\-t \hyperlink{classPhyloTree_ae7557f8269350a3ee6ba18f9bd63b7e6}{get\-Number\-Branches} () const 
\begin{DoxyCompactList}\small\item\em \-Get the number of branches in a tree. \end{DoxyCompactList}\item 
\hyperlink{PhyloTree_8hpp_a9a6f7e127d1279875ce95b0b6a331114}{\-Real\-Probs} \& \hyperlink{classPhyloTree_ac490ccd50ba543a3f58f70e79d5c7c24}{fill\-Prob\-Real\-J\-C69} (const rvector \&x, const vector$<$ int $>$ \&pattern, \hyperlink{PhyloTree_8hpp_a9a6f7e127d1279875ce95b0b6a331114}{\-Real\-Probs} \&r\-Nuc\-Prob) const 
\begin{DoxyCompactList}\small\item\em \-Return the probability of a given pattern for this tree. \end{DoxyCompactList}\item 
\hyperlink{PhyloTree_8hpp_af4bedfc3c110381d3675cf92e28539db}{\-Interval\-Probs} \& \hyperlink{classPhyloTree_ae1efe7ad349b169e80116a959553e37a}{fill\-Prob\-Interval\-J\-C69} (const ivector \&x, const vector$<$ int $>$ \&pattern, \hyperlink{PhyloTree_8hpp_af4bedfc3c110381d3675cf92e28539db}{\-Interval\-Probs} \&i\-Nuc\-Prob) const 
\begin{DoxyCompactList}\small\item\em \-Return the probability of a given pattern for this tree. \end{DoxyCompactList}\item 
\hyperlink{PhyloTree_8hpp_a8ee2b3678316ad48baa269e4ee7db7f7}{\-Hess\-Probs} \& \hyperlink{classPhyloTree_a0b7e1230aa0c30b38a2778b0281a5183}{fill\-Prob\-Hess\-J\-C69} (const \-H\-Tvector \&x, const vector$<$ int $>$ \&pattern, \hyperlink{PhyloTree_8hpp_a8ee2b3678316ad48baa269e4ee7db7f7}{\-Hess\-Probs} \&h\-Nuc\-Prob) const 
\begin{DoxyCompactList}\small\item\em \-Return the probability of a given pattern for this tree. \end{DoxyCompactList}\item 
\hyperlink{PhyloTree_8hpp_a9a6f7e127d1279875ce95b0b6a331114}{\-Real\-Probs} \& \hyperlink{classPhyloTree_a29c5f4195d70604d82ac900a97e05d1a}{fill\-Prob\-Real\-C\-F\-N} (const rvector \&x, const vector$<$ int $>$ \&pattern, \hyperlink{PhyloTree_8hpp_a9a6f7e127d1279875ce95b0b6a331114}{\-Real\-Probs} \&r\-Nuc\-Prob) const 
\begin{DoxyCompactList}\small\item\em \-Return the probability of a given pattern for this tree. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Private \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$ \hyperlink{classPhyloTree_a7b301daf15291d5520dc122d3be3578e}{\-Decode\-Tree} (const string \&line, const vector$<$ string $>$ \&seqnames) const 
\begin{DoxyCompactList}\small\item\em \-Decodes and makes a tree from a line from the tree file. \end{DoxyCompactList}\item 
void \hyperlink{classPhyloTree_aed4d7f60f27bef63636280e6a76ed962}{\-Tree\-File\-Error\-Exit} (const string \&msg, const \hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$node) const 
\begin{DoxyCompactList}\small\item\em \-A function to deal with an error found in a tree input file. \end{DoxyCompactList}\item 
real \hyperlink{classPhyloTree_a91962e00d6d81f2186e2290ce61bf7f1}{find\-Time} (const string \&line, const size\-\_\-t line\-Length, size\-\_\-t \&pos, const \hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$\hyperlink{classPhyloTree_a38c3253751a7ed9ffacb0978106f8173}{root}) const 
\begin{DoxyCompactList}\small\item\em \-Extract a time given in a tree file if the identifier for a time has been found. \end{DoxyCompactList}\item 
int \hyperlink{classPhyloTree_ae6923fc35a5687504975d460a9769a55}{find\-Label} (const string \&line, const size\-\_\-t line\-Length, size\-\_\-t \&pos, const \hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$\hyperlink{classPhyloTree_a38c3253751a7ed9ffacb0978106f8173}{root}) const 
\begin{DoxyCompactList}\small\item\em \-Extract a label given in a tree file if the identifier for a label has been found. \end{DoxyCompactList}\item 
int \hyperlink{classPhyloTree_abd9309bd022690e7532c1d4903d7898f}{find\-Seq\-No} (const string \&line, const size\-\_\-t line\-Length, size\-\_\-t \&pos, const \hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$\hyperlink{classPhyloTree_a38c3253751a7ed9ffacb0978106f8173}{root}, const vector$<$ string $>$ \&seqnames) const 
\begin{DoxyCompactList}\small\item\em \-Extract a sequence number from a tree file. \end{DoxyCompactList}\item 
\hyperlink{classPhyloTree_a34906f6c4db42266e9f0ccb3057d2cb9}{\-Phylo\-Tree} (const \hyperlink{classPhyloTree}{\-Phylo\-Tree} \&other)
\begin{DoxyCompactList}\small\item\em \-Copy constructor is private and not implemented. \end{DoxyCompactList}\item 
\hyperlink{classPhyloTree}{\-Phylo\-Tree} \& \hyperlink{classPhyloTree_af53d4860d55732c183934881fda283c3}{operator=} (const \hyperlink{classPhyloTree}{\-Phylo\-Tree} \&rhs)
\begin{DoxyCompactList}\small\item\em \-Copy assignment operator is private and not implemented. \end{DoxyCompactList}\item 
\hyperlink{PhyloTree_8hpp_a9a6f7e127d1279875ce95b0b6a331114}{\-Real\-Probs} \& \hyperlink{classPhyloTree_ae7b8d3e72818ebe9eea94906acf541f1}{node\-P\-O\-Treal} (\hyperlink{PhyloTree_8hpp_a4457ee43eaa9b550b64e1542c62f7a6f}{\-Real\-Tran\-Prob\-\_\-\-Fct\-Ptr} tpf, const \hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$const node, const rvector \&x, const vector$<$ int $>$ \&pattern, \hyperlink{PhyloTree_8hpp_a9a6f7e127d1279875ce95b0b6a331114}{\-Real\-Probs} \&r\-Nuc\-Prob) const 
\begin{DoxyCompactList}\small\item\em \-Calculates the probabilities as reals of each character for a node given its children's state. \end{DoxyCompactList}\item 
\hyperlink{PhyloTree_8hpp_af4bedfc3c110381d3675cf92e28539db}{\-Interval\-Probs} \& \hyperlink{classPhyloTree_a1cb66ffcb92baaeafadd12babc01feba}{node\-P\-O\-Tinterval} (\hyperlink{PhyloTree_8hpp_a6961512ff8fd6fa5a520b93c63c4ad60}{\-Interval\-Tran\-Prob\-\_\-\-Fct\-Ptr} tpf, const \hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$const node, const ivector \&x, const vector$<$ int $>$ \&pattern, \hyperlink{PhyloTree_8hpp_af4bedfc3c110381d3675cf92e28539db}{\-Interval\-Probs} \&i\-Nuc\-Prob) const 
\begin{DoxyCompactList}\small\item\em \-Calculates the probabilities as an interval of each character for a node given its children's state. \end{DoxyCompactList}\item 
\hyperlink{PhyloTree_8hpp_a8ee2b3678316ad48baa269e4ee7db7f7}{\-Hess\-Probs} \& \hyperlink{classPhyloTree_aec23a8f03330ad66e6ff1af4c886798e}{node\-P\-O\-T\-Hess} (\hyperlink{PhyloTree_8hpp_aa81a7e0d071642af42626caebfef6eeb}{\-Hess\-Tran\-Prob\-\_\-\-Fct\-Ptr} tpf, const \hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$const node, const \-H\-Tvector \&x, const vector$<$ int $>$ \&pattern, \hyperlink{PhyloTree_8hpp_a8ee2b3678316ad48baa269e4ee7db7f7}{\-Hess\-Probs} \&h\-Nuc\-Prob) const 
\begin{DoxyCompactList}\small\item\em \-Calculates the probabilities as \-Hess\-Type of each character in a character space for a node given its children's state. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Static \-Private \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{classPhyloTree_a3e9c22f8a721a840c84f67e2136b8d30}{\-Print\-Branch} (const \hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$const node, int level)
\begin{DoxyCompactList}\small\item\em \-Prints a branch of the tree. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Private \-Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classPhyloNode}{\-Phylo\-Node} $\ast$ \hyperlink{classPhyloTree_a38c3253751a7ed9ffacb0978106f8173}{root}
\begin{DoxyCompactList}\small\item\em \-A pointer to a \hyperlink{classPhyloNode}{\-Phylo\-Node} root of the tree. \end{DoxyCompactList}\item 
int \hyperlink{classPhyloTree_a2411ce76565644f8253f15840863a05a}{\-Character\-Space}
\begin{DoxyCompactList}\small\item\em \-The size of the character space for the tree. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}


\-Definition at line 294 of file \-Phylo\-Tree.\-hpp.



\subsubsection{\-Constructor \& \-Destructor \-Documentation}
\hypertarget{classPhyloTree_a34906f6c4db42266e9f0ccb3057d2cb9}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!\-Phylo\-Tree@{\-Phylo\-Tree}}
\index{\-Phylo\-Tree@{\-Phylo\-Tree}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{\-Phylo\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Phylo\-Tree\-::\-Phylo\-Tree} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Phylo\-Tree} \&}]{other}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}explicit, private\mbox{]}}}}\label{classPhyloTree_a34906f6c4db42266e9f0ccb3057d2cb9}


\-Copy constructor is private and not implemented. 

\-Prevents copying of the object. \hypertarget{classPhyloTree_ab6e00efe0c10f4a93d34e7d027489ac6}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!\-Phylo\-Tree@{\-Phylo\-Tree}}
\index{\-Phylo\-Tree@{\-Phylo\-Tree}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{\-Phylo\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Phylo\-Tree\-::\-Phylo\-Tree} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline, explicit\mbox{]}}}}\label{classPhyloTree_ab6e00efe0c10f4a93d34e7d027489ac6}


\-Default constructor. 



\-Definition at line 370 of file \-Phylo\-Tree.\-hpp.


\begin{DoxyCode}
                         : root(NULL)
      {}
\end{DoxyCode}
\hypertarget{classPhyloTree_a0b54fc5ece14eeec6f28945306d070fd}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!\-Phylo\-Tree@{\-Phylo\-Tree}}
\index{\-Phylo\-Tree@{\-Phylo\-Tree}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{\-Phylo\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Phylo\-Tree\-::\-Phylo\-Tree} (
\begin{DoxyParamCaption}
\item[{int}]{cs, }
\item[{string \&}]{line, }
\item[{const vector$<$ string $>$ \&}]{seqnames}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}explicit\mbox{]}}}}\label{classPhyloTree_a0b54fc5ece14eeec6f28945306d070fd}


\-Constructor using a string description, eg ((1 2) 3 4) and a set of sequence names. 



\-Definition at line 159 of file \-Phylo\-Tree.\-cpp.



\-References \-Decode\-Tree(), and root.


\begin{DoxyCode}
: 
CharacterSpace(cs)
{
  // use decode tree to decode the line, returns a pointer to a PhyloNode
  root = DecodeTree(line, seqnames);

}                   // end constructor
\end{DoxyCode}
\hypertarget{classPhyloTree_a70200f6baa49702caa47c79d59d92a39}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!\-Phylo\-Tree@{\-Phylo\-Tree}}
\index{\-Phylo\-Tree@{\-Phylo\-Tree}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{\-Phylo\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Phylo\-Tree\-::\-Phylo\-Tree} (
\begin{DoxyParamCaption}
\item[{int}]{cs, }
\item[{string \&}]{line}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}explicit\mbox{]}}}}\label{classPhyloTree_a70200f6baa49702caa47c79d59d92a39}


\-Constructor using a string description, eg ((1 2) 3 4) but no sequence names. 



\-Definition at line 169 of file \-Phylo\-Tree.\-cpp.



\-References \-Decode\-Tree(), and root.


\begin{DoxyCode}
                                         : CharacterSpace(cs)
{

  // make an empty container
  vector<string> seqnames;
  
  // use decode tree to decode the line, returns a pointer to a PhyloNode
  root = DecodeTree(line, seqnames);

}                   // end constructor
\end{DoxyCode}
\hypertarget{classPhyloTree_a4a4c3d1b60f3bba1fe813a0ada4de498}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!$\sim$\-Phylo\-Tree@{$\sim$\-Phylo\-Tree}}
\index{$\sim$\-Phylo\-Tree@{$\sim$\-Phylo\-Tree}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{$\sim$\-Phylo\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Phylo\-Tree\-::$\sim$\-Phylo\-Tree} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}\label{classPhyloTree_a4a4c3d1b60f3bba1fe813a0ada4de498}


\-Destructor. 



\-Definition at line 380 of file \-Phylo\-Tree.\-hpp.


\begin{DoxyCode}
    {               // deletes the node which is the root and all its children
      delete root;
    }
\end{DoxyCode}


\subsubsection{\-Member \-Function \-Documentation}
\hypertarget{classPhyloTree_a7b301daf15291d5520dc122d3be3578e}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!\-Decode\-Tree@{\-Decode\-Tree}}
\index{\-Decode\-Tree@{\-Decode\-Tree}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{\-Decode\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Phylo\-Node} $\ast$ {\bf \-Phylo\-Tree\-::\-Decode\-Tree} (
\begin{DoxyParamCaption}
\item[{const string \&}]{line, }
\item[{const vector$<$ string $>$ \&}]{seqnames}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_a7b301daf15291d5520dc122d3be3578e}


\-Decodes and makes a tree from a line from the tree file. 

\-Expects sequence numbers to be delimited by commas 

\-Definition at line 345 of file \-Phylo\-Tree.\-cpp.



\-References \-Phylo\-Node\-::add\-Child(), find\-Label(), find\-Seq\-No(), find\-Time(), \-Phylo\-Node\-::get\-Parent(), \-Phylo\-Node\-::set\-Branch(), \-Phylo\-Node\-::set\-Label(), \-Phylo\-Node\-::set\-Seq\-Name(), \-Phylo\-Node\-::set\-Seq\-No(), \-Phylo\-Node\-::set\-Time(), and \-Tree\-File\-Error\-Exit().



\-Referenced by \-Phylo\-Tree().


\begin{DoxyCode}
{

  // set up a pointer to node for a new tree
  PhyloNode* newtree = NULL;
  PhyloNode* currentParent = NULL;
  PhyloNode* currentNode = NULL;

  int nodesRead = 0;// to track number of nodes read in
  int level = 0;    // to track of tree levels
  int branch = -1;  // to track branch numbers

  string::iterator it;
  size_t pos = 0;   // a counter for characters in the line dealt with

                    // the length of the line
  size_t lineLength = line.size();

  while (pos < lineLength)
  {

    real time = 0.0;
    int label = 0;
    int sequenceNumber = 0;

    char ch = line[pos];
    // pos should show the position we are at in the string

    switch (ch)
    {
      case ' ':     // ignore spaces
        pos++;
        break;

      case ',':     // ignore commas
        // commas are used as delimiters between sequence numbers, 
        // but once found
        // and used to identify the end of the number, they can be ignored
        pos++;
        break;

      case ';':     // ignore semicolons
        pos++;
        break;

      case '(':     // go down a level in the tree, making new nodes 
                    // for each level
        // set up a root node for a new tree

        try
        {
                    // ibranch is -1, parent is NULL
          currentNode = new PhyloNode();
        }
        catch (bad_alloc&)
        {
          cout << "Error allocating memory in DecodeTree" << std::endl;
          delete newtree;
          exit(1);
        }

        if (newtree == NULL)
        {
          newtree = currentNode;
          currentParent = newtree;
          // currentParent is NULL
        }
        else        // there is already a root node
        {
          // make a new node
                    // set branch of currentNode
          currentNode->setBranch(branch);
                    // make the current node a child of the current parent
          currentParent->addChild(currentNode);
          currentParent = currentNode;
        }

        level++;
        branch++;
        nodesRead++;
        pos++;

        break;      // end '('

      case ')':     // go up a level in the tree

        level--;
                    // check we can go up
        if (level < 0)
        {
          string msg = "Error in tree file: reading too many ')'";
          // delete any tree that has been set up
          TreeFileErrorExit(msg, newtree);
        }
        else        // level is okay
        {
          // make the currentParent into the parent 
          // of the present current parent
          currentNode = currentParent;
          currentParent = currentParent->getParent();
          pos++;
        }

        // no change in nodesRead
        // no change in branch

        break;      // end ')'

      case ':':     // signifies start of a time given as a length, 
                    // eg ((1:0.5,2;0.5):0.25,3:0.75, 4:0.75);
        time = findTime(line, lineLength, pos, newtree);
        // this moves pos to be the first character following 
        // the time characters

        // make this the time for the current node
        currentNode->setTime(time);

        // no change in level
        // no change in branch

        break;      // end of ':'

      case '#':     // signifies the start of a label, which is expected to a 
                    // single digit integer
        label = findLabel(line, lineLength, pos, newtree);
        // findLabel() updates pos to be the character after 
        // the end of the label

                    // make the currentNode label the integer at this pos
        currentNode->setLabel(label);

        // no change in level
        // no change in branch

        break;      // end of '#'

      case '$' :    // signifies the start of a label, which is expected 
                    // to a single digit integer
        label = findLabel(line, lineLength, pos, newtree);
        // findLabel() updates pos to be the character after 
        // the end of the label

                    // make the currentNode label the integer at this pos
        currentNode->setLabel(label);

        // no change in level
        // no change in branch

        break;      // end of '$'

      default:      // not one of the recognised characters signifying 
                    // tree structure or a character to be ignored
        // so expected to be either a sequence number or a sequence name
        // we need to identify the sequence number and make a new node and add 
        // it to the tree

        sequenceNumber = findSeqNo(line, lineLength, pos, newtree, seqnames);
        // pos will be moved to first character following the sequence 
        // identifier (number or name)

        // make a new node
        try
        {
                    // ibranch is -1, parent is NULL
          currentNode = new PhyloNode();
        }
        catch (bad_alloc&)
        {
          cout << "Error allocating memory in DecodeTree" << std::endl;
          delete newtree;
          exit(1);
        }

                    // set branch of currentNode
        currentNode->setBranch(branch);
                    // set the sequence number of the current node
        currentNode->setSeqNo(sequenceNumber);

        if (!seqnames.empty())
        {
                    // and set the corresponding name
          currentNode->setSeqName(seqnames[sequenceNumber-1]);
        }
        // make it a child of the current parent
        currentParent->addChild(currentNode);

        // no change in level;
        branch++;
        nodesRead++;

        break;      // end default
    }               // end switch
  }                 // end while

  // we expect to find that level = 0 at the end
  // and something has been read in for the tree
  // and number of branches+1 is number of nodes
  if (level != 0 || newtree == NULL || (branch+1 != nodesRead))
  {
    // error in tree file

    string msg = 
    "Error in tree file, please check the number of branches and nodes: 
       Expecting unrooted tree";
    TreeFileErrorExit(msg, newtree);
  }
  return newtree;
}
\end{DoxyCode}
\hypertarget{classPhyloTree_a0b7e1230aa0c30b38a2778b0281a5183}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!fill\-Prob\-Hess\-J\-C69@{fill\-Prob\-Hess\-J\-C69}}
\index{fill\-Prob\-Hess\-J\-C69@{fill\-Prob\-Hess\-J\-C69}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{fill\-Prob\-Hess\-J\-C69}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Hess\-Probs} \& {\bf \-Phylo\-Tree\-::fill\-Prob\-Hess\-J\-C69} (
\begin{DoxyParamCaption}
\item[{const \-H\-Tvector \&}]{x, }
\item[{const vector$<$ int $>$ \&}]{pattern, }
\item[{{\bf \-Hess\-Probs} \&}]{h\-Nuc\-Prob}
\end{DoxyParamCaption}
) const}}\label{classPhyloTree_a0b7e1230aa0c30b38a2778b0281a5183}


\-Return the probability of a given pattern for this tree. 

version dealing with \-H\-Tvectors and applying \-J\-C69 transition probabilities 
\begin{DoxyParams}{\-Parameters}
{\em x} & the \-H\-Tvector to calculate the probability of \\
\hline
{\em pattern} & the nucleotide pattern under which to calculate the probabilities (gives the probabilities at the leaf nodes) \\
\hline
{\em h\-Nuc\-Prob} & a vector of \-Hess\-Types, passed by reference, to be filled in by the function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
a vector of \-Hess\-Types, one for each character in the character space, returned by reference 
\end{DoxyReturn}


\-Definition at line 276 of file \-Phylo\-Tree.\-cpp.



\-References get\-Number\-Branches(), \-Phylo\-Node\-::no\-Children(), node\-P\-O\-T\-Hess(), \-Pijof\-T\-\_\-\-J\-C69\-H(), and root.



\-Referenced by \-F\-Phylo\-P\-O\-T\-::operator()().


\begin{DoxyCode}
{

  // check we have some children
  if (root->noChildren() == 0)
  {
    std::cerr << "Error trying to calculate probabilities "
              << "over tree with no children" << std::endl;
    exit(1);
  }

  // check the dimensions of the HTVector matches dimensions for this tree
  int d = x.Dim();
  if(getNumberBranches() != static_cast<size_t>(d))
  {
    std::cerr << "tree dimensions (branches) " << getNumberBranches()
      << " does not match dimensions of point " << d << std::endl;
    exit(1);
  }

  // use the root as the node to start post order traversal
  // and pass in pointer to JC69 transition probabilites function
  hNucProb = nodePOTHess(&PijofT_JC69H, root, x, pattern, hNucProb);

  // return the same vector but note that return is by reference
  return hNucProb;

}
\end{DoxyCode}
\hypertarget{classPhyloTree_ae1efe7ad349b169e80116a959553e37a}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!fill\-Prob\-Interval\-J\-C69@{fill\-Prob\-Interval\-J\-C69}}
\index{fill\-Prob\-Interval\-J\-C69@{fill\-Prob\-Interval\-J\-C69}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{fill\-Prob\-Interval\-J\-C69}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Interval\-Probs} \& {\bf \-Phylo\-Tree\-::fill\-Prob\-Interval\-J\-C69} (
\begin{DoxyParamCaption}
\item[{const ivector \&}]{x, }
\item[{const vector$<$ int $>$ \&}]{pattern, }
\item[{{\bf \-Interval\-Probs} \&}]{i\-Nuc\-Prob}
\end{DoxyParamCaption}
) const}}\label{classPhyloTree_ae1efe7ad349b169e80116a959553e37a}


\-Return the probability of a given pattern for this tree. 

version dealing with ivectors, ie boxes and applying \-J\-C69 transition probabilities 
\begin{DoxyParams}{\-Parameters}
{\em x} & the ivector to calculate the probability of \\
\hline
{\em pattern} & the nucleotide pattern under which to calculate the probabilities (gives the probabilities at the leaf nodes) \\
\hline
{\em i\-Nuc\-Prob} & a vector of intervals, passed by reference, to be filled in by the function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
a vector of intervals, one for each character in the character space, returned by reference 
\end{DoxyReturn}


\-Definition at line 242 of file \-Phylo\-Tree.\-cpp.



\-References get\-Number\-Branches(), taylor\-::\-Lb(), \-Phylo\-Node\-::no\-Children(), node\-P\-O\-Tinterval(), \-Pijof\-T\-\_\-\-J\-C69\-I(), root, and taylor\-::\-Ub().



\-Referenced by \-F\-Phylo\-P\-O\-T\-::operator()().


\begin{DoxyCode}
{

  // check we have some children
  if (root->noChildren() == 0)
  {
    std::cerr << "Error trying to calculate probabilities "
              << "over tree with no children" << std::endl;
    exit(1);
  }

  // check the dimensions of the box matches dimensions for this tree
  int d = Ub(x) - Lb(x) + 1;
  if(getNumberBranches() != static_cast<size_t>(d))
  {
    std::cerr << "tree dimensions (branches) " << getNumberBranches()
      << " does not match dimensions of point " << d << std::endl;
    exit(1);
  }

  // use the root as the node to start post order traversal
  // and pass in pointer to JC69 transition probabilites function
  iNucProb = nodePOTinterval(&PijofT_JC69I, root, x, pattern, iNucProb);

  // return the same vector but note that return is by reference
  return iNucProb;

}
\end{DoxyCode}
\hypertarget{classPhyloTree_a29c5f4195d70604d82ac900a97e05d1a}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!fill\-Prob\-Real\-C\-F\-N@{fill\-Prob\-Real\-C\-F\-N}}
\index{fill\-Prob\-Real\-C\-F\-N@{fill\-Prob\-Real\-C\-F\-N}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{fill\-Prob\-Real\-C\-F\-N}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Probs} \& {\bf \-Phylo\-Tree\-::fill\-Prob\-Real\-C\-F\-N} (
\begin{DoxyParamCaption}
\item[{const rvector \&}]{x, }
\item[{const vector$<$ int $>$ \&}]{pattern, }
\item[{{\bf \-Real\-Probs} \&}]{r\-Nuc\-Prob}
\end{DoxyParamCaption}
) const}}\label{classPhyloTree_a29c5f4195d70604d82ac900a97e05d1a}


\-Return the probability of a given pattern for this tree. 

version dealing with rvectors, ie points and applying \-C\-F\-N transition probabilities 
\begin{DoxyParams}{\-Parameters}
{\em x} & the rvector to calculate the probability of \\
\hline
{\em pattern} & the nucleotide pattern under which to calculate the probabilities (gives the probabilities at the leaf nodes) \\
\hline
{\em r\-Nuc\-Prob} & a vector of reals, passed by reference, to be filled in by the function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
a vector of reals, one for each character in the character space, returned by reference 
\end{DoxyReturn}


\-Definition at line 310 of file \-Phylo\-Tree.\-cpp.



\-References get\-Number\-Branches(), taylor\-::\-Lb(), \-Phylo\-Node\-::no\-Children(), node\-P\-O\-Treal(), \-Pijof\-T\-\_\-\-C\-F\-N\-R(), root, and taylor\-::\-Ub().


\begin{DoxyCode}
{

  // check we have some children
  if (root->noChildren() == 0)
  {
    std::cerr << "Error trying to calculate probabilities "
              << "over tree with no children" << std::endl;
    exit(1);
  }

  // check the dimensions of the point matches dimensions for this tree
  int d = Ub(x) - Lb(x) + 1;
  if(getNumberBranches() != static_cast<size_t>(d))
  {
    std::cerr << "tree dimensions (branches) " << getNumberBranches()
      << " does not match dimensions of point " << d << std::endl;
    exit(1);
  }

  // use the root as the node to start post order traversal
  // and pass in pointer to CFN transition probabilites function
  rNucProb = nodePOTreal(&PijofT_CFNR, root, x, pattern, rNucProb);

  // return the same vector but note that return is by reference
  return rNucProb;

}
\end{DoxyCode}
\hypertarget{classPhyloTree_ac490ccd50ba543a3f58f70e79d5c7c24}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!fill\-Prob\-Real\-J\-C69@{fill\-Prob\-Real\-J\-C69}}
\index{fill\-Prob\-Real\-J\-C69@{fill\-Prob\-Real\-J\-C69}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{fill\-Prob\-Real\-J\-C69}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Probs} \& {\bf \-Phylo\-Tree\-::fill\-Prob\-Real\-J\-C69} (
\begin{DoxyParamCaption}
\item[{const rvector \&}]{x, }
\item[{const vector$<$ int $>$ \&}]{pattern, }
\item[{{\bf \-Real\-Probs} \&}]{r\-Nuc\-Prob}
\end{DoxyParamCaption}
) const}}\label{classPhyloTree_ac490ccd50ba543a3f58f70e79d5c7c24}


\-Return the probability of a given pattern for this tree. 

version dealing with rvectors, ie points and applying \-J\-C69 transition probabilities 
\begin{DoxyParams}{\-Parameters}
{\em x} & the rvector to calculate the probability of \\
\hline
{\em pattern} & the nucleotide pattern under which to calculate the probabilities (gives the probabilities at the leaf nodes) \\
\hline
{\em r\-Nuc\-Prob} & a vector of reals, passed by reference, to be filled in by the function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
a vector of reals, one for each character in the character space, returned by reference 
\end{DoxyReturn}


\-Definition at line 208 of file \-Phylo\-Tree.\-cpp.



\-References get\-Number\-Branches(), taylor\-::\-Lb(), \-Phylo\-Node\-::no\-Children(), node\-P\-O\-Treal(), \-Pijof\-T\-\_\-\-J\-C69\-R(), root, and taylor\-::\-Ub().



\-Referenced by \-F\-Phylo\-P\-O\-T\-::operator()().


\begin{DoxyCode}
{

  // check we have some children
  if (root->noChildren() == 0)
  {
    std::cerr << "Error trying to calculate probabilities "
              << "over tree with no children" << std::endl;
    exit(1);
  }

  // check the dimensions of the point matches dimensions for this tree
  int d = Ub(x) - Lb(x) + 1;
  if(getNumberBranches() != static_cast<size_t>(d))
  {
    std::cerr << "tree dimensions (branches) " << getNumberBranches()
      << " does not match dimensions of point " << d << std::endl;
    exit(1);
  }

  // use the root as the node to start post order traversal
  // and pass in pointer to JC69 transition probabilites function
  rNucProb = nodePOTreal(&PijofT_JC69R, root, x, pattern, rNucProb);

  // return the same vector but note that return is by reference
  return rNucProb;

}
\end{DoxyCode}
\hypertarget{classPhyloTree_ae6923fc35a5687504975d460a9769a55}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!find\-Label@{find\-Label}}
\index{find\-Label@{find\-Label}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{find\-Label}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf \-Phylo\-Tree\-::find\-Label} (
\begin{DoxyParamCaption}
\item[{const string \&}]{line, }
\item[{const size\-\_\-t}]{line\-Length, }
\item[{size\-\_\-t \&}]{pos, }
\item[{const {\bf \-Phylo\-Node} $\ast$}]{root}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_ae6923fc35a5687504975d460a9769a55}


\-Extract a label given in a tree file if the identifier for a label has been found. 



\-Definition at line 627 of file \-Phylo\-Tree.\-cpp.



\-References taylor\-::sin(), and \-Tree\-File\-Error\-Exit().



\-Referenced by \-Decode\-Tree().


\begin{DoxyCode}
{
  pos++;            // move to the next character after the '#' or '$'
       character

                    // characters accepted as part of an integer
  string intChars = "0123456789";
                    // space characters
  string space = " ";

  // find the first non space and make sure it is an integer
  pos = line.find_first_not_of(space, pos);

  if (pos==string::npos)
  {
    string msg = 
    "Error in tree file: no integer label following '#' or '$' character";
    TreeFileErrorExit(msg, node);
  }

  size_t numerpos = line.find_first_of(intChars, pos);

  // check that first integer is the first non space character following ':'
  if ((numerpos==string::npos) || (numerpos != pos))
  {
    string msg = 
    "Error in tree file: no integer following '#' or '$' character ";
    TreeFileErrorExit(msg, node);
  }

  int retValue = 1000;

  // string to int
  string singleCharStr = line.substr(pos, 1);
  istringstream sin(singleCharStr);
  sin >> retValue;  // store integer at pos as sequenceNumber

  pos++;

  // now we expect a non integer character or the end of the line
  if (pos < lineLength)
  {
    numerpos = line.find_first_of(intChars, pos);
    if (numerpos == pos)
    {
      string msg = 
      "Sorry:  DecodeTree() can only cope with single-digit labels at present";
      TreeFileErrorExit(msg, node);
    }
  }                 // end check on next digit

  return retValue;
}
\end{DoxyCode}
\hypertarget{classPhyloTree_abd9309bd022690e7532c1d4903d7898f}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!find\-Seq\-No@{find\-Seq\-No}}
\index{find\-Seq\-No@{find\-Seq\-No}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{find\-Seq\-No}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf \-Phylo\-Tree\-::find\-Seq\-No} (
\begin{DoxyParamCaption}
\item[{const string \&}]{line, }
\item[{const size\-\_\-t}]{line\-Length, }
\item[{size\-\_\-t \&}]{pos, }
\item[{const {\bf \-Phylo\-Node} $\ast$}]{root, }
\item[{const vector$<$ string $>$ \&}]{seqnames}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_abd9309bd022690e7532c1d4903d7898f}


\-Extract a sequence number from a tree file. 

\-If a sequence name rather than number is given, finds the corresponding sequence number using the names from sequences read in from sequence file. 

\-Definition at line 682 of file \-Phylo\-Tree.\-cpp.



\-References taylor\-::sin(), and \-Tree\-File\-Error\-Exit().



\-Referenced by \-Decode\-Tree().


\begin{DoxyCode}
{

                    // characters accepted as part of an integer
  string intChars = "0123456789";
                    //characters accepted as part of an alphabetical label
  string alphaChars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";

  // we know that there will be no spaces at the start since they are dealt 
  // with in DecodeTree()
  // we expect each distinct sequence number to be followed by a comma or a ), 
  // signifying the end of the number

  int sequenceNumber = -1;

  int noseq = static_cast<int>(seqnames.size());

  // check if character at this pos numeric?
  size_t numerpos = line.find_first_of(intChars, pos);

                    // the character at pos is numeric
  if (pos == numerpos)
  {
    // should be the start of our sequence number

    // find the non numeric character
                    // first occurence of something non-int
    size_t notnumerpos = line.find_first_not_of(intChars, pos);

    // the number we want starts at pos and has it's final character 
    // at notnumerpos-1
    // and so has length notnumberpos-1 - pos +1 = notnumererpos-pos
    string numberStr = line.substr(pos, (notnumerpos-pos));
    // string to int
    istringstream sin(numberStr);
                    // store the integer we are after as sequenceNumber
    sin >> sequenceNumber;

    //check sequenceNumber against number of sequence names if given
    if ((noseq > 0) && (noseq < sequenceNumber))
    {
      string msg = 
      "Error in tree file: A sequence number is \n greater than the number of
       sequences";
      TreeFileErrorExit(msg, node);
    }

                    // move pos to next character after the number
    pos = notnumerpos;
  }

  else              // the character at pos is not numeric
  {
    // should be the start of a recognised sequence name

    if (noseq == 0)
    {
      string msg = 
      "Error constructing tree: can deal only with sequences identified by
       number";
      TreeFileErrorExit(msg, node);
    }

    size_t posUpTo = line.find_first_not_of(alphaChars, pos);

    // but really there should be at least one non-alpha character 
    // before the end?
    if (posUpTo==string::npos)
    {
      posUpTo = lineLength;
    }

    // using the part of the string comprising the alpha characters
    string name = line.substr(pos, posUpTo-pos);

    // compare to the seqnames

    int i = 0;
    while ((sequenceNumber == -1) && (i < noseq))
    {

                    // find the ith sequence name
      string seqName = seqnames[i];

      // make both names all lower case
      std::transform(name.begin(), name.end(), name.begin(), ::tolower);
      std::transform(seqName.begin(), 
                     seqName.end(), seqName.begin(), ::tolower);

      if (seqName == name)
      {
        sequenceNumber = i+1;

      }
      i++;
    }               // end while

                    // did not find a match for a sequence name
    if (sequenceNumber == -1)
    {
      string msg = 
      "Error in tree file: a name in tree file did not match \n any in the
       sequence file (case insensitive matching)";
      TreeFileErrorExit(msg, node);
    }

    pos = posUpTo;  // move pos up the first non-alpha character
  }                 // end of alpha name for node identifier

  return sequenceNumber;
}
\end{DoxyCode}
\hypertarget{classPhyloTree_a91962e00d6d81f2186e2290ce61bf7f1}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!find\-Time@{find\-Time}}
\index{find\-Time@{find\-Time}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{find\-Time}]{\setlength{\rightskip}{0pt plus 5cm}real {\bf \-Phylo\-Tree\-::find\-Time} (
\begin{DoxyParamCaption}
\item[{const string \&}]{line, }
\item[{const size\-\_\-t}]{line\-Length, }
\item[{size\-\_\-t \&}]{pos, }
\item[{const {\bf \-Phylo\-Node} $\ast$}]{root}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_a91962e00d6d81f2186e2290ce61bf7f1}


\-Extract a time given in a tree file if the identifier for a time has been found. 



\-Definition at line 569 of file \-Phylo\-Tree.\-cpp.



\-References taylor\-::sin(), and \-Tree\-File\-Error\-Exit().



\-Referenced by \-Decode\-Tree().


\begin{DoxyCode}
{
  pos++;
                    // characters accepted as part of a double number
  string doubleChars = ".0123456789";
                    // space characters
  string space = " ";

  // find the first non space and make sure it is acceptable 
  // as the start of a double
  pos = line.find_first_not_of(space, pos);

  if (pos==string::npos)
  {
    string msg = 
    "Error in tree file: no double for time following ':' character ";
    TreeFileErrorExit(msg, node);
  }

  size_t firstPos = line.find_first_of(doubleChars, pos);

  // check that first integer is the first non space character following ':'
  if ((firstPos==string::npos) || (firstPos != pos))
  {
    string msg = "Error in tree file: no integer following '#' character";
    TreeFileErrorExit(msg, node);
  }
  // pos is the same as firstPos

  // find last of the following doubleChars
  size_t posUpTo = line.find_first_not_of(doubleChars, pos);

                    // there could be no non-numeric character before the end
  if (posUpTo==string::npos)
  {
    posUpTo = lineLength;
  }

  // using the part of the string comprising the numbers
                    // convert to a stream
  istringstream sin(line.substr(pos, posUpTo-pos));
  double dblValue = 0.0;
  sin >> dblValue;  // extract number from the stream

  real retValue = _real(dblValue);

  // make this the time for the current node
  pos = posUpTo;    // move pos up the first non-numeric character

  return retValue;
}
\end{DoxyCode}
\hypertarget{classPhyloTree_ae7557f8269350a3ee6ba18f9bd63b7e6}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!get\-Number\-Branches@{get\-Number\-Branches}}
\index{get\-Number\-Branches@{get\-Number\-Branches}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{get\-Number\-Branches}]{\setlength{\rightskip}{0pt plus 5cm}size\-\_\-t {\bf \-Phylo\-Tree\-::get\-Number\-Branches} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}\label{classPhyloTree_ae7557f8269350a3ee6ba18f9bd63b7e6}


\-Get the number of branches in a tree. 



\-Definition at line 398 of file \-Phylo\-Tree.\-hpp.



\-Referenced by fill\-Prob\-Hess\-J\-C69(), fill\-Prob\-Interval\-J\-C69(), fill\-Prob\-Real\-C\-F\-N(), and fill\-Prob\-Real\-J\-C69().


\begin{DoxyCode}
    {
      return getNumberNodes() - 1;
    }
\end{DoxyCode}
\hypertarget{classPhyloTree_a0d1f91c11b0b4dd5091f44d0f4dda0c7}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!get\-Number\-Nodes@{get\-Number\-Nodes}}
\index{get\-Number\-Nodes@{get\-Number\-Nodes}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{get\-Number\-Nodes}]{\setlength{\rightskip}{0pt plus 5cm}size\-\_\-t {\bf \-Phylo\-Tree\-::get\-Number\-Nodes} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classPhyloTree_a0d1f91c11b0b4dd5091f44d0f4dda0c7}


\-Get the number of nodes in the tree, including the root. 



\-Definition at line 181 of file \-Phylo\-Tree.\-cpp.



\-References \-Phylo\-Node\-::no\-Descendents(), and root.



\-Referenced by \-F\-Phylo\-P\-O\-T\-::\-Read\-Trees().


\begin{DoxyCode}
{
  size_t noNodes = 0;

  if (root!=NULL)
  {

    noNodes++;      // count the root
    // and add on descendents of root
    noNodes += root->noDescendents();
  }

  return noNodes;
}
\end{DoxyCode}
\hypertarget{classPhyloTree_a5ede1337d40e3e211e83d9f009b062f9}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!get\-Root@{get\-Root}}
\index{get\-Root@{get\-Root}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{get\-Root}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Phylo\-Node}$\ast$ {\bf \-Phylo\-Tree\-::get\-Root} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}\label{classPhyloTree_a5ede1337d40e3e211e83d9f009b062f9}


\-Get the root of the tree. 



\-Definition at line 389 of file \-Phylo\-Tree.\-hpp.


\begin{DoxyCode}
    {
      return root;
    }
\end{DoxyCode}
\hypertarget{classPhyloTree_aec23a8f03330ad66e6ff1af4c886798e}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!node\-P\-O\-T\-Hess@{node\-P\-O\-T\-Hess}}
\index{node\-P\-O\-T\-Hess@{node\-P\-O\-T\-Hess}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{node\-P\-O\-T\-Hess}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Hess\-Probs} \& {\bf \-Phylo\-Tree\-::node\-P\-O\-T\-Hess} (
\begin{DoxyParamCaption}
\item[{{\bf \-Hess\-Tran\-Prob\-\_\-\-Fct\-Ptr}}]{tpf, }
\item[{const {\bf \-Phylo\-Node} $\ast$const}]{node, }
\item[{const \-H\-Tvector \&}]{x, }
\item[{const vector$<$ int $>$ \&}]{pattern, }
\item[{{\bf \-Hess\-Probs} \&}]{h\-Nuc\-Prob}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_aec23a8f03330ad66e6ff1af4c886798e}


\-Calculates the probabilities as \-Hess\-Type of each character in a character space for a node given its children's state. 

\-Uses post order traversal of the tree to build probabilities from probabilities in child nodes. 
\begin{DoxyParams}{\-Parameters}
{\em node} & the node for which to calculate probabilities \\
\hline
{\em x} & the rvector to calculate the probability of \\
\hline
{\em pattern} & the nucleotide pattern under which to calculate the probabilities (gives the probabilities at the leaf nodes) \\
\hline
{\em h\-Nuc\-Prob} & a vector of \-Hess\-Types, passed by reference, to be filled in by the function \\
\hline
{\em tpf} & a function pointer for probabilities as \-Hess\-Types \\
\hline
{\em tpf} & a function pointer for transition probabilities as \-Hess\-Types \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
a vector of \-Hess\-Types, one for each character in the character space, returned by reference 
\end{DoxyReturn}


\-Definition at line 978 of file \-Phylo\-Tree.\-cpp.



\-References \-Character\-Space, \-Phylo\-Node\-::get\-Branch(), \-Phylo\-Node\-::get\-Children(), \-Phylo\-Node\-::get\-Seq\-No(), and \-Phylo\-Node\-::no\-Children().



\-Referenced by fill\-Prob\-Hess\-J\-C69().


\begin{DoxyCode}
{
  hNucProb.clear(); // make sure the container is empty
  hNucProb.reserve(CharacterSpace);

                    // get the children of the node
  PhyloPtrs theChildren = node->getChildren();

  PhyloPtrsItr it;

  int d = x.Dim();  // dimensions of x

  // CharacterSpace is the number of possible characters for nucleotides
  for (int thisNuc=0; thisNuc < CharacterSpace; thisNuc++)
  {
                    // HessType of same dimensions as x
    HessType prob(d);
    prob = 1.0;

    // for each child
    for (it = theChildren.begin(); it < theChildren.end(); it++)
    {

      PhyloNode* child = *it;
                    // add one because ivectors are indexed 1 to n not 0 to n-1
      int branchIndex = child->getBranch() + 1;
                    // the element of x corresponding to the child's branch
      HessType ptElem(x[branchIndex]);
      int sequenceNumber = child->getSeqNo();

                    // this child of this node has no children
      if (child->noChildren() < 1)
      {

        // get the coded character for this child's sequence number in 
        // the pattern_i-th base sequence
        int childNuc = pattern[sequenceNumber-1];

        // get prob of transition from childNuc to thisNuc
        prob = prob * tpf(ptElem, thisNuc, childNuc);

      }             // end if child has no children

      else          // this child has children
      {

                    // fill this in by recursing on fillProbHess with child
        HessProbs childProbs;
        childProbs = nodePOTHess(tpf, child, x, pattern, childProbs);

        HessType tt(d);
        tt = 0.0;

        // run over the childProbs, accumulating
        for (int j = 1; j < CharacterSpace; j++)
        {
          tt = tt+ (tpf(ptElem, thisNuc, j) * childProbs[j]);
        }

        prob = prob * tt;
      }             // end case child has children

      // the child, whether it has children or not, 
      // has now multiplied prob by something
    }               // end of loop through children

    // we now have a prob for thisNuc to which each child has contributed
                    // copy of prob goes into hNucProb
    hNucProb.push_back(prob);
  }                 // end of loop through CharacterSpace

  // hNucProb should have had CharacterSpace intervals pushed into it

  return hNucProb;  // return the same vector but note that return is by
       reference
}
\end{DoxyCode}
\hypertarget{classPhyloTree_a1cb66ffcb92baaeafadd12babc01feba}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!node\-P\-O\-Tinterval@{node\-P\-O\-Tinterval}}
\index{node\-P\-O\-Tinterval@{node\-P\-O\-Tinterval}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{node\-P\-O\-Tinterval}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Interval\-Probs} \& {\bf \-Phylo\-Tree\-::node\-P\-O\-Tinterval} (
\begin{DoxyParamCaption}
\item[{{\bf \-Interval\-Tran\-Prob\-\_\-\-Fct\-Ptr}}]{tpf, }
\item[{const {\bf \-Phylo\-Node} $\ast$const}]{node, }
\item[{const ivector \&}]{x, }
\item[{const vector$<$ int $>$ \&}]{pattern, }
\item[{{\bf \-Interval\-Probs} \&}]{i\-Nuc\-Prob}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_a1cb66ffcb92baaeafadd12babc01feba}


\-Calculates the probabilities as an interval of each character for a node given its children's state. 

\-Uses post order traversal of the tree to build probabilities from probabilities in child nodes. 
\begin{DoxyParams}{\-Parameters}
{\em node} & the node for which to calculate probabilities \\
\hline
{\em x} & the rvector to calculate the probability of \\
\hline
{\em pattern} & the nucleotide pattern under which to calculate the probabilities (gives the probabilities at the leaf nodes) \\
\hline
{\em i\-Nuc\-Prob} & a vector of intervals, passed by reference, to be filled in by the function \\
\hline
{\em tpf} & a function pointer for transition probabilities as intervals \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
a vector of intervals, one for each character in the character space, returned by reference 
\end{DoxyReturn}


\-Definition at line 901 of file \-Phylo\-Tree.\-cpp.



\-References \-Character\-Space, \-Phylo\-Node\-::get\-Branch(), \-Phylo\-Node\-::get\-Children(), \-Phylo\-Node\-::get\-Seq\-No(), and \-Phylo\-Node\-::no\-Children().



\-Referenced by fill\-Prob\-Interval\-J\-C69().


\begin{DoxyCode}
{
  iNucProb.clear(); // make sure the container is empty
  iNucProb.reserve(CharacterSpace);

                    // get the children of the node
  PhyloPtrs theChildren = node->getChildren();

  PhyloPtrsItr it;

  // CharacterSpace is the number of possible characters for nucleotides
  for (int thisNuc=0; thisNuc < CharacterSpace; thisNuc++)
  {
    interval prob(1.0, 1.0);

    // for each child
    for (it = theChildren.begin(); it < theChildren.end(); it++)
    {

      PhyloNode* child = *it;
                    // add one because ivectors are indexed 1 to n not 0 to n-1
      int branchIndex = child->getBranch() + 1;
                    // the interval in x corresponding to the child's branch
      interval boxSide = x[branchIndex];
      int sequenceNumber = child->getSeqNo();

                    // this child of this node has no children
      if (child->noChildren() < 1)
      {

        // get the coded character for this child's sequence number in the 
        // pattern_i-th base sequence
        int childNuc = pattern[sequenceNumber-1];

        // get prob of transition from childNuc to thisNuc
        prob = prob * tpf(boxSide, thisNuc, childNuc);

      }             // end if child has no children

      else          // this child has children
      {

                    // fill this in by recursing on fillProbInterval with child
        IntervalProbs childProbs;
        childProbs = nodePOTinterval(tpf, child, x, pattern, childProbs);

        interval tt(0.0, 0.0);

        // run over the childProbs, accumulating
        for (int j = 1; j < CharacterSpace; j++)
        {
          tt = tt+ (tpf(boxSide, thisNuc, j) * childProbs[j]);
        }
        prob = prob * tt;
      }             // end case child has children

      // the child, whether it has children or not, has now 
      // multiplied prob by something
    }               // end of loop through children

    // we now have a prob for thisNuc to which each child has contributed
                    // copy of prob goes into iNucProb
    iNucProb.push_back(prob);
  }                 // end of loop through CharacterSpace

  // iNucProb should have had CharacterSpace intervals pushed into it

  // return the same vector but note that return is by reference
  return iNucProb;
}
\end{DoxyCode}
\hypertarget{classPhyloTree_ae7b8d3e72818ebe9eea94906acf541f1}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!node\-P\-O\-Treal@{node\-P\-O\-Treal}}
\index{node\-P\-O\-Treal@{node\-P\-O\-Treal}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{node\-P\-O\-Treal}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Real\-Probs} \& {\bf \-Phylo\-Tree\-::node\-P\-O\-Treal} (
\begin{DoxyParamCaption}
\item[{{\bf \-Real\-Tran\-Prob\-\_\-\-Fct\-Ptr}}]{tpf, }
\item[{const {\bf \-Phylo\-Node} $\ast$const}]{node, }
\item[{const rvector \&}]{x, }
\item[{const vector$<$ int $>$ \&}]{pattern, }
\item[{{\bf \-Real\-Probs} \&}]{r\-Nuc\-Prob}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_ae7b8d3e72818ebe9eea94906acf541f1}


\-Calculates the probabilities as reals of each character for a node given its children's state. 

\-Uses post order traversal of the tree to build probabilities from probabilities in child nodes. 
\begin{DoxyParams}{\-Parameters}
{\em node} & the node for which to calculate probabilities \\
\hline
{\em x} & the rvector to calculate the probability of \\
\hline
{\em pattern} & the nucleotide pattern under which to calculate the probabilities (gives the probabilities at the leaf nodes) \\
\hline
{\em r\-Nuc\-Prob} & a vector of reals, passed by reference, to be filled in by the function \\
\hline
{\em tpf} & a function pointer for transition probabilities as reals \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
a vector of reals, one for each character in the character space, returned by reference 
\end{DoxyReturn}


\-Definition at line 824 of file \-Phylo\-Tree.\-cpp.



\-References \-Character\-Space, \-Phylo\-Node\-::get\-Branch(), \-Phylo\-Node\-::get\-Children(), \-Phylo\-Node\-::get\-Seq\-No(), and \-Phylo\-Node\-::no\-Children().



\-Referenced by fill\-Prob\-Real\-C\-F\-N(), and fill\-Prob\-Real\-J\-C69().


\begin{DoxyCode}
{
  rNucProb.clear(); // make sure the container is empty
  rNucProb.reserve(CharacterSpace);

                    // get the children of the node of this tree
  PhyloPtrs theChildren = node->getChildren();

  PhyloPtrsItr it;

  // CharacterSpace is the number of possible characters for nucleotides
  for (int thisNuc=0; thisNuc < CharacterSpace; thisNuc++)
  {
    real prob(1.0);

    // for each child
    for (it = theChildren.begin(); it < theChildren.end(); it++)
    {

      PhyloNode* child = *it;
                    // add one because rvectors are indexed 1 to n not 0 to n-1
      int branchIndex = child->getBranch() + 1;
                    // the element in x corresponding to the child's branch
      real ptElem = x[branchIndex];
      int sequenceNumber = child->getSeqNo();

                    // this child of this node has no children
      if (child->noChildren() < 1)
      {

        // get the coded character for this child's sequence 
        // number in the supplied pattern
        int childNuc = pattern[sequenceNumber-1];

        // get prob of transition from childNuc to thisNuc
        prob = prob * tpf(ptElem, thisNuc, childNuc);

      }             // end if child has no children

      else          // this child has children
      {

                    // fill this in by recursing on fillProbReal with child
        RealProbs childProbs;
        childProbs = nodePOTreal(tpf, child, x, pattern, childProbs);

        real tt(0.0);

        // run over the childProbs, accumulating
        for (int j = 1; j < CharacterSpace; j++)
        {
          tt = tt+ (tpf(ptElem, thisNuc, j) * childProbs[j]);
        }
        prob = prob * tt;
      }             // end case child has children

      // the child, whether it has children or not, has now 
      // multiplied prob by something
    }               // end of loop through children

    // we now have a prob for thisNuc to which each child has contributed
                    // copy of prob goes into rNucProb
    rNucProb.push_back(prob);
  }                 // end of loop through CharacterSpace

  // rNucProb should have had CharacterSpace intervals pushed into it

  // return the same vector but note that return is by reference
  return rNucProb;
}
\end{DoxyCode}
\hypertarget{classPhyloTree_af53d4860d55732c183934881fda283c3}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!operator=@{operator=}}
\index{operator=@{operator=}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{operator=}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Phylo\-Tree}\& \-Phylo\-Tree\-::operator= (
\begin{DoxyParamCaption}
\item[{const {\bf \-Phylo\-Tree} \&}]{rhs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_af53d4860d55732c183934881fda283c3}


\-Copy assignment operator is private and not implemented. 

\-Prevents copying of the object. \hypertarget{classPhyloTree_a3e9c22f8a721a840c84f67e2136b8d30}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!\-Print\-Branch@{\-Print\-Branch}}
\index{\-Print\-Branch@{\-Print\-Branch}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{\-Print\-Branch}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Phylo\-Tree\-::\-Print\-Branch} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Phylo\-Node} $\ast$const}]{node, }
\item[{int}]{level}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static, private\mbox{]}}}}\label{classPhyloTree_a3e9c22f8a721a840c84f67e2136b8d30}


\-Prints a branch of the tree. 



\-Definition at line 794 of file \-Phylo\-Tree.\-cpp.



\-References \-Phylo\-Node\-::get\-Children(), and \-Phylo\-Node\-::print\-Node().



\-Referenced by \-Print\-Tree().


\begin{DoxyCode}
{
  PhyloPtrs theChildren = node->getChildren();
  PhyloPtrsItr it;

  for (int i = 0; i < level; i++)
  {
    std:: cout << "\t";
  }

  node->printNode();

  if(!theChildren.empty())
  {
    for (int i = 0; i < level; i++)
    {
      std::cout << "\t";
    }
    std::cout << "Children are:" << std::endl;
  }

  level++;
  for (it = theChildren.begin(); it < theChildren.end(); it++)
  {
    PrintBranch(*it, level);
  }
}
\end{DoxyCode}
\hypertarget{classPhyloTree_ac593ca7be08c1b02b1b9e4d5229363bd}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!\-Print\-Tree@{\-Print\-Tree}}
\index{\-Print\-Tree@{\-Print\-Tree}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{\-Print\-Tree}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Phylo\-Tree\-::\-Print\-Tree} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}}\label{classPhyloTree_ac593ca7be08c1b02b1b9e4d5229363bd}


print a tree starting with the root 



\-Definition at line 197 of file \-Phylo\-Tree.\-cpp.



\-References \-Print\-Branch(), and root.


\begin{DoxyCode}
{

  PrintBranch(root, 0);
  std:: cout << std::endl;
  std:: cout << std::endl;
}
\end{DoxyCode}
\hypertarget{classPhyloTree_aed4d7f60f27bef63636280e6a76ed962}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!\-Tree\-File\-Error\-Exit@{\-Tree\-File\-Error\-Exit}}
\index{\-Tree\-File\-Error\-Exit@{\-Tree\-File\-Error\-Exit}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{\-Tree\-File\-Error\-Exit}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Phylo\-Tree\-::\-Tree\-File\-Error\-Exit} (
\begin{DoxyParamCaption}
\item[{const string \&}]{msg, }
\item[{const {\bf \-Phylo\-Node} $\ast$}]{node}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_aed4d7f60f27bef63636280e6a76ed962}


\-A function to deal with an error found in a tree input file. 



\-Definition at line 554 of file \-Phylo\-Tree.\-cpp.



\-Referenced by \-Decode\-Tree(), find\-Label(), find\-Seq\-No(), and find\-Time().


\begin{DoxyCode}
{
  std::cerr << msg << std::endl << std::endl;
  delete node;
  exit(1);

}
\end{DoxyCode}


\subsubsection{\-Member \-Data \-Documentation}
\hypertarget{classPhyloTree_a2411ce76565644f8253f15840863a05a}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!\-Character\-Space@{\-Character\-Space}}
\index{\-Character\-Space@{\-Character\-Space}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{\-Character\-Space}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf \-Phylo\-Tree\-::\-Character\-Space}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_a2411ce76565644f8253f15840863a05a}


\-The size of the character space for the tree. 



\-Definition at line 304 of file \-Phylo\-Tree.\-hpp.



\-Referenced by node\-P\-O\-T\-Hess(), node\-P\-O\-Tinterval(), and node\-P\-O\-Treal().

\hypertarget{classPhyloTree_a38c3253751a7ed9ffacb0978106f8173}{\index{\-Phylo\-Tree@{\-Phylo\-Tree}!root@{root}}
\index{root@{root}!PhyloTree@{\-Phylo\-Tree}}
\paragraph[{root}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Phylo\-Node}$\ast$ {\bf \-Phylo\-Tree\-::root}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}\label{classPhyloTree_a38c3253751a7ed9ffacb0978106f8173}


\-A pointer to a \hyperlink{classPhyloNode}{\-Phylo\-Node} root of the tree. 



\-Definition at line 301 of file \-Phylo\-Tree.\-hpp.



\-Referenced by fill\-Prob\-Hess\-J\-C69(), fill\-Prob\-Interval\-J\-C69(), fill\-Prob\-Real\-C\-F\-N(), fill\-Prob\-Real\-J\-C69(), get\-Number\-Nodes(), \-Phylo\-Tree(), and \-Print\-Tree().



\-The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
\hyperlink{PhyloTree_8hpp}{\-Phylo\-Tree.\-hpp}\item 
\hyperlink{PhyloTree_8cpp}{\-Phylo\-Tree.\-cpp}\end{DoxyCompactItemize}
